{"version":3,"file":"rx-plugin.d.js","names":[],"sources":["../../../src/types/rx-plugin.d.ts"],"sourcesContent":["import type {\n    RxQuery,\n    RxQueryOP,\n    MangoQuery\n} from './rx-query.d.ts';\nimport type {\n    RxCollection,\n    RxCollectionCreator\n} from './rx-collection.d.ts';\nimport type {\n    RxStorageInstanceCreationParams\n} from './rx-storage.d.ts';\nimport type {\n    DeepReadonly,\n    FilledMangoQuery,\n    RxDatabase,\n    RxDatabaseCreator,\n    RxDocument,\n    RxStorage,\n    RxReplicationWriteToMasterRow,\n    WithDeleted,\n    RxState,\n    BulkWriteRow,\n    RxStorageInstance\n} from './index.d.ts';\nimport type { RxSchema } from '../rx-schema.d.ts';\n\nexport type RxPluginPrePrepareRxQueryArgs = {\n    op: RxQueryOP;\n    queryObj: MangoQuery | string | number | Array<any>;\n    collection: RxCollection;\n};\n\nexport type RxPluginPreCreateRxQueryArgs = {\n    op: RxQueryOP;\n    queryObj: MangoQuery;\n    collection: RxCollection;\n};\n\nexport type RxPluginPreAddRxPluginArgs = {\n    // the plugin that is getting added\n    plugin: RxPlugin | any;\n    // previous added plugins\n    plugins: Set<RxPlugin | any>;\n};\n\nexport type RxPluginPrePrepareQueryArgs = {\n    rxQuery: RxQuery<any>;\n    mangoQuery: FilledMangoQuery<any>;\n};\n\n\n/**\n * Depending on which plugins are used together,\n * it is important that the plugin is able to define if\n * the hooks must be added as first or as last array item.\n * For example the encryption plugin must run encryption\n * before the key-compression changes the fieldnames.\n */\nexport type RxPluginHooks<Input> = {\n    /**\n     * Hook function that is added as first.\n     */\n    before?: (i: Input) => void;\n    /**\n     * Hook function that is added as last.\n     */\n    after?: (i: Input) => void;\n};\n\nexport interface RxPlugin {\n    /**\n     * A string to uniquely identifies the plugin.\n     * Can be used to throw when different versions of the same plugin are used.\n     * And also other checks.\n     * Use kebab-case.\n     */\n    readonly name: string;\n\n    /**\n     * set this to true so RxDB\n     * knows that this object in a rxdb plugin\n     */\n    readonly rxdb: true;\n\n    /**\n     * Init function where dependent plugins could be added.\n     * (optional)\n     */\n    init?(): any;\n\n    prototypes?: {\n        RxSchema?: (proto: RxSchema) => void;\n        RxDocument?: (proto: RxDocument) => void;\n        RxQuery?: (proto: RxQuery) => void;\n        RxCollection?: (proto: RxCollection) => void;\n        RxDatabase?: (proto: RxDatabase) => void;\n    };\n    overwritable?: {\n        isDevMode?: () => boolean;\n        deepFreezeWhenDevMode?: <T>(obj: T) => DeepReadonly<T>;\n        validatePassword?: Function;\n        checkAdapter?: Function;\n        tunnelErrorMessage?: Function;\n    };\n    hooks?: {\n        preAddRxPlugin?: RxPluginHooks<RxPluginPreAddRxPluginArgs>;\n        preCreateRxDatabase?: RxPluginHooks<any>;\n        createRxDatabase?: RxPluginHooks<{\n            database: RxDatabase;\n            creator: RxDatabaseCreator;\n        }>;\n        preCloseRxDatabase?: RxPluginHooks<RxDatabase>;\n        postRemoveRxDatabase?: RxPluginHooks<{\n            databaseName: string;\n            storage: RxStorage<any, any>;\n        }>;\n        createRxCollection?: RxPluginHooks<{\n            collection: RxCollection;\n            creator: RxCollectionCreator;\n        }>;\n        createRxState?: RxPluginHooks<{\n            collection: RxCollection;\n            state: RxState<unknown, unknown>;\n        }>;\n        preCreateRxCollection?: RxPluginHooks<RxCollectionCreator<any> & {\n            name: string;\n            database: RxDatabase;\n        }>;\n        postCloseRxCollection?: RxPluginHooks<RxCollection>;\n        postRemoveRxCollection?: RxPluginHooks<{\n            storage: RxStorage<any, any>;\n            databaseName: string;\n            collectionName: string;\n        }>;\n        preCreateRxSchema?: RxPluginHooks<any>;\n        createRxSchema?: RxPluginHooks<any>;\n        prePrepareRxQuery?: RxPluginHooks<RxPluginPrePrepareRxQueryArgs>;\n        preCreateRxQuery?: RxPluginHooks<RxPluginPreCreateRxQueryArgs>;\n        prePrepareQuery?: RxPluginHooks<RxPluginPrePrepareQueryArgs>;\n        createRxQuery?: RxPluginHooks<RxQuery>;\n        createRxDocument?: RxPluginHooks<any>;\n        postCreateRxDocument?: RxPluginHooks<any>;\n        preCreateRxStorageInstance?: RxPluginHooks<RxStorageInstanceCreationParams<any, any>>;\n        /**\n         * Runs before a write to the storage instance of a RxCollection or RxDatabase.\n         */\n        preStorageWrite?: RxPluginHooks<{\n            storageInstance: RxStorageInstance<any, any, any, any>;\n            rows: BulkWriteRow<any>[];\n        }>;\n        preMigrateDocument?: RxPluginHooks<any>;\n        postMigrateDocument?: RxPluginHooks<any>;\n        postCleanup?: RxPluginHooks<{\n            databaseName: string;\n            collectionName: string;\n        }>;\n        preReplicationMasterWrite?: RxPluginHooks<{\n            rows: RxReplicationWriteToMasterRow<any>[];\n            collection: RxCollection;\n        }>;\n        preReplicationMasterWriteDocumentsHandle?: RxPluginHooks<{\n            result: WithDeleted<any>[];\n            collection: RxCollection;\n        }>;\n    };\n}\n"],"mappings":"","ignoreList":[]}