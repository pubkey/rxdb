{"version":3,"file":"replication-graphql.d.js","names":[],"sources":["../../../../src/types/plugins/replication-graphql.d.ts"],"sourcesContent":["import { ClientOptions } from 'graphql-ws';\nimport { RxReplicationWriteToMasterRow } from '../replication-protocol.ts';\nimport { ById, MaybePromise } from '../util.ts';\nimport {\n    ReplicationOptions,\n    ReplicationPullHandlerResult,\n    ReplicationPullOptions,\n    ReplicationPushHandlerResult,\n    ReplicationPushOptions\n} from './replication.ts';\n\nexport interface RxGraphQLReplicationQueryBuilderResponseObject {\n    query: string;\n    operationName?: string;\n    variables: any;\n}\n\nexport type RxGraphQLReplicationClientState = {\n    headers: ById<string>;\n    credentials: RequestCredentials | undefined;\n};\n\nexport type RxGraphQLReplicationQueryBuilderResponse =\n    RxGraphQLReplicationQueryBuilderResponseObject |\n    Promise<RxGraphQLReplicationQueryBuilderResponseObject>;\nexport type RxGraphQLReplicationPushQueryBuilder = (\n    // typed 'any' because the data might be modified by the push.modifier.\n    rows: RxReplicationWriteToMasterRow<any>[]\n) => RxGraphQLReplicationQueryBuilderResponse;\n\nexport type RxGraphQLPullWSOptions = Omit<ClientOptions, 'url' | 'shouldRetry' | 'webSocketImpl'>;\n\nexport type RxGraphQLReplicationPullQueryBuilder<CheckpointType> = (\n    latestPulledCheckpoint: CheckpointType | undefined,\n    limit: number\n) => RxGraphQLReplicationQueryBuilderResponse;\nexport type GraphQLSyncPullOptions<RxDocType, CheckpointType> = Omit<\n    ReplicationPullOptions<RxDocType, CheckpointType>,\n    'handler' | 'stream$'\n> & {\n    queryBuilder: RxGraphQLReplicationPullQueryBuilder<CheckpointType>;\n    streamQueryBuilder?: RxGraphQLReplicationPullStreamQueryBuilder;\n    /**\n     * The path to the data in the GraphQL response.\n     * If set, the data will be taken from the response at this path.\n     * @example ['data', 'foo', 'bar'] or 'data.foo.bar'\n     */\n    dataPath?: string | string[];\n    responseModifier?: RxGraphQLPullResponseModifier<RxDocType, CheckpointType>;\n    includeWsHeaders?: boolean;\n    wsOptions?: RxGraphQLPullWSOptions;\n};\n\nexport type RxGraphQLPullResponseModifier<RxDocType, CheckpointType> = (\n    // the exact response that was returned from the server\n    plainResponse: ReplicationPullHandlerResult<RxDocType, CheckpointType> | any,\n    // either 'handler' if it came from the pull.handler, or 'stream' if it came from the pull.stream\n    origin: 'handler' | 'stream',\n    requestCheckpoint?: CheckpointType\n) => MaybePromise<ReplicationPullHandlerResult<RxDocType, CheckpointType>>;\n\nexport type RxGraphQLPushResponseModifier<RxDocType> = (\n    // the exact response that was returned from the server\n    plainResponse: ReplicationPushHandlerResult<RxDocType> | any,\n) => MaybePromise<ReplicationPushHandlerResult<RxDocType>>;\n\nexport type RxGraphQLReplicationPullStreamQueryBuilder = (headers: { [k: string]: string; }) => RxGraphQLReplicationQueryBuilderResponse;\n\nexport type GraphQLSyncPushOptions<RxDocType> = Omit<\n    ReplicationPushOptions<RxDocType>,\n    'handler'\n> & {\n    queryBuilder: RxGraphQLReplicationPushQueryBuilder;\n    /**\n     * The path to the data in the GraphQL response.\n     * If set, the data will be taken from the response at this path.\n     * @example ['data', 'foo', 'bar'] or 'data.foo.bar'\n     */\n    dataPath?: string | string[];\n    responseModifier?: RxGraphQLPushResponseModifier<RxDocType>;\n};\n\nexport type GraphQLServerUrl = {\n    http?: string;\n    ws?: string;\n};\n\nexport type SyncOptionsGraphQL<RxDocType, CheckpointType> = Omit<\n    ReplicationOptions<RxDocType, CheckpointType>,\n    'pull' | 'push'\n> & {\n    url: GraphQLServerUrl;\n    fetch?: WindowOrWorkerGlobalScope['fetch'];\n    headers?: { [k: string]: string; }; // send with all requests to the endpoint\n    credentials?: RequestCredentials;\n    pull?: GraphQLSyncPullOptions<RxDocType, CheckpointType>;\n    push?: GraphQLSyncPushOptions<RxDocType>;\n};\n"],"mappings":"","ignoreList":[]}