{"version":3,"file":"dev-mode-tracking.js","names":["RXDB_VERSION","hasPremiumFlag","hashStringToNumber","iframeShown","links","text","url","addDevModeTrackingIframe","window","location","document","containerDiv","createElement","style","visibility","position","top","left","opacity","width","height","overflow","iframe","src","appendChild","hashNr","host","useLinkId","length","useLink","link","href","target","innerText","p","body","isLocalHost","hostname","includes"],"sources":["../../../../src/plugins/dev-mode/dev-mode-tracking.ts"],"sourcesContent":["import type { RxDatabase } from '../../types';\nimport {\n    RXDB_VERSION,\n    hasPremiumFlag,\n    hashStringToNumber\n} from '../utils/index.ts';\n\n\nlet iframeShown = false;\n\nconst links: {\n    text: string;\n    url: string;\n}[] = [\n        {\n            text: 'JavaScript Database',\n            url: 'https://rxdb.info/'\n        },\n        {\n            text: 'React Native Database',\n            url: 'https://rxdb.info/react-native-database.html'\n        },\n        {\n            text: 'Local First',\n            url: 'https://rxdb.info/articles/local-first-future.html'\n        },\n        {\n            text: 'Angular IndexedDB',\n            url: 'https://rxdb.info/articles/angular-indexeddb.html'\n        },\n        {\n            text: 'React IndexedDB',\n            url: 'https://rxdb.info/articles/react-indexeddb.html'\n        },\n        {\n            text: 'Firestore Alternative',\n            url: 'https://rxdb.info/articles/firestore-alternative.html'\n        },\n        {\n            text: 'Offline Database',\n            url: 'https://rxdb.info/articles/offline-database.html'\n        },\n        {\n            text: 'JSON Database',\n            url: 'https://rxdb.info/articles/json-database.html'\n        },\n        {\n            text: 'NodeJS Database',\n            url: 'https://rxdb.info/nodejs-database.html'\n        }\n    ];\n\n\n/**\n * Adds an iframe to track the results of marketing efforts.\n */\nexport async function addDevModeTrackingIframe() {\n    /**\n     * Only run this in browser AND localhost AND dev-mode.\n     * Make sure this is never used in production by someone.\n     */\n    if (\n        iframeShown ||\n        typeof window === 'undefined' ||\n        typeof location === 'undefined' ||\n        typeof document === 'undefined'\n        // !isLocalHost()\n    ) {\n        return;\n    }\n\n\n    // do not show if premium flag is set.\n    if (await hasPremiumFlag()) {\n        return;\n    }\n\n    iframeShown = true;\n\n    /**\n     * Do not use display:none\n     * @link https://medium.com/@zachcaceres/dont-use-display-none-to-hide-iframes-in-safari-b51715eb22c4\n     */\n    const containerDiv = document.createElement('div');\n    containerDiv.style.visibility = 'hidden';\n    containerDiv.style.position = 'absolute';\n    containerDiv.style.top = '0';\n    containerDiv.style.left = '0';\n    containerDiv.style.opacity = '0.1';\n    containerDiv.style.width = '1px';\n    containerDiv.style.height = '1px';\n    containerDiv.style.overflow = 'hidden';\n\n    const iframe = document.createElement('iframe');\n    iframe.width = '1px';\n    iframe.height = '1px';\n    iframe.src = 'https://rxdb.info/html/dev-mode-iframe.html?version=' + RXDB_VERSION;\n    containerDiv.appendChild(iframe);\n\n    const hashNr = hashStringToNumber(location.host);\n    const useLinkId = hashNr % links.length;\n    const useLink = links[useLinkId];\n    const link = document.createElement('a');\n    link.href = useLink.url;\n    link.target = '_blank';\n    link.innerText = useLink.text;\n\n    const p = document.createElement('p');\n    p.innerText = 'This is the iframe which is shown when the RxDB Dev-Mode is enabled. Also see ';\n    p.appendChild(link);\n    containerDiv.appendChild(p);\n\n    document.body.appendChild(containerDiv);\n}\n\n\nfunction isLocalHost() {\n    return (\n        location.hostname === 'localhost' ||\n        location.hostname.includes('localhost') ||\n        location.hostname === '127.0.0.1' ||\n        location.hostname === '0.0.0.0' ||\n        location.hostname === '[::1]'  // IPv6\n    );\n}\n"],"mappings":"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","ignoreList":[]}