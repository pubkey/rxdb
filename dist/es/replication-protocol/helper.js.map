{"version":3,"file":"helper.js","names":["createRevision","flatClone","getDefaultRevision","now","docStateToWriteDoc","hashFunction","docState","previous","docData","Object","assign","_attachments","_meta","lwt","_rev","writeDocToDocState","writeDoc","ret"],"sources":["../../../src/replication-protocol/helper.ts"],"sourcesContent":["import type {\n    HashFunction,\n    RxDocumentData,\n    WithDeleted\n} from '../types';\nimport {\n    createRevision,\n    flatClone,\n    getDefaultRevision,\n    now\n} from '../util';\n\nexport function docStateToWriteDoc<RxDocType>(\n    hashFunction: HashFunction,\n    docState: WithDeleted<RxDocType>,\n    previous?: RxDocumentData<RxDocType>\n): RxDocumentData<RxDocType> {\n    const docData: RxDocumentData<RxDocType> = Object.assign(\n        {},\n        docState,\n        {\n            _attachments: {},\n            _meta: {\n                lwt: now()\n            },\n            _rev: getDefaultRevision()\n        }\n    );\n    docData._rev = createRevision(\n        hashFunction,\n        docData,\n        previous\n    );\n    return docData;\n}\n\nexport function writeDocToDocState<RxDocType>(\n    writeDoc: RxDocumentData<RxDocType>\n): WithDeleted<RxDocType> {\n    const ret = flatClone(writeDoc);\n    delete (ret as any)._attachments;\n    delete (ret as any)._meta;\n    delete (ret as any)._rev;\n    return ret;\n}\n"],"mappings":"AAKA,SACIA,cADJ,EAEIC,SAFJ,EAGIC,kBAHJ,EAIIC,GAJJ,QAKO,SALP;AAOA,OAAO,SAASC,kBAAT,CACHC,YADG,EAEHC,QAFG,EAGHC,QAHG,EAIsB;EACzB,IAAMC,OAAkC,GAAGC,MAAM,CAACC,MAAP,CACvC,EADuC,EAEvCJ,QAFuC,EAGvC;IACIK,YAAY,EAAE,EADlB;IAEIC,KAAK,EAAE;MACHC,GAAG,EAAEV,GAAG;IADL,CAFX;IAKIW,IAAI,EAAEZ,kBAAkB;EAL5B,CAHuC,CAA3C;EAWAM,OAAO,CAACM,IAAR,GAAed,cAAc,CACzBK,YADyB,EAEzBG,OAFyB,EAGzBD,QAHyB,CAA7B;EAKA,OAAOC,OAAP;AACH;AAED,OAAO,SAASO,kBAAT,CACHC,QADG,EAEmB;EACtB,IAAMC,GAAG,GAAGhB,SAAS,CAACe,QAAD,CAArB;EACA,OAAQC,GAAD,CAAaN,YAApB;EACA,OAAQM,GAAD,CAAaL,KAApB;EACA,OAAQK,GAAD,CAAaH,IAApB;EACA,OAAOG,GAAP;AACH"}