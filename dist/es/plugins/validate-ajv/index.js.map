{"version":3,"file":"index.js","names":["Ajv","wrappedValidateStorageFactory","ajv","strict","getValidator","schema","validator","compile","docData","isValid","errors","wrappedValidateAjvStorage"],"sources":["../../../../src/plugins/validate-ajv/index.ts"],"sourcesContent":["/**\n * this plugin validates documents before they can be inserted into the RxCollection.\n * It's using ajv as jsonschema-validator\n * @link https://github.com/epoberezkin/ajv\n */\nimport Ajv from 'ajv';\nimport type {\n    RxDocumentData,\n    RxJsonSchema\n} from '../../types';\nimport { wrappedValidateStorageFactory } from '../../plugin-helpers';\n\n\nconst ajv = new Ajv({\n    strict: false\n});\n\n\nexport function getValidator(\n    schema: RxJsonSchema<any>\n) {\n    const validator = ajv.compile(schema);\n    return (docData: RxDocumentData<any>) => {\n        const isValid = validator(docData);\n        if (isValid) {\n            return [];\n        } else {\n            return validator.errors as any;\n        }\n    };\n}\n\nexport const wrappedValidateAjvStorage = wrappedValidateStorageFactory(\n    getValidator,\n    'ajv'\n);\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA,OAAOA,GAAG,MAAM,KAAK;AAKrB,SAASC,6BAA6B,QAAQ,sBAAsB;AAGpE,IAAMC,GAAG,GAAG,IAAIF,GAAG,CAAC;EAChBG,MAAM,EAAE;AACZ,CAAC,CAAC;AAGF,OAAO,SAASC,YAAY,CACxBC,MAAyB,EAC3B;EACE,IAAMC,SAAS,GAAGJ,GAAG,CAACK,OAAO,CAACF,MAAM,CAAC;EACrC,OAAQG,OAA4B,IAAK;IACrC,IAAMC,OAAO,GAAGH,SAAS,CAACE,OAAO,CAAC;IAClC,IAAIC,OAAO,EAAE;MACT,OAAO,EAAE;IACb,CAAC,MAAM;MACH,OAAOH,SAAS,CAACI,MAAM;IAC3B;EACJ,CAAC;AACL;AAEA,OAAO,IAAMC,yBAAyB,GAAGV,6BAA6B,CAClEG,YAAY,EACZ,KAAK,CACR"}