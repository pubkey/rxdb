{"version":3,"file":"helper.js","names":["_index","require","GRAPHQL_REPLICATION_PLUGIN_IDENTITY_PREFIX","exports","graphQLRequest","fetchRequest","httpUrl","clientState","queryParams","headers","Headers","append","req","Request","ensureNotFalsy","method","body","JSON","stringify","credentials","then","res","json","getDataFromResult","result","userDefinedDataPath","dataPath","Object","keys","data","getProperty"],"sources":["../../../../src/plugins/replication-graphql/helper.ts"],"sourcesContent":["import type { RxGraphQLReplicationClientState, RxGraphQLReplicationQueryBuilderResponseObject } from '../../types/index.d.ts';\nimport { ensureNotFalsy, getProperty } from '../../plugins/utils/index.ts';\n\nexport const GRAPHQL_REPLICATION_PLUGIN_IDENTITY_PREFIX = 'graphql';\n\nexport interface GraphQLError {\n    message: string;\n    locations: Array<{\n        line: number;\n        column: number;\n    }>;\n    path: string[];\n}\nexport type GraphQLErrors = Array<GraphQLError>;\n\n\n\nexport function graphQLRequest(\n    fetchRequest: WindowOrWorkerGlobalScope['fetch'],\n    httpUrl: string,\n    clientState: RxGraphQLReplicationClientState,\n    queryParams: RxGraphQLReplicationQueryBuilderResponseObject\n) {\n\n    const headers = new Headers(clientState.headers || {});\n    headers.append('Content-Type', 'application/json');\n\n    const req = new Request(\n        ensureNotFalsy(httpUrl),\n        {\n            method: 'POST',\n            body: JSON.stringify(queryParams),\n            headers,\n            credentials: clientState.credentials,\n        }\n    );\n    \n    return fetchRequest(req)\n        .then((res) => res.json())\n        .then((body) => {\n            return body;\n        });\n}\n\nexport function getDataFromResult(\n    result: { data: object },\n    userDefinedDataPath: string | string[] | undefined\n): any {\n    const dataPath = userDefinedDataPath || ['data', Object.keys(result.data)[0]];\n    const data: any = getProperty(result, dataPath);\n    return data;\n}"],"mappings":";;;;;;;;AACA,IAAAA,MAAA,GAAAC,OAAA;AAEO,IAAMC,0CAA0C,GAAAC,OAAA,CAAAD,0CAAA,GAAG,SAAS;AAc5D,SAASE,cAAcA,CAC1BC,YAAgD,EAChDC,OAAe,EACfC,WAA4C,EAC5CC,WAA2D,EAC7D;EAEE,IAAMC,OAAO,GAAG,IAAIC,OAAO,CAACH,WAAW,CAACE,OAAO,IAAI,CAAC,CAAC,CAAC;EACtDA,OAAO,CAACE,MAAM,CAAC,cAAc,EAAE,kBAAkB,CAAC;EAElD,IAAMC,GAAG,GAAG,IAAIC,OAAO,CACnB,IAAAC,qBAAc,EAACR,OAAO,CAAC,EACvB;IACIS,MAAM,EAAE,MAAM;IACdC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACV,WAAW,CAAC;IACjCC,OAAO;IACPU,WAAW,EAAEZ,WAAW,CAACY;EAC7B,CACJ,CAAC;EAED,OAAOd,YAAY,CAACO,GAAG,CAAC,CACnBQ,IAAI,CAAEC,GAAG,IAAKA,GAAG,CAACC,IAAI,CAAC,CAAC,CAAC,CACzBF,IAAI,CAAEJ,IAAI,IAAK;IACZ,OAAOA,IAAI;EACf,CAAC,CAAC;AACV;AAEO,SAASO,iBAAiBA,CAC7BC,MAAwB,EACxBC,mBAAkD,EAC/C;EACH,IAAMC,QAAQ,GAAGD,mBAAmB,IAAI,CAAC,MAAM,EAAEE,MAAM,CAACC,IAAI,CAACJ,MAAM,CAACK,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;EAC7E,IAAMA,IAAS,GAAG,IAAAC,kBAAW,EAACN,MAAM,EAAEE,QAAQ,CAAC;EAC/C,OAAOG,IAAI;AACf","ignoreList":[]}