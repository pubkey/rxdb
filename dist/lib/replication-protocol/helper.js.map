{"version":3,"file":"helper.js","names":["docStateToWriteDoc","databaseInstanceToken","docState","previous","docData","Object","assign","_attachments","_meta","lwt","now","_rev","getDefaultRevision","createRevision","writeDocToDocState","writeDoc","ret","flatClone"],"sources":["../../../src/replication-protocol/helper.ts"],"sourcesContent":["import type {\n    RxDocumentData,\n    WithDeleted\n} from '../types';\nimport {\n    createRevision,\n    flatClone,\n    getDefaultRevision,\n    now\n} from '../plugins/utils';\n\nexport function docStateToWriteDoc<RxDocType>(\n    databaseInstanceToken: string,\n    docState: WithDeleted<RxDocType>,\n    previous?: RxDocumentData<RxDocType>\n): RxDocumentData<RxDocType> {\n    const docData: RxDocumentData<RxDocType> = Object.assign(\n        {},\n        docState,\n        {\n            _attachments: {},\n            _meta: {\n                lwt: now()\n            },\n            _rev: getDefaultRevision()\n        }\n    );\n    docData._rev = createRevision(\n        databaseInstanceToken,\n        previous\n    );\n    return docData;\n}\n\nexport function writeDocToDocState<RxDocType>(\n    writeDoc: RxDocumentData<RxDocType>\n): WithDeleted<RxDocType> {\n    const ret = flatClone(writeDoc);\n    delete (ret as any)._attachments;\n    delete (ret as any)._meta;\n    delete (ret as any)._rev;\n    return ret;\n}\n"],"mappings":";;;;;;;AAIA;AAOO,SAASA,kBAAkB,CAC9BC,qBAA6B,EAC7BC,QAAgC,EAChCC,QAAoC,EACX;EACzB,IAAMC,OAAkC,GAAGC,MAAM,CAACC,MAAM,CACpD,CAAC,CAAC,EACFJ,QAAQ,EACR;IACIK,YAAY,EAAE,CAAC,CAAC;IAChBC,KAAK,EAAE;MACHC,GAAG,EAAE,IAAAC,UAAG;IACZ,CAAC;IACDC,IAAI,EAAE,IAAAC,yBAAkB;EAC5B,CAAC,CACJ;EACDR,OAAO,CAACO,IAAI,GAAG,IAAAE,qBAAc,EACzBZ,qBAAqB,EACrBE,QAAQ,CACX;EACD,OAAOC,OAAO;AAClB;AAEO,SAASU,kBAAkB,CAC9BC,QAAmC,EACb;EACtB,IAAMC,GAAG,GAAG,IAAAC,gBAAS,EAACF,QAAQ,CAAC;EAC/B,OAAQC,GAAG,CAAST,YAAY;EAChC,OAAQS,GAAG,CAASR,KAAK;EACzB,OAAQQ,GAAG,CAASL,IAAI;EACxB,OAAOK,GAAG;AACd"}