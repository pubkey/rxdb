{"version":3,"file":"helper.js","names":["docStateToWriteDoc","hashFunction","docState","previous","docData","Object","assign","_attachments","_meta","lwt","now","_rev","getDefaultRevision","createRevision","writeDocToDocState","writeDoc","ret","flatClone"],"sources":["../../../src/replication-protocol/helper.ts"],"sourcesContent":["import type {\n    HashFunction,\n    RxDocumentData,\n    WithDeleted\n} from '../types';\nimport {\n    createRevision,\n    flatClone,\n    getDefaultRevision,\n    now\n} from '../util';\n\nexport function docStateToWriteDoc<RxDocType>(\n    hashFunction: HashFunction,\n    docState: WithDeleted<RxDocType>,\n    previous?: RxDocumentData<RxDocType>\n): RxDocumentData<RxDocType> {\n    const docData: RxDocumentData<RxDocType> = Object.assign(\n        {},\n        docState,\n        {\n            _attachments: {},\n            _meta: {\n                lwt: now()\n            },\n            _rev: getDefaultRevision()\n        }\n    );\n    docData._rev = createRevision(\n        hashFunction,\n        docData,\n        previous\n    );\n    return docData;\n}\n\nexport function writeDocToDocState<RxDocType>(\n    writeDoc: RxDocumentData<RxDocType>\n): WithDeleted<RxDocType> {\n    const ret = flatClone(writeDoc);\n    delete (ret as any)._attachments;\n    delete (ret as any)._meta;\n    delete (ret as any)._rev;\n    return ret;\n}\n"],"mappings":";;;;;;;;AAKA;;AAOO,SAASA,kBAAT,CACHC,YADG,EAEHC,QAFG,EAGHC,QAHG,EAIsB;EACzB,IAAMC,OAAkC,GAAGC,MAAM,CAACC,MAAP,CACvC,EADuC,EAEvCJ,QAFuC,EAGvC;IACIK,YAAY,EAAE,EADlB;IAEIC,KAAK,EAAE;MACHC,GAAG,EAAE,IAAAC,SAAA;IADF,CAFX;IAKIC,IAAI,EAAE,IAAAC,wBAAA;EALV,CAHuC,CAA3C;EAWAR,OAAO,CAACO,IAAR,GAAe,IAAAE,oBAAA,EACXZ,YADW,EAEXG,OAFW,EAGXD,QAHW,CAAf;EAKA,OAAOC,OAAP;AACH;;AAEM,SAASU,kBAAT,CACHC,QADG,EAEmB;EACtB,IAAMC,GAAG,GAAG,IAAAC,eAAA,EAAUF,QAAV,CAAZ;EACA,OAAQC,GAAD,CAAaT,YAApB;EACA,OAAQS,GAAD,CAAaR,KAApB;EACA,OAAQQ,GAAD,CAAaL,IAApB;EACA,OAAOK,GAAP;AACH"}