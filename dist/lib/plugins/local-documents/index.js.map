{"version":3,"file":"index.js","names":["RxDBLocalDocumentsPlugin","name","rxdb","prototypes","RxCollection","proto","insertLocal","upsertLocal","getLocal","getLocal$","RxDatabase","hooks","createRxDatabase","before","args","creator","localDocuments","createLocalDocStateByParent","database","createRxCollection","collection","preDestroyRxDatabase","after","db","closeStateByParent","postDestroyRxCollection","postRemoveRxDatabase","removeLocalDocumentsStorageInstance","storage","databaseName","postRemoveRxCollection","collectionName","overwritable"],"sources":["../../../../src/plugins/local-documents/index.ts"],"sourcesContent":["import type {\n    RxPlugin\n} from '../../types';\nimport {\n    getLocal,\n    getLocal$,\n    insertLocal,\n    upsertLocal\n} from './local-documents';\nimport {\n    closeStateByParent,\n    createLocalDocStateByParent,\n    removeLocalDocumentsStorageInstance\n} from './local-documents-helper';\n\nexport * from './local-documents-helper';\nexport * from './local-documents';\nexport * from './rx-local-document';\nexport type {\n    LocalDocumentParent,\n    LocalDocumentState,\n    RxLocalDocument,\n    RxLocalDocumentData\n} from '../../types/plugins/local-documents';\n\n\nexport const RxDBLocalDocumentsPlugin: RxPlugin = {\n    name: 'local-documents',\n    rxdb: true,\n    prototypes: {\n        RxCollection: (proto: any) => {\n            proto.insertLocal = insertLocal;\n            proto.upsertLocal = upsertLocal;\n            proto.getLocal = getLocal;\n            proto.getLocal$ = getLocal$;\n        },\n        RxDatabase: (proto: any) => {\n            proto.insertLocal = insertLocal;\n            proto.upsertLocal = upsertLocal;\n            proto.getLocal = getLocal;\n            proto.getLocal$ = getLocal$;\n        }\n    },\n    hooks: {\n        createRxDatabase: {\n            before: args => {\n                if (args.creator.localDocuments) {\n                    /**\n                     * We do not have to await\n                     * the creation to speed up initial page load.\n                     */\n                    /* await */ createLocalDocStateByParent(args.database);\n                }\n            }\n        },\n        createRxCollection: {\n            before: args => {\n                if (args.creator.localDocuments) {\n                    /**\n                     * We do not have to await\n                     * the creation to speed up initial page load.\n                     */\n                    /* await */ createLocalDocStateByParent(args.collection);\n                }\n            }\n        },\n        preDestroyRxDatabase: {\n            after: db => {\n                return closeStateByParent(db);\n            }\n        },\n        postDestroyRxCollection: {\n            after: collection => closeStateByParent(collection)\n        },\n        postRemoveRxDatabase: {\n            after: args => {\n                return removeLocalDocumentsStorageInstance(\n                    args.storage,\n                    args.databaseName,\n                    ''\n                );\n            }\n        },\n        postRemoveRxCollection: {\n            after: args => {\n                return removeLocalDocumentsStorageInstance(\n                    args.storage,\n                    args.databaseName,\n                    args.collectionName\n                );\n            }\n        }\n    },\n    overwritable: {}\n};\n"],"mappings":";;;;;;;;;AAGA;AAaA;EAAA;EAAA;EAAA;EAAA;IAAA;IAAA;MAAA;IAAA;EAAA;AAAA;AAPA;AAMA;EAAA;EAAA;EAAA;EAAA;IAAA;IAAA;MAAA;IAAA;EAAA;AAAA;AAEA;AAAA;EAAA;EAAA;EAAA;EAAA;IAAA;IAAA;MAAA;IAAA;EAAA;AAAA;AASO,IAAMA,wBAAkC,GAAG;EAC9CC,IAAI,EAAE,iBAAiB;EACvBC,IAAI,EAAE,IAAI;EACVC,UAAU,EAAE;IACRC,YAAY,EAAGC,KAAU,IAAK;MAC1BA,KAAK,CAACC,WAAW,GAAGA,2BAAW;MAC/BD,KAAK,CAACE,WAAW,GAAGA,2BAAW;MAC/BF,KAAK,CAACG,QAAQ,GAAGA,wBAAQ;MACzBH,KAAK,CAACI,SAAS,GAAGA,yBAAS;IAC/B,CAAC;IACDC,UAAU,EAAGL,KAAU,IAAK;MACxBA,KAAK,CAACC,WAAW,GAAGA,2BAAW;MAC/BD,KAAK,CAACE,WAAW,GAAGA,2BAAW;MAC/BF,KAAK,CAACG,QAAQ,GAAGA,wBAAQ;MACzBH,KAAK,CAACI,SAAS,GAAGA,yBAAS;IAC/B;EACJ,CAAC;EACDE,KAAK,EAAE;IACHC,gBAAgB,EAAE;MACdC,MAAM,EAAEC,IAAI,IAAI;QACZ,IAAIA,IAAI,CAACC,OAAO,CAACC,cAAc,EAAE;UAC7B;AACpB;AACA;AACA;UACoB;UAAY,IAAAC,iDAA2B,EAACH,IAAI,CAACI,QAAQ,CAAC;QAC1D;MACJ;IACJ,CAAC;IACDC,kBAAkB,EAAE;MAChBN,MAAM,EAAEC,IAAI,IAAI;QACZ,IAAIA,IAAI,CAACC,OAAO,CAACC,cAAc,EAAE;UAC7B;AACpB;AACA;AACA;UACoB;UAAY,IAAAC,iDAA2B,EAACH,IAAI,CAACM,UAAU,CAAC;QAC5D;MACJ;IACJ,CAAC;IACDC,oBAAoB,EAAE;MAClBC,KAAK,EAAEC,EAAE,IAAI;QACT,OAAO,IAAAC,wCAAkB,EAACD,EAAE,CAAC;MACjC;IACJ,CAAC;IACDE,uBAAuB,EAAE;MACrBH,KAAK,EAAEF,UAAU,IAAI,IAAAI,wCAAkB,EAACJ,UAAU;IACtD,CAAC;IACDM,oBAAoB,EAAE;MAClBJ,KAAK,EAAER,IAAI,IAAI;QACX,OAAO,IAAAa,yDAAmC,EACtCb,IAAI,CAACc,OAAO,EACZd,IAAI,CAACe,YAAY,EACjB,EAAE,CACL;MACL;IACJ,CAAC;IACDC,sBAAsB,EAAE;MACpBR,KAAK,EAAER,IAAI,IAAI;QACX,OAAO,IAAAa,yDAAmC,EACtCb,IAAI,CAACc,OAAO,EACZd,IAAI,CAACe,YAAY,EACjBf,IAAI,CAACiB,cAAc,CACtB;MACL;IACJ;EACJ,CAAC;EACDC,YAAY,EAAE,CAAC;AACnB,CAAC;AAAC"}