{"version":3,"file":"rx-storage-ipc-renderer.js","names":["getRxStorageIpcRenderer","settings","channelId","IPC_RENDERER_KEY_PREFIX","key","join","messages$","Subject","ipcRenderer","on","_event","message","next","postMessage","send","msg","storage","getRxStorageRemote","identifier","statics"],"sources":["../../../../src/plugins/electron/rx-storage-ipc-renderer.ts"],"sourcesContent":["import { Subject } from 'rxjs';\nimport {\n    getRxStorageRemote,\n    RxStorageRemote,\n    RxStorageRemoteSettings,\n    MessageFromRemote\n} from '../storage-remote';\nimport type {\n    RxStorageStatics\n} from '../../types';\nimport {\n    IPC_RENDERER_KEY_PREFIX\n} from './electron-helper';\n\nexport type RxStorageIpcRendererSettings = {\n    /**\n     * Set the same key on both sides\n     * to ensure that messages do not get mixed\n     * up when you use more then one storage.\n     */\n    key: string;\n    statics: RxStorageStatics;\n    ipcRenderer: any;\n};\n\nexport type RxStorageIpcRenderer = RxStorageRemote;\nexport function getRxStorageIpcRenderer(\n    settings: RxStorageIpcRendererSettings\n): RxStorageIpcRenderer {\n    const channelId = [\n        IPC_RENDERER_KEY_PREFIX,\n        settings.key\n    ].join('|');\n\n    const messages$ = new Subject<MessageFromRemote>();\n    settings.ipcRenderer.on(channelId, (_event: any, message: any) => {\n        messages$.next(message);\n    });\n\n\n    settings.ipcRenderer.postMessage(\n        channelId,\n        false\n    );\n\n    const send: RxStorageRemoteSettings['send'] = (msg) => {\n        settings.ipcRenderer.postMessage(\n            channelId,\n            msg\n        );\n    };\n    const storage = getRxStorageRemote({\n        identifier: 'electron-ipc-renderer',\n        statics: settings.statics,\n        messages$,\n        send\n    });\n    return storage;\n}\n"],"mappings":";;;;;;AAAA;AACA;AASA;AAgBO,SAASA,uBAAuB,CACnCC,QAAsC,EAClB;EACpB,IAAMC,SAAS,GAAG,CACdC,uCAAuB,EACvBF,QAAQ,CAACG,GAAG,CACf,CAACC,IAAI,CAAC,GAAG,CAAC;EAEX,IAAMC,SAAS,GAAG,IAAIC,aAAO,EAAqB;EAClDN,QAAQ,CAACO,WAAW,CAACC,EAAE,CAACP,SAAS,EAAE,CAACQ,MAAW,EAAEC,OAAY,KAAK;IAC9DL,SAAS,CAACM,IAAI,CAACD,OAAO,CAAC;EAC3B,CAAC,CAAC;EAGFV,QAAQ,CAACO,WAAW,CAACK,WAAW,CAC5BX,SAAS,EACT,KAAK,CACR;EAED,IAAMY,IAAqC,GAAIC,GAAG,IAAK;IACnDd,QAAQ,CAACO,WAAW,CAACK,WAAW,CAC5BX,SAAS,EACTa,GAAG,CACN;EACL,CAAC;EACD,IAAMC,OAAO,GAAG,IAAAC,iCAAkB,EAAC;IAC/BC,UAAU,EAAE,uBAAuB;IACnCC,OAAO,EAAElB,QAAQ,CAACkB,OAAO;IACzBb,SAAS;IACTQ;EACJ,CAAC,CAAC;EACF,OAAOE,OAAO;AAClB"}