{"version":3,"file":"rx-storage-instance-foundationdb.js","names":["RxStorageInstanceFoundationDB","storage","databaseName","collectionName","schema","internals","options","settings","closed","changes$","Subject","primaryPath","getPrimaryFieldOfPrimaryKey","primaryKey","bulkWrite","documentWrites","context","dbsPromise","dbs","categorized","root","doTransaction","tx","ret","success","error","ids","map","row","document","mainTx","at","main","subspace","attachmentTx","attachments","docsInDB","Map","Promise","all","id","get","doc","set","categorizeBulkWriteRows","errors","bulkInsertDocs","forEach","writeRow","docId","Object","values","indexes","indexMeta","indexString","getIndexableString","indexTx","db","bulkUpdateDocs","oldIndexString","ensureNotFalsy","previous","newIndexString","attachmentsAdd","attachment","attachmentMapKey","documentId","attachmentId","attachmentData","attachmentsUpdate","attachmentsRemove","result","eventBulk","events","length","lastState","getNewestOfDocumentStates","checkpoint","lwt","_meta","next","findDocumentsById","withDeleted","docInDb","_deleted","query","preparedQuery","queryFoundationDB","count","documents","mode","getAttachmentData","data","getChangedDocumentsSince","limit","require","keySelector","StreamingMode","index","indexName","getFoundationDBIndexName","lowerBoundString","checkpointPartialDoc","innerResult","getRangeAll","firstGreaterThan","INDEX_MAX","streamingMode","Exact","range","docIds","docsData","concat","lastDoc","lastOfArray","changeStream","asObservable","remove","clearRange","PROMISE_RESOLVE_VOID","close","cleanup","minimumDeletedTime","maxDeletionTime","now","CLEANUP_INDEX","getStartIndexStringFromLowerBound","upperBoundString","getStartIndexStringFromUpperBound","noMoreUndeleted","batchSize","pop","indexMetaInner","subIndexDB","docData","conflictResultionTasks","resolveConflictResultionTask","_taskSolution","reject","Error","complete","createFoundationDBStorageInstance","params","open","directory","encoders","connection","clusterFile","createOrOpen","dir","version","withKeyEncoding","string","withValueEncoding","json","indexDBs","useIndexes","slice","push","useIndexesFinal","indexAr","toArray","unshift","indexDB","getIndexableStringMonad","instance","resolve"],"sources":["../../../../src/plugins/storage-foundationdb/rx-storage-instance-foundationdb.ts"],"sourcesContent":["import { Observable, Subject } from 'rxjs';\nimport { getPrimaryFieldOfPrimaryKey } from '../../rx-schema-helper';\nimport type {\n    BulkWriteRow,\n    CategorizeBulkWriteRowsOutput,\n    EventBulk,\n    RxAttachmentWriteData,\n    RxConflictResultionTask,\n    RxConflictResultionTaskSolution,\n    RxDocumentData,\n    RxDocumentDataById,\n    RxJsonSchema,\n    RxStorageBulkWriteResponse,\n    RxStorageChangeEvent,\n    RxStorageCountResult,\n    RxStorageDefaultCheckpoint,\n    RxStorageInstance,\n    RxStorageInstanceCreationParams,\n    RxStorageQueryResult,\n    StringKeys\n} from '../../types';\nimport type {\n    FoundationDBDatabase,\n    FoundationDBIndexMeta,\n    FoundationDBPreparedQuery,\n    FoundationDBStorageInternals,\n    RxStorageFoundationDB,\n    RxStorageFoundationDBInstanceCreationOptions,\n    RxStorageFoundationDBSettings\n} from './foundationdb-types';\n// import {\n//     open as foundationDBOpen,\n//     directory as foundationDBDirectory,\n//     encoders as foundationDBEncoders,\n//     keySelector as foundationDBKeySelector,\n//     StreamingMode as foundationDBStreamingMode\n// } from 'foundationdb';\nimport {\n    categorizeBulkWriteRows,\n    getNewestOfDocumentStates\n} from '../../rx-storage-helper';\nimport {\n\n    CLEANUP_INDEX,\n    getFoundationDBIndexName\n} from './foundationdb-helpers';\nimport {\n    getIndexableStringMonad,\n    getStartIndexStringFromLowerBound,\n    getStartIndexStringFromUpperBound\n} from '../../custom-index';\nimport {\n    ensureNotFalsy,\n    lastOfArray,\n    now,\n    PROMISE_RESOLVE_VOID,\n    toArray\n} from '../../util';\nimport { queryFoundationDB } from './foundationdb-query';\nimport { INDEX_MAX } from '../../query-planner';\nimport { attachmentMapKey } from '../storage-memory';\n\nexport class RxStorageInstanceFoundationDB<RxDocType> implements RxStorageInstance<\n    RxDocType,\n    FoundationDBStorageInternals<RxDocType>,\n    RxStorageFoundationDBInstanceCreationOptions,\n    RxStorageDefaultCheckpoint\n> {\n    public readonly primaryPath: StringKeys<RxDocumentData<RxDocType>>;\n\n    public closed = false;\n    private changes$: Subject<EventBulk<RxStorageChangeEvent<RxDocumentData<RxDocType>>, RxStorageDefaultCheckpoint>> = new Subject();\n\n    constructor(\n        public readonly storage: RxStorageFoundationDB,\n        public readonly databaseName: string,\n        public readonly collectionName: string,\n        public readonly schema: Readonly<RxJsonSchema<RxDocumentData<RxDocType>>>,\n        public readonly internals: FoundationDBStorageInternals<RxDocType>,\n        public readonly options: Readonly<RxStorageFoundationDBInstanceCreationOptions>,\n        public readonly settings: RxStorageFoundationDBSettings\n    ) {\n        this.primaryPath = getPrimaryFieldOfPrimaryKey(this.schema.primaryKey);\n    }\n\n    async bulkWrite(\n        documentWrites: BulkWriteRow<RxDocType>[],\n        context: string\n    ): Promise<RxStorageBulkWriteResponse<RxDocType>> {\n        const dbs = await this.internals.dbsPromise;\n        let categorized: CategorizeBulkWriteRowsOutput<RxDocType> | undefined = null as any;\n        const result = await dbs.root.doTransaction(async (tx: any) => {\n            const ret: RxStorageBulkWriteResponse<RxDocType> = {\n                success: {},\n                error: {}\n            };\n\n            const ids = documentWrites.map(row => (row.document as any)[this.primaryPath]);\n            const mainTx = tx.at(dbs.main.subspace);\n            const attachmentTx = tx.at(dbs.attachments.subspace);\n            const docsInDB = new Map<string, RxDocumentData<RxDocType>>();\n            /**\n             * TODO this might be faster if fdb\n             * any time adds a bulk-fetch-by-key method.\n             */\n            await Promise.all(\n                ids.map(async (id) => {\n                    const doc = await mainTx.get(id);\n                    docsInDB.set(id, doc);\n                })\n            );\n\n\n            categorized = categorizeBulkWriteRows<RxDocType>(\n                this,\n                this.primaryPath as any,\n                docsInDB,\n                documentWrites,\n                context\n            );\n\n            ret.error = categorized.errors;\n\n            // INSERTS\n            categorized.bulkInsertDocs.forEach(writeRow => {\n                const docId: string = writeRow.document[this.primaryPath] as any;\n                ret.success[docId] = writeRow.document as any;\n\n                // insert document data\n                mainTx.set(docId, writeRow.document);\n\n                // insert secondary indexes\n                Object.values(dbs.indexes).forEach(indexMeta => {\n                    const indexString = indexMeta.getIndexableString(writeRow.document as any);\n                    const indexTx = tx.at(indexMeta.db.subspace);\n                    indexTx.set(indexString, docId);\n                });\n            });\n            // UPDATES\n            categorized.bulkUpdateDocs.forEach((writeRow: BulkWriteRow<RxDocType>) => {\n                const docId: string = writeRow.document[this.primaryPath] as any;\n\n                // overwrite document data\n                mainTx.set(docId, writeRow.document);\n\n                // update secondary indexes\n                Object.values(dbs.indexes).forEach(indexMeta => {\n                    const oldIndexString = indexMeta.getIndexableString(ensureNotFalsy(writeRow.previous));\n                    const newIndexString = indexMeta.getIndexableString(writeRow.document as any);\n                    if (oldIndexString !== newIndexString) {\n                        const indexTx = tx.at(indexMeta.db.subspace);\n                        indexTx.delete(oldIndexString);\n                        indexTx.set(newIndexString, docId);\n                    }\n                });\n                ret.success[docId] = writeRow.document as any;\n            });\n\n            // attachments\n            categorized.attachmentsAdd.forEach(attachment => {\n                attachmentTx.set(\n                    attachmentMapKey(attachment.documentId, attachment.attachmentId),\n                    attachment.attachmentData\n                );\n            });\n            categorized.attachmentsUpdate.forEach(attachment => {\n                attachmentTx.set(\n                    attachmentMapKey(attachment.documentId, attachment.attachmentId),\n                    attachment.attachmentData\n                );\n            });\n            categorized.attachmentsRemove.forEach(attachment => {\n                attachmentTx.delete(\n                    attachmentMapKey(attachment.documentId, attachment.attachmentId)\n                );\n            });\n\n            return ret;\n        });\n        /**\n         * The events must be emitted AFTER the transaction\n         * has finished.\n         * Otherwise an observable changestream might cause a read\n         * to a document that does not already exist outside of the transaction.\n         */\n        if (ensureNotFalsy(categorized).eventBulk.events.length > 0) {\n            const lastState = getNewestOfDocumentStates<any>(\n                this.primaryPath as any,\n                Object.values(result.success)\n            );\n            ensureNotFalsy(categorized).eventBulk.checkpoint = {\n                id: lastState[this.primaryPath],\n                lwt: lastState._meta.lwt\n            };\n            this.changes$.next(ensureNotFalsy(categorized).eventBulk);\n        }\n        return result;\n    }\n\n    async findDocumentsById(ids: string[], withDeleted: boolean): Promise<RxDocumentDataById<RxDocType>> {\n        const dbs = await this.internals.dbsPromise;\n        return dbs.main.doTransaction(async (tx: any) => {\n            const ret: RxDocumentDataById<RxDocType> = {};\n            await Promise.all(\n                ids.map(async (docId) => {\n                    const docInDb = await tx.get(docId);\n                    if (\n                        docInDb &&\n                        (\n                            !docInDb._deleted ||\n                            withDeleted\n                        )\n                    ) {\n                        ret[docId] = docInDb;\n                    }\n                })\n            );\n            return ret;\n        });\n    }\n    query(preparedQuery: FoundationDBPreparedQuery<RxDocType>): Promise<RxStorageQueryResult<RxDocType>> {\n        return queryFoundationDB(this, preparedQuery);\n    }\n    async count(\n        preparedQuery: FoundationDBPreparedQuery<RxDocType>\n    ): Promise<RxStorageCountResult> {\n        /**\n         * At this point in time (end 2022), FoundationDB does not support\n         * range counts. So we have to run a normal query and use the result set length.\n         * @link https://github.com/apple/foundationdb/issues/5981\n         */\n        const result = await this.query(preparedQuery);\n        return {\n            count: result.documents.length,\n            mode: 'fast'\n        };\n    }\n    async getAttachmentData(documentId: string, attachmentId: string): Promise<string> {\n        const dbs = await this.internals.dbsPromise;\n        const attachment = await dbs.attachments.get(attachmentMapKey(documentId, attachmentId));\n        return attachment.data;\n    }\n    async getChangedDocumentsSince(limit: number, checkpoint?: RxStorageDefaultCheckpoint): Promise<{ documents: RxDocumentData<RxDocType>[]; checkpoint: RxStorageDefaultCheckpoint; }> {\n        const {\n            keySelector,\n            StreamingMode\n        } = require('foundationdb');\n        const dbs = await this.internals.dbsPromise;\n        const index = [\n            '_meta.lwt',\n            this.primaryPath as any\n        ];\n        const indexName = getFoundationDBIndexName(index);\n        const indexMeta = dbs.indexes[indexName];\n        let lowerBoundString = '';\n        if (checkpoint) {\n            const checkpointPartialDoc: any = {\n                [this.primaryPath]: checkpoint.id,\n                _meta: {\n                    lwt: checkpoint.lwt\n                }\n            };\n            lowerBoundString = indexMeta.getIndexableString(checkpointPartialDoc);\n        }\n        const result: RxDocumentData<RxDocType>[] = await dbs.root.doTransaction(async (tx: any) => {\n            let innerResult: RxDocumentData<RxDocType>[] = [];\n            const indexTx = tx.at(indexMeta.db.subspace);\n            const mainTx = tx.at(dbs.main.subspace);\n            const range = await indexTx.getRangeAll(\n                keySelector.firstGreaterThan(lowerBoundString),\n                INDEX_MAX,\n                {\n                    limit,\n                    streamingMode: StreamingMode.Exact\n                }\n            );\n            const docIds = range.map((row: string[]) => row[1]);\n            const docsData: RxDocumentData<RxDocType>[] = await Promise.all(\n                docIds.map((docId: string) => mainTx.get(docId))\n            );\n            innerResult = innerResult.concat(docsData);\n            return innerResult;\n        });\n        const lastDoc = lastOfArray(result);\n        return {\n            documents: result,\n            checkpoint: lastDoc ? {\n                id: lastDoc[this.primaryPath] as any,\n                lwt: lastDoc._meta.lwt\n            } : checkpoint ? checkpoint : {\n                id: '',\n                lwt: 0\n            }\n        };\n    }\n    changeStream(): Observable<EventBulk<RxStorageChangeEvent<RxDocType>, RxStorageDefaultCheckpoint>> {\n        return this.changes$.asObservable();\n    }\n\n    async remove(): Promise<void> {\n        const dbs = await this.internals.dbsPromise;\n        await dbs.root.doTransaction((tx: any) => {\n            tx.clearRange('', INDEX_MAX);\n            return PROMISE_RESOLVE_VOID;\n        });\n        return this.close();\n    }\n    async cleanup(minimumDeletedTime: number): Promise<boolean> {\n        const {\n            keySelector,\n            StreamingMode\n        } = require('foundationdb');\n        const maxDeletionTime = now() - minimumDeletedTime;\n        const dbs = await this.internals.dbsPromise;\n        const index = CLEANUP_INDEX;\n        const indexName = getFoundationDBIndexName(index);\n        const indexMeta = dbs.indexes[indexName];\n        const lowerBoundString = getStartIndexStringFromLowerBound(\n            this.schema,\n            index,\n            [\n                true,\n                /**\n                 * Do not use 0 here,\n                 * because 1 is the minimum value for _meta.lwt\n                 */\n                1\n            ],\n            false\n        );\n        const upperBoundString = getStartIndexStringFromUpperBound(\n            this.schema,\n            index,\n            [\n                true,\n                maxDeletionTime\n            ],\n            true\n        );\n        let noMoreUndeleted: boolean = true;\n        await dbs.root.doTransaction(async (tx: any) => {\n            const batchSize = ensureNotFalsy(this.settings.batchSize);\n            const indexTx = tx.at(indexMeta.db.subspace);\n            const mainTx = tx.at(dbs.main.subspace);\n            const range = await indexTx.getRangeAll(\n                keySelector.firstGreaterThan(lowerBoundString),\n                upperBoundString,\n                {\n                    limit: batchSize + 1, // get one more extra to detect what to return from cleanup()\n                    streamingMode: StreamingMode.Exact\n                }\n            );\n            if (range.length > batchSize) {\n                noMoreUndeleted = false;\n                range.pop();\n            }\n            const docIds = range.map((row: string[]) => row[1]);\n            const docsData: RxDocumentData<RxDocType>[] = await Promise.all(docIds.map((docId: string) => mainTx.get(docId)));\n\n            Object\n                .values(dbs.indexes)\n                .forEach(indexMetaInner => {\n                    const subIndexDB = tx.at(indexMetaInner.db.subspace);\n                    docsData.forEach(docData => {\n                        const indexString = indexMetaInner.getIndexableString(docData);\n                        subIndexDB.delete(indexString);\n                    });\n                });\n            docIds.forEach((id: string) => mainTx.delete(id));\n        });\n\n        return noMoreUndeleted;\n    }\n\n    conflictResultionTasks(): Observable<RxConflictResultionTask<RxDocType>> {\n        return new Subject<any>().asObservable();\n    }\n    resolveConflictResultionTask(_taskSolution: RxConflictResultionTaskSolution<RxDocType>): Promise<void> {\n        return PROMISE_RESOLVE_VOID;\n    }\n\n    async close() {\n        if (this.closed) {\n            return Promise.reject(new Error('already closed'));\n        }\n        this.closed = true;\n        this.changes$.complete();\n\n        const dbs = await this.internals.dbsPromise;\n        dbs.root.close();\n\n        // TODO shouldn't we close the index databases?\n        // Object.values(dbs.indexes).forEach(db => db.close());\n    }\n}\n\n\nexport function createFoundationDBStorageInstance<RxDocType>(\n    storage: RxStorageFoundationDB,\n    params: RxStorageInstanceCreationParams<RxDocType, RxStorageFoundationDBInstanceCreationOptions>,\n    settings: RxStorageFoundationDBSettings\n): Promise<RxStorageInstanceFoundationDB<RxDocType>> {\n    const primaryPath = getPrimaryFieldOfPrimaryKey(params.schema.primaryKey);\n\n    const {\n        open,\n        directory,\n        encoders\n    } = require('foundationdb');\n\n    const connection = open(settings.clusterFile);\n    const dbsPromise = (async () => {\n        const dir = await directory.createOrOpen(connection, 'rxdb');\n\n        const root = connection\n            .at(dir)\n            .at(params.databaseName + '.')\n            .at(params.collectionName + '.')\n            .at(params.schema.version + '.');\n        const main: FoundationDBDatabase<RxDocType> = root\n            .at('main.')\n            .withKeyEncoding(encoders.string) // automatically encode & decode keys using tuples\n            .withValueEncoding(encoders.json) as any; // and values using JSON\n\n\n        const events: FoundationDBDatabase<EventBulk<RxStorageChangeEvent<RxDocumentData<RxDocType>>, RxStorageDefaultCheckpoint>> = root\n            .at('events.')\n            .withKeyEncoding(encoders.string)\n            .withValueEncoding(encoders.json) as any;\n\n        const attachments: FoundationDBDatabase<RxAttachmentWriteData> = root\n            .at('attachments.')\n            .withKeyEncoding(encoders.string)\n            .withValueEncoding(encoders.json) as any;\n\n\n        const indexDBs: { [indexName: string]: FoundationDBIndexMeta<RxDocType>; } = {};\n        const useIndexes = params.schema.indexes ? params.schema.indexes.slice(0) : [];\n        useIndexes.push([primaryPath]);\n        const useIndexesFinal = useIndexes.map(index => {\n            const indexAr = toArray(index);\n            indexAr.unshift('_deleted');\n            return indexAr;\n        });\n        // used for `getChangedDocumentsSince()`\n        useIndexesFinal.push([\n            '_meta.lwt',\n            primaryPath\n        ]);\n        useIndexesFinal.push(CLEANUP_INDEX);\n        useIndexesFinal.forEach(indexAr => {\n            const indexName = getFoundationDBIndexName(indexAr);\n            const indexDB = root.at(indexName + '.')\n                .withKeyEncoding(encoders.string)\n                .withValueEncoding(encoders.string);\n            indexDBs[indexName] = {\n                indexName,\n                db: indexDB,\n                getIndexableString: getIndexableStringMonad(params.schema, indexAr),\n                index: indexAr\n            };\n        });\n\n        return {\n            root,\n            main,\n            events,\n            attachments,\n            indexes: indexDBs\n        };\n    })();\n\n\n    const internals: FoundationDBStorageInternals<RxDocType> = {\n        connection,\n        dbsPromise: dbsPromise\n    };\n\n    const instance = new RxStorageInstanceFoundationDB(\n        storage,\n        params.databaseName,\n        params.collectionName,\n        params.schema,\n        internals,\n        params.options,\n        settings\n    );\n    return Promise.resolve(instance);\n}\n"],"mappings":"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"}