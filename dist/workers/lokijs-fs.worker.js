(()=>{var e={1924:(e,t,r)=>{"use strict";var n=r(210),i=r(5559),o=i(n("String.prototype.indexOf"));e.exports=function(e,t){var r=n(e,!!t);return"function"==typeof r&&o(e,".prototype.")>-1?i(r):r}},5559:(e,t,r)=>{"use strict";var n=r(8612),i=r(210),o=i("%Function.prototype.apply%"),s=i("%Function.prototype.call%"),a=i("%Reflect.apply%",!0)||n.call(s,o),u=i("%Object.getOwnPropertyDescriptor%",!0),c=i("%Object.defineProperty%",!0),l=i("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=a(n,s,arguments);if(u&&c){var r=u(t,"length");r.configurable&&c(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var f=function(){return a(n,o,arguments)};c?c(e.exports,"apply",{value:f}):e.exports.apply=f},6313:e=>{var t=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,r,n;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{n=Promise}catch(e){n=function(){}}function i(o,a,u,c,l){"object"==typeof a&&(u=a.depth,c=a.prototype,l=a.includeNonEnumerable,a=a.circular);var f=[],h=[],p="undefined"!=typeof Buffer;return void 0===a&&(a=!0),void 0===u&&(u=1/0),function o(u,d){if(null===u)return null;if(0===d)return u;var y,v;if("object"!=typeof u)return u;if(e(u,t))y=new t;else if(e(u,r))y=new r;else if(e(u,n))y=new n((function(e,t){u.then((function(t){e(o(t,d-1))}),(function(e){t(o(e,d-1))}))}));else if(i.__isArray(u))y=[];else if(i.__isRegExp(u))y=new RegExp(u.source,s(u)),u.lastIndex&&(y.lastIndex=u.lastIndex);else if(i.__isDate(u))y=new Date(u.getTime());else{if(p&&Buffer.isBuffer(u))return y=Buffer.allocUnsafe?Buffer.allocUnsafe(u.length):new Buffer(u.length),u.copy(y),y;e(u,Error)?y=Object.create(u):void 0===c?(v=Object.getPrototypeOf(u),y=Object.create(v)):(y=Object.create(c),v=c)}if(a){var g=f.indexOf(u);if(-1!=g)return h[g];f.push(u),h.push(y)}for(var m in e(u,t)&&u.forEach((function(e,t){var r=o(t,d-1),n=o(e,d-1);y.set(r,n)})),e(u,r)&&u.forEach((function(e){var t=o(e,d-1);y.add(t)})),u){var b;v&&(b=Object.getOwnPropertyDescriptor(v,m)),b&&null==b.set||(y[m]=o(u[m],d-1))}if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(u);for(m=0;m<w.length;m++){var S=w[m];(!(P=Object.getOwnPropertyDescriptor(u,S))||P.enumerable||l)&&(y[S]=o(u[S],d-1),P.enumerable||Object.defineProperty(y,S,{enumerable:!1}))}}if(l){var I=Object.getOwnPropertyNames(u);for(m=0;m<I.length;m++){var P,O=I[m];(P=Object.getOwnPropertyDescriptor(u,O))&&P.enumerable||(y[O]=o(u[O],d-1),Object.defineProperty(y,O,{enumerable:!1}))}}return y}(o,u)}function o(e){return Object.prototype.toString.call(e)}function s(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=s,i}();e.exports&&(e.exports=t)},5643:e=>{e.exports=!1},624:e=>{function t(e){if(e)return function(e){for(var r in t.prototype)e[r]=t.prototype[r];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},t.prototype.once=function(e,t){var r=this;function n(){r.off(e,n),t.apply(this,arguments)}return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r,n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks[e];if(r)for(var n=0,i=(r=r.slice(0)).length;n<i;++n)r[n].apply(this,t);return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}},7187:e=>{"use strict";var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&y(e,"error",t,r)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,o,s,c;if(a(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),s=o[t]),void 0===s)s=o[t]=r,++e._eventsCount;else if("function"==typeof s?s=o[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(i=u(e))>0&&s.length>i&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=s.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function h(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):d(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function d(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function y(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)n(u,this,t);else{var c=u.length,l=d(u,c);for(r=0;r<c;++r)n(l[r],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return a(t),this.on(e,f(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,f(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){s=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return h(this,e,!0)},o.prototype.rawListeners=function(e){return h(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4063:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(i=n;0!=i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!=i--;){var s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!=t&&r!=r}},9804:e=>{var t=Object.prototype.hasOwnProperty,r=Object.prototype.toString;e.exports=function(e,n,i){if("[object Function]"!==r.call(n))throw new TypeError("iterator must be a function");var o=e.length;if(o===+o)for(var s=0;s<o;s++)n.call(i,e[s],s,e);else for(var a in e)t.call(e,a)&&n.call(i,e[a],a,e)}},7648:e=>{"use strict";var t="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,n=Object.prototype.toString,i="[object Function]";e.exports=function(e){var o=this;if("function"!=typeof o||n.call(o)!==i)throw new TypeError(t+o);for(var s,a=r.call(arguments,1),u=function(){if(this instanceof s){var t=o.apply(this,a.concat(r.call(arguments)));return Object(t)===t?t:this}return o.apply(e,a.concat(r.call(arguments)))},c=Math.max(0,o.length-a.length),l=[],f=0;f<c;f++)l.push("$"+f);if(s=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(u),o.prototype){var h=function(){};h.prototype=o.prototype,s.prototype=new h,h.prototype=null}return s}},8612:(e,t,r)=>{"use strict";var n=r(7648);e.exports=Function.prototype.bind||n},210:(e,t,r)=>{"use strict";var n,i=SyntaxError,o=Function,s=TypeError,a=function(e){try{return o('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var c=function(){throw new s},l=u?function(){try{return c}catch(e){try{return u(arguments,"callee").get}catch(e){return c}}}():c,f=r(1405)(),h=Object.getPrototypeOf||function(e){return e.__proto__},p={},d="undefined"==typeof Uint8Array?n:h(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":f?h([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":p,"%AsyncGenerator%":p,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":p,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":p,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":f?h(h([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&f?h((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&f?h((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":f?h(""[Symbol.iterator]()):n,"%Symbol%":f?Symbol:n,"%SyntaxError%":i,"%ThrowTypeError%":l,"%TypedArray%":d,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},v=function e(t){var r;if("%AsyncFunction%"===t)r=a("async function () {}");else if("%GeneratorFunction%"===t)r=a("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=a("async function* () {}");else if("%AsyncGenerator%"===t){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(r=h(i.prototype))}return y[t]=r,r},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},m=r(8612),b=r(7642),w=m.call(Function.call,Array.prototype.concat),S=m.call(Function.apply,Array.prototype.splice),I=m.call(Function.call,String.prototype.replace),P=m.call(Function.call,String.prototype.slice),O=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,A=/\\(\\)?/g,x=function(e){var t=P(e,0,1),r=P(e,-1);if("%"===t&&"%"!==r)throw new i("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==t)throw new i("invalid intrinsic syntax, expected opening `%`");var n=[];return I(e,O,(function(e,t,r,i){n[n.length]=r?I(i,A,"$1"):t||e})),n},k=function(e,t){var r,n=e;if(b(g,n)&&(n="%"+(r=g[n])[0]+"%"),b(y,n)){var o=y[n];if(o===p&&(o=v(n)),void 0===o&&!t)throw new s("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:r,name:n,value:o}}throw new i("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new s('"allowMissing" argument must be a boolean');var r=x(e),n=r.length>0?r[0]:"",o=k("%"+n+"%",t),a=o.name,c=o.value,l=!1,f=o.alias;f&&(n=f[0],S(r,w([0,1],f)));for(var h=1,p=!0;h<r.length;h+=1){var d=r[h],v=P(d,0,1),g=P(d,-1);if(('"'===v||"'"===v||"`"===v||'"'===g||"'"===g||"`"===g)&&v!==g)throw new i("property names with quotes must have matching quotes");if("constructor"!==d&&p||(l=!0),b(y,a="%"+(n+="."+d)+"%"))c=y[a];else if(null!=c){if(!(d in c)){if(!t)throw new s("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&h+1>=r.length){var m=u(c,d);c=(p=!!m)&&"get"in m&&!("originalValue"in m.get)?m.get:c[d]}else p=b(c,d),c=c[d];p&&!l&&(y[a]=c)}}return c}},1405:(e,t,r)=>{"use strict";var n="undefined"!=typeof Symbol&&Symbol,i=r(5419);e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&i())))}},5419:e=>{"use strict";e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var n=Object.getOwnPropertySymbols(e);if(1!==n.length||n[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}},6410:(e,t,r)=>{"use strict";var n=r(5419);e.exports=function(){return n()&&!!Symbol.toStringTag}},7642:(e,t,r)=>{"use strict";var n=r(8612);e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},5717:e=>{"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},2584:(e,t,r)=>{"use strict";var n=r(6410)(),i=r(1924)("Object.prototype.toString"),o=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===i(e)},s=function(e){return!!o(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==i(e)&&"[object Function]"===i(e.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,e.exports=a?o:s},9134:e=>{e.exports=function(){return"undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type||(!("undefined"==typeof process||"object"!=typeof process.versions||!process.versions.electron)||"object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent.indexOf("Electron")>=0)}},8662:(e,t,r)=>{"use strict";var n,i=Object.prototype.toString,o=Function.prototype.toString,s=/^\s*(?:function)?\*/,a=r(6410)(),u=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(s.test(o.call(e)))return!0;if(!a)return"[object GeneratorFunction]"===i.call(e);if(!u)return!1;if(void 0===n){var t=function(){if(!a)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&u(t)}return u(e)===n}},6898:e=>{"use strict";e.exports=e=>!!e&&("symbol"==typeof Symbol.observable&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())},5692:(e,t,r)=>{"use strict";var n=r(9804),i=r(3083),o=r(1924),s=o("Object.prototype.toString"),a=r(6410)(),u="undefined"==typeof globalThis?r.g:globalThis,c=i(),l=o("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},f=o("String.prototype.slice"),h={},p=r(882),d=Object.getPrototypeOf;a&&p&&d&&n(c,(function(e){var t=new u[e];if(Symbol.toStringTag in t){var r=d(t),n=p(r,Symbol.toStringTag);if(!n){var i=d(r);n=p(i,Symbol.toStringTag)}h[e]=n.get}}));e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!a||!(Symbol.toStringTag in e)){var t=f(s(e),8,-1);return l(c,t)>-1}return!!p&&function(e){var t=!1;return n(h,(function(r,n){if(!t)try{t=r.call(e)===n}catch(e){}})),t}(e)}},6194:function(e,t,r){var n,i,o;i=[],void 0===(o="function"==typeof(n=function(){return function(){const e=r(693),t=r(7462),n=r(3086);function i(){this.mode="reference",this.dbref=null,this.dirtyPartitions=[]}return i.prototype.generateDestructured=function*(e){var t,r;if((e=e||{}).hasOwnProperty("partition")||(e.partition=-1),-1!==e.partition){var n,i;if(e.partition>=0)for(n=this.dbref.collections[e.partition].data.length,i=0;i<n;i++)yield JSON.stringify(this.dbref.collections[e.partition].data[i])}else{for(r=this.dbref.copy(),t=0;t<r.collections.length;t++)r.collections[t].data=[];yield r.serialize({serializationMethod:"normal"})}},i.prototype.loadDatabase=function(r,i){var o,s,a,u=this;this.dbref=null,e.stat(r,(function(c,l){var f;if(c)return"ENOENT"===c.code?void i(null):void i(c);l.isFile()?(o=e.createReadStream(r),s=new n,(a=t.createInterface(o,s)).on("line",(function(e){if(null===u.dbref&&""!==e)try{u.dbref=JSON.parse(e)}catch(e){f=e}})),a.on("close",(function(){f?i(f):u.dbref.collections.length>0&&u.loadNextCollection(r,0,(function(){i(u.dbref)}))}))):i(new Error(r+" is not a valid file."))}))},i.prototype.loadNextCollection=function(r,i,o){var s,a=e.createReadStream(r+"."+i),u=new n,c=t.createInterface(a,u),l=this;c.on("line",(function(e){if(""!==e){try{s=JSON.parse(e)}catch(e){o(e)}l.dbref.collections[i].data.push(s)}})),c.on("close",(function(e){a=null,u=null,c=null,s=null,++i<l.dbref.collections.length?l.loadNextCollection(r,i,o):o()}))},i.prototype.getPartition=function*(){var e,t=this.dbref.collections.length;for(yield-1,e=0;e<t;e++)this.dbref.collections[e].dirty&&(yield e)},i.prototype.exportDatabase=function(e,t,r){this.dbref=t;var n=this.getPartition();this.saveNextPartition(e,n,(function(){r(null)}))},i.prototype.saveNextPartition=function(t,r,n){var i,o=this,s=r.next();if(s.done)n();else{i=t+(-1===s.value?"":"."+s.value);var a=e.createWriteStream(i);for(var u of(a.on("close",(function(){o.saveNextPartition(t,r,n)})),this.generateDestructured({partition:s.value})))a.write(u+"\n");a.end()}},i}()})?n.apply(t,i):n)||(e.exports=o)},7996:function(e,t){var r,n,i;n=[],void 0===(i="function"==typeof(r=function(){return function(){function e(e,t){if(this.app="loki",this.options=t||{},void 0!==e&&(this.app=e),this.catalog=null,!this.checkAvailability())throw new Error("indexedDB does not seem to be supported for your environment")}function t(e){this.db=null,this.initializeLokiCatalog(e)}return e.prototype.closeDatabase=function(){this.catalog&&this.catalog.db&&(this.catalog.db.close(),this.catalog.db=null)},e.prototype.checkAvailability=function(){return!("undefined"==typeof indexedDB||!indexedDB)},e.prototype.loadDatabase=function(e,r){var n=this.app,i=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(n,e,(function(e){if("function"==typeof r){if(0===e.id)return void r(null);r(e.val)}else console.log(e.val)})):this.catalog=new t((function(t){i.catalog=t,i.loadDatabase(e,r)}))},e.prototype.loadKey=e.prototype.loadDatabase,e.prototype.saveDatabase=function(e,r,n){var i=this.app,o=this;function s(e){e&&!0===e.success?n(null):n(new Error("Error saving database")),o.options.closeAfterSave&&o.closeDatabase()}null!==this.catalog&&null!==this.catalog.db?this.catalog.setAppKey(i,e,r,s):this.catalog=new t((function(t){o.saveDatabase(e,r,s)}))},e.prototype.saveKey=e.prototype.saveDatabase,e.prototype.deleteDatabase=function(e,r){var n=this.app,i=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKey(n,e,(function(e){var t=e.id;0!==t?i.catalog.deleteAppKey(t,r):"function"==typeof r&&r({success:!0})})):this.catalog=new t((function(t){i.catalog=t,i.deleteDatabase(e,r)}))},e.prototype.deleteKey=e.prototype.deleteDatabase,e.prototype.deleteDatabasePartitions=function(e){var t=this;this.getDatabaseList((function(r){r.forEach((function(r){r.startsWith(e)&&t.deleteDatabase(r)}))}))},e.prototype.getDatabaseList=function(e){var r=this.app,n=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAppKeys(r,(function(t){for(var r=[],n=0;n<t.length;n++)r.push(t[n].key);"function"==typeof e?e(r):r.forEach((function(e){console.log(e)}))})):this.catalog=new t((function(t){n.catalog=t,n.getDatabaseList(e)}))},e.prototype.getKeyList=e.prototype.getDatabaseList,e.prototype.getCatalogSummary=function(e){this.app;var r=this;null!==this.catalog&&null!==this.catalog.db?this.catalog.getAllKeys((function(t){for(var r,n,i,o,s,a=[],u=0;u<t.length;u++)i=(r=t[u]).app||"",o=r.key||"",s=r.val||"",n=2*i.length+2*o.length+s.length+1,a.push({app:r.app,key:r.key,size:n});"function"==typeof e?e(a):a.forEach((function(e){console.log(e)}))})):this.catalog=new t((function(t){r.catalog=t,r.getCatalogSummary(e)}))},t.prototype.initializeLokiCatalog=function(e){var t=indexedDB.open("LokiCatalog",1),r=this;t.onupgradeneeded=function(e){var t=e.target.result;if(t.objectStoreNames.contains("LokiAKV")&&t.deleteObjectStore("LokiAKV"),!t.objectStoreNames.contains("LokiAKV")){var r=t.createObjectStore("LokiAKV",{keyPath:"id",autoIncrement:!0});r.createIndex("app","app",{unique:!1}),r.createIndex("key","key",{unique:!1}),r.createIndex("appkey","appkey",{unique:!0})}},t.onsuccess=function(t){r.db=t.target.result,"function"==typeof e&&e(r)},t.onerror=function(e){throw e}},t.prototype.getAppKey=function(e,t,r){var n,i=e+","+t,o=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("appkey").get(i);o.onsuccess=(n=r,function(e){var t=e.target.result;null==t&&(t={id:0,success:!1}),"function"==typeof n?n(t):console.log(t)}),o.onerror=function(e){return function(t){if("function"!=typeof e)throw t;e({id:0,success:!1})}}(r)},t.prototype.getAppKeyById=function(e,t,r){this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").get(e).onsuccess=function(e,t){return function(r){"function"==typeof t?t(r.target.result,e):console.log(r.target.result)}}(r,t)},t.prototype.setAppKey=function(e,t,r,n){var i,o=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV"),s=o.index("appkey"),a=e+","+t,u=s.get(a);u.onsuccess=function(i){var s=i.target.result;null==s?s={app:e,key:t,appkey:e+","+t,val:r}:s.val=r;var a,c=o.put(s);c.onerror=(a=n,function(e){"function"==typeof a?a({success:!1}):(console.error("LokiCatalog.setAppKey (set) onerror"),console.error(u.error))}),c.onsuccess=function(e){return function(t){"function"==typeof e&&e({success:!0})}}(n)},u.onerror=(i=n,function(e){"function"==typeof i?i({success:!1}):(console.error("LokiCatalog.setAppKey (get) onerror"),console.error(u.error))})},t.prototype.deleteAppKey=function(e,t){var r,n=this.db.transaction(["LokiAKV"],"readwrite").objectStore("LokiAKV").delete(e);n.onsuccess=(r=t,function(e){"function"==typeof r&&r({success:!0})}),n.onerror=function(e){return function(t){"function"==typeof e?e({success:!1}):(console.error("LokiCatalog.deleteAppKey raised onerror"),console.error(n.error))}}(t)},t.prototype.getAppKeys=function(e,t){var r,n=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").index("app"),i=IDBKeyRange.only(e),o=n.openCursor(i),s=[];o.onsuccess=function(e,t){return function(r){var n=r.target.result;if(n){var i=n.value;e.push(i),n.continue()}else"function"==typeof t?t(e):console.log(e)}}(s,t),o.onerror=(r=t,function(e){"function"==typeof r?r(null):(console.error("LokiCatalog.getAppKeys raised onerror"),console.error(e))})},t.prototype.getAllKeys=function(e){var t,r=this.db.transaction(["LokiAKV"],"readonly").objectStore("LokiAKV").openCursor(),n=[];r.onsuccess=function(e,t){return function(r){var n=r.target.result;if(n){var i=n.value;e.push(i),n.continue()}else"function"==typeof t?t(e):console.log(e)}}(n,e),r.onerror=(t=e,function(e){"function"==typeof t&&t(null)})},e}()})?r.apply(t,n):r)||(e.exports=i)},3050:function(e,t,r){var n,i,o;i=[],n=function(){return function(){"use strict";var e=Object.prototype.hasOwnProperty;function t(e){var r,i;if(Array.isArray(e)){for(i=0;i<e.length;i++)t(e[i]);n(e)}else if(null!==e&&"object"==typeof e){for(r in e)e.hasOwnProperty(r)&&t(e[r]);n(e)}}function n(e){Object.isFrozen(e)||Object.freeze(e)}function i(e){return Object.isFrozen(e)?g(e,"shallow"):e}var o={copyProperties:function(e,t){var r;for(r in e)t[r]=e[r]},resolveTransformObject:function(e,t,r){var n,i;if("number"!=typeof r&&(r=0),++r>=10)return e;for(n in e)"string"==typeof e[n]&&0===e[n].indexOf("[%lktxp]")?(i=e[n].substring(8),t.hasOwnProperty(i)&&(e[n]=t[i])):"object"==typeof e[n]&&(e[n]=o.resolveTransformObject(e[n],t,r));return e},resolveTransformParams:function(e,t){var r,n,i=[];if(void 0===t)return e;for(r=0;r<e.length;r++)n=g(e[r],"shallow-recurse-objects"),i.push(o.resolveTransformObject(n,t));return i},getIn:function(e,t,r){if(null!=e){if(!r)return e[t];if("string"==typeof t&&(t=t.split(".")),!Array.isArray(t))throw new Error("path must be a string or array. Found "+typeof t);for(var n=0,i=t.length;null!=e&&n<i;)e=e[t[n++]];return n&&n==i?e:void 0}}},s={aeq:a,lt:u,gt:c};function a(e,t){var r,n,i,o;if(e===t)return!0;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:i=1;break;case!1:i=3;break;case!0:i=4;break;case"":i=5;break;default:i=e==e?9:0}switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}if(9!==i||9!==o)return i===o}return r=Number(e),n=Number(t),r==r||n==n?r===n:(r=e.toString())==(n=t.toString())}function u(e,t,r){var n,i,o,s;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}switch(t){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=t==t?9:0}if(9!==o||9!==s)return o===s?r:o<s}return n=Number(e),i=Number(t),n==n&&i==i?n<i||!(n>i)&&r:n==n&&i!=i||(i!=i||n==n)&&(e<t||!(e>t)&&(e==t?r:(n=e.toString())<(i=t.toString())||n==i&&r))}function c(e,t,r){var n,i,o,s;if(!e||!t||!0===e||!0===t||e!=e||t!=t){switch(e){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=e==e?9:0}switch(t){case void 0:case null:s=1;break;case!1:s=3;break;case!0:s=4;break;case"":s=5;break;default:s=t==t?9:0}if(9!==o||9!==s)return o===s?r:o>s}return n=Number(e),i=Number(t),n==n&&i==i?n>i||!(n<i)&&r:(n!=n||i==i)&&(i==i&&n!=n||e>t||!(e<t)&&(e==t?r:(n=e.toString())>(i=t.toString())||n==i&&r))}function l(e,t,r){return s.aeq(e,t)?0:s.lt(e,t,!1)?r?1:-1:s.gt(e,t,!1)?r?-1:1:0}function f(e,t,r){for(var n,i,s,a,u,c=0,f=0,h=e.length;f<h;f++)if(~(i=(n=e[f])[0]).indexOf(".")?(u=i.split("."),s=o.getIn(t,u,!0),a=o.getIn(r,u,!0)):(s=t[i],a=r[i]),0!==(c=l(s,a,n[1])))return c;return 0}function h(e,t,r,n,i,o){var s,a=o||0,u=t[a],c=!1;if("object"==typeof e&&u in e&&(s=e[u]),a+1>=t.length)c=r(s,n,i);else if(Array.isArray(s))for(var l=0,f=s.length;l<f&&!0!==(c=h(s[l],t,r,n,i,a+1));l+=1);else c=h(s,t,r,n,i,a+1);return c}function p(t){return"string"==typeof t||Array.isArray(t)?function(e){return-1!==t.indexOf(e)}:"object"==typeof t&&null!==t?function(r){return e.call(t,r)}:null}function d(t,r,n){for(var i in r)if(e.call(r,i))return y[i](t,r[i],n);return!1}var y={$eq:function(e,t){return e===t},$aeq:function(e,t){return e==t},$ne:function(e,t){return t!=t?e==e:e!==t},$dteq:function(e,t){return s.aeq(e,t)},$gt:function(e,t){return s.gt(e,t,!1)},$gte:function(e,t){return s.gt(e,t,!0)},$lt:function(e,t){return s.lt(e,t,!1)},$lte:function(e,t){return s.lt(e,t,!0)},$jgt:function(e,t){return e>t},$jgte:function(e,t){return e>=t},$jlt:function(e,t){return e<t},$jlte:function(e,t){return e<=t},$between:function(e,t){return null!=e&&s.gt(e,t[0],!0)&&s.lt(e,t[1],!0)},$jbetween:function(e,t){return null!=e&&e>=t[0]&&e<=t[1]},$in:function(e,t){return-1!==t.indexOf(e)},$inSet:function(e,t){return t.has(e)},$nin:function(e,t){return-1===t.indexOf(e)},$keyin:function(e,t){return e in t},$nkeyin:function(e,t){return!(e in t)},$definedin:function(e,t){return void 0!==t[e]},$undefinedin:function(e,t){return void 0===t[e]},$regex:function(e,t){return t.test(e)},$containsString:function(e,t){return"string"==typeof e&&-1!==e.indexOf(t)},$containsNone:function(e,t){return!y.$containsAny(e,t)},$containsAny:function(e,t){var r=p(e);return null!==r&&(Array.isArray(t)?t.some(r):r(t))},$contains:function(e,t){var r=p(e);return null!==r&&(Array.isArray(t)?t.every(r):r(t))},$elemMatch:function(e,t){return!!Array.isArray(e)&&e.some((function(e){return Object.keys(t).every((function(r){var n=t[r];return"object"==typeof n&&n||(n={$eq:n}),-1!==r.indexOf(".")?h(e,r.split("."),d,t[r],e):d(e[r],n,e)}))}))},$type:function(e,t,r){var n=typeof e;return"object"===n&&(Array.isArray(e)?n="array":e instanceof Date&&(n="date")),"object"!=typeof t?n===t:d(n,t,r)},$finite:function(e,t){return t===isFinite(e)},$size:function(e,t,r){return!!Array.isArray(e)&&("object"!=typeof t?e.length===t:d(e.length,t,r))},$len:function(e,t,r){return"string"==typeof e&&("object"!=typeof t?e.length===t:d(e.length,t,r))},$where:function(e,t){return!0===t(e)},$not:function(e,t,r){return!d(e,t,r)},$and:function(e,t,r){for(var n=0,i=t.length;n<i;n+=1)if(!d(e,t[n],r))return!1;return!0},$or:function(e,t,r){for(var n=0,i=t.length;n<i;n+=1)if(d(e,t[n],r))return!0;return!1},$exists:function(e,t){return t?void 0!==e:void 0===e}};["$eq","$aeq","$ne","$dteq","$gt","$gte","$lt","$lte","$jgt","$jgte","$jlt","$jlte","$type"].forEach((function(e){var t=y[e];y["$"+e]=function(e,r,n){if("string"==typeof r)return t(e,n[r]);if("function"==typeof r)return t(e,r(n));throw new Error("Invalid argument to $$ matcher")}}));var v={$eq:y.$eq,$aeq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};function g(e,t){if(null==e)return null;var r;switch(t||"parse-stringify"){case"parse-stringify":r=JSON.parse(JSON.stringify(e));break;case"jquery-extend-deep":r=jQuery.extend(!0,{},e);break;case"shallow":r=Object.create(e.constructor.prototype),Object.keys(e).map((function(t){r[t]=e[t]}));break;case"shallow-assign":r=Object.create(e.constructor.prototype),Object.assign(r,e);break;case"shallow-recurse-objects":r=g(e,"shallow"),Object.keys(e).forEach((function(t){"object"==typeof e[t]&&"Object"===e[t].constructor.name?r[t]=g(e[t],"shallow-recurse-objects"):Array.isArray(e[t])&&(r[t]=m(e[t],"shallow-recurse-objects"))}))}return r}function m(e,t){if("parse-stringify"==t)return g(e,t);for(var r=[],n=0,i=e.length;n<i;n++)r[n]=g(e[n],t);return r}function b(){try{return window&&void 0!==window.localStorage&&null!==window.localStorage}catch(e){return!1}}function w(){}function S(e,t){this.filename=e||"loki.db",this.collections=[],this.databaseVersion=1.5,this.engineVersion=1.5,this.autosave=!1,this.autosaveInterval=5e3,this.autosaveHandle=null,this.throttledSaves=!0,this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,this.throttledSavePending=!1,this.throttledCallbacks=[],this.verbose=!(!t||!t.hasOwnProperty("verbose"))&&t.verbose,this.events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]};var n=function(){return void 0!==r.g&&(r.g.android||r.g.NSObject)?"NATIVESCRIPT":"undefined"==typeof window||void 0!==r.g&&r.g.window&&"undefined"!=typeof process?"NODEJS":"undefined"!=typeof document?-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER":"CORDOVA"};t&&t.hasOwnProperty("env")?this.ENV=t.env:this.ENV=n(),"undefined"===this.ENV&&(this.ENV="NODEJS"),this.configureOptions(t,!0),this.on("init",this.clearChanges)}function I(e){this.hashStore={},this.options=e||{},this.options.hasOwnProperty("asyncResponses")||(this.options.asyncResponses=!1),this.options.hasOwnProperty("asyncTimeout")||(this.options.asyncTimeout=50)}function P(e,t){if(this.mode="reference",this.adapter=null,this.options=t||{},this.dbref=null,this.dbname="",this.pageIterator={},!e)throw new Error("LokiPartitioningAdapter requires a (non-reference mode) adapter on construction");if("reference"===e.mode)throw new Error("LokiPartitioningAdapter cannot be instantiated with a reference mode adapter");this.adapter=e,this.options.hasOwnProperty("paging")||(this.options.paging=!1),this.options.hasOwnProperty("pageSize")||(this.options.pageSize=26214400),this.options.hasOwnProperty("delimiter")||(this.options.delimiter="$<\n")}function O(){try{this.fs=r(693)}catch(e){this.fs=null}}function A(){}function x(e,t){return t=t||{},this.collection=e,this.filteredrows=[],this.filterInitialized=!1,this}function k(e,t){if("$regex"===e)Array.isArray(t)?t=new RegExp(t[0],t[1]):t instanceof RegExp||(t=new RegExp(t));else if("object"==typeof t)for(var r in t)"$regex"!==r&&"object"!=typeof t[r]||(t[r]=k(r,t[r]));return t}function j(e,t,r){this.collection=e,this.name=t,this.rebuildPending=!1,this.options=r||{},this.options.hasOwnProperty("persistent")||(this.options.persistent=!1),this.options.hasOwnProperty("sortPriority")||(this.options.sortPriority="passive"),this.options.hasOwnProperty("minRebuildInterval")||(this.options.minRebuildInterval=1),this.resultset=new x(e),this.resultdata=[],this.resultsdirty=!1,this.cachedresultset=null,this.filterPipeline=[],this.collection.disableFreeze||Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,this.events={rebuild:[],filter:[],sort:[]}}function _(t,r){this.name=t,this.data=[],this.idIndex=null,this.binaryIndices={},this.constraints={unique:{},exact:{}},this.uniqueNames=[],this.transforms={},this.objType=t,this.dirty=!0,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null;var n=this;(r=r||{}).hasOwnProperty("unique")&&(Array.isArray(r.unique)||(r.unique=[r.unique]),r.unique.forEach((function(e){n.uniqueNames.push(e)}))),r.hasOwnProperty("exact")&&r.exact.forEach((function(e){n.constraints.exact[e]=new R(e)})),this.adaptiveBinaryIndices=!r.hasOwnProperty("adaptiveBinaryIndices")||r.adaptiveBinaryIndices,this.transactional=!!r.hasOwnProperty("transactional")&&r.transactional,this.cloneObjects=!!r.hasOwnProperty("clone")&&r.clone,this.cloneMethod=r.hasOwnProperty("cloneMethod")?r.cloneMethod:"parse-stringify",this.asyncListeners=!!r.hasOwnProperty("asyncListeners")&&r.asyncListeners,this.disableMeta=!!r.hasOwnProperty("disableMeta")&&r.disableMeta,this.disableChangesApi=!r.hasOwnProperty("disableChangesApi")||r.disableChangesApi,this.disableDeltaChangesApi=!r.hasOwnProperty("disableDeltaChangesApi")||r.disableDeltaChangesApi,this.disableChangesApi&&(this.disableDeltaChangesApi=!0),this.autoupdate=!!r.hasOwnProperty("autoupdate")&&r.autoupdate,this.serializableIndices=!r.hasOwnProperty("serializableIndices")||r.serializableIndices,this.disableFreeze=!r.hasOwnProperty("disableFreeze")||r.disableFreeze,this.ttl={age:null,ttlInterval:null,daemon:null},this.setTTL(r.ttl||-1,r.ttlInterval),this.maxId=0,this.DynamicViews=[],this.events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this.changes=[],this.dirtyIds=[];var i=[];if(r&&r.indices)if("[object Array]"===Object.prototype.toString.call(r.indices))i=r.indices;else{if("string"!=typeof r.indices)throw new TypeError("Indices needs to be a string or an array of strings");i=[r.indices]}for(var o=0;o<i.length;o++)this.ensureIndex(i[o]);function s(t){var r="function"==typeof Set?new Set:[];r.add||(r.add=function(e){return-1===this.indexOf(e)&&this.push(e),this}),t.forEach((function(e){r.add(e.object)})),r.forEach((function(t){if(!e.call(t,"$loki"))return n.removeAutoUpdateObserver(t);try{n.update(t)}catch(e){}}))}function a(e,t){return t?u(t,e):JSON.parse(JSON.stringify(e))}function u(e,t){var r=null!==t&&"object"==typeof t?Object.keys(t):null;if(r&&r.length&&["string","boolean","number"].indexOf(typeof t)<0){for(var i={},o=0;o<r.length;o++){var s=r[o];if(t.hasOwnProperty(s))if(!e.hasOwnProperty(s)||n.uniqueNames.indexOf(s)>=0||"$loki"==s||"meta"==s)i[s]=t[s];else{var a=u(e[s],t[s]);void 0!==a&&a!={}&&(i[s]=a)}}return 0===Object.keys(i).length?void 0:i}return e===t?void 0:t}function c(){n.changes=[]}this.observerCallback=s,this.getChangeDelta=a,this.getObjectDelta=u,this.getChanges=function(){return n.changes},this.flushChanges=c,this.setChangesApi=function(e){n.disableChangesApi=!e,e||(n.disableDeltaChangesApi=!1)},this.on("delete",(function(e){n.disableChangesApi||n.createChange(n.name,"R",e)})),this.on("warning",(function(e){n.lokiConsoleWrapper.warn(e)})),c()}function E(e){return-1!==e.indexOf(".")}function C(e){return parseFloat(e,10)}function D(e,t){return e+t}function M(e,t){return e-t}function L(e){return e.reduce(D,0)/e.length}function N(e){var t=L(e),r=L(e.map((function(e){var r=e-t;return r*r})));return Math.sqrt(r)}function T(e,t,r){if(!1===r)return e[t];for(var n=t.split("."),i=e;n.length>0;)i=i[n.shift()];return i}function B(e,t,r){for(var n,i,o=0,s=e.length;o<s;){if(i=o+s>>1,0===(n=r.apply(null,[t,e[i]])))return{found:!0,index:i};n<0?s=i:o=i+1}return{found:!1,index:s}}function $(e){return function(t,r){return B(t,r,e)}}function F(){}function z(e){this.field=e,this.keyMap=Object.create(null),this.lokiMap=Object.create(null)}function R(e){this.index=Object.create(null),this.field=e}function q(e){this.field=e}return w.prototype.events={},w.prototype.asyncListeners=!1,w.prototype.on=function(e,t){var r,n=this;return Array.isArray(e)?(e.forEach((function(e){n.on(e,t)})),t):((r=this.events[e])||(r=this.events[e]=[]),r.push(t),t)},w.prototype.emit=function(e){var t,r=this;if(!e||!this.events[e])throw new Error("No event "+e+" defined");this.events[e].length&&(t=Array.prototype.slice.call(arguments,1),this.events[e].forEach((function(e){r.asyncListeners?setTimeout((function(){e.apply(r,t)}),1):e.apply(r,t)})))},w.prototype.addListener=w.prototype.on,w.prototype.removeListener=function(e,t){var r=this;if(Array.isArray(e))e.forEach((function(e){r.removeListener(e,t)}));else if(this.events[e]){var n=this.events[e];n.splice(n.indexOf(t),1)}},S.prototype=new w,S.prototype.constructor=S,S.prototype.getIndexedAdapter=function(){return r(7996)},S.prototype.configureOptions=function(e,t){var r={NODEJS:"fs",BROWSER:"localStorage",CORDOVA:"localStorage",MEMORY:"memory"},n={fs:O,localStorage:A,memory:I};if(this.options={},this.persistenceMethod=null,this.persistenceAdapter=null,void 0!==e){if(this.options=e,this.options.hasOwnProperty("persistenceMethod")&&"function"==typeof n[e.persistenceMethod]&&(this.persistenceMethod=e.persistenceMethod,this.persistenceAdapter=new n[e.persistenceMethod]),this.options.hasOwnProperty("adapter")&&(this.persistenceMethod="adapter",this.persistenceAdapter=e.adapter,this.options.adapter=null,this.isIncremental="incremental"===this.persistenceAdapter.mode),e.autoload&&t){var i=this;setTimeout((function(){i.loadDatabase(e,e.autoloadCallback)}),1)}this.options.hasOwnProperty("autosaveInterval")&&(this.autosaveDisable(),this.autosaveInterval=parseInt(this.options.autosaveInterval,10)),this.options.hasOwnProperty("autosave")&&this.options.autosave&&(this.autosaveDisable(),this.autosave=!0,this.options.hasOwnProperty("autosaveCallback")?this.autosaveEnable(e,e.autosaveCallback):this.autosaveEnable()),this.options.hasOwnProperty("throttledSaves")&&(this.throttledSaves=this.options.throttledSaves)}this.options.hasOwnProperty("serializationMethod")||(this.options.serializationMethod="normal"),this.options.hasOwnProperty("destructureDelimiter")||(this.options.destructureDelimiter="$<\n"),null===this.persistenceAdapter&&(this.persistenceMethod=r[this.ENV],this.persistenceMethod&&(this.persistenceAdapter=new n[this.persistenceMethod]))},S.prototype.copy=function(e){var t,r,n=new S(this.filename,{env:"NA"});if(e=e||{},n.loadJSONObject(this,{retainDirtyFlags:!0}),e.hasOwnProperty("removeNonSerializable")&&!0===e.removeNonSerializable)for(n.autosaveHandle=null,n.persistenceAdapter=null,t=n.collections.length,r=0;r<t;r++)n.collections[r].constraints=null,n.collections[r].ttl=null;return n},S.prototype.addCollection=function(e,t){var r,n=this.collections.length;if(t&&!0===t.disableMeta){if(!1===t.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===t.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof t.ttl&&t.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}for(r=0;r<n;r+=1)if(this.collections[r].name===e)return this.collections[r];var i=new _(e,t);return i.isIncremental=this.isIncremental,this.collections.push(i),this.verbose&&(i.lokiConsoleWrapper=console),i},S.prototype.loadCollection=function(e){if(!e.name)throw new Error("Collection must have a name property to be loaded");this.collections.push(e)},S.prototype.getCollection=function(e){var t,r=this.collections.length;for(t=0;t<r;t+=1)if(this.collections[t].name===e)return this.collections[t];return this.emit("warning","collection "+e+" not found"),null},S.prototype.renameCollection=function(e,t){var r=this.getCollection(e);return r&&(r.name=t),r},S.prototype.listCollections=function(){for(var e=this.collections.length,t=[];e--;)t.push({name:this.collections[e].name,type:this.collections[e].objType,count:this.collections[e].data.length});return t},S.prototype.removeCollection=function(e){var t,r=this.collections.length;for(t=0;t<r;t+=1)if(this.collections[t].name===e){var n=new _(e,{}),i=this.collections[t];for(var o in i)i.hasOwnProperty(o)&&n.hasOwnProperty(o)&&(i[o]=n[o]);return void this.collections.splice(t,1)}},S.prototype.getName=function(){return this.name},S.prototype.serializeReplacer=function(e,t){switch(e){case"autosaveHandle":case"persistenceAdapter":case"constraints":case"ttl":case"lokiConsoleWrapper":return null;case"throttledSavePending":case"throttledCallbacks":return;default:return t}},S.prototype.serialize=function(e){switch((e=e||{}).hasOwnProperty("serializationMethod")||(e.serializationMethod=this.options.serializationMethod),e.serializationMethod){default:return JSON.stringify(this,this.serializeReplacer);case"pretty":return JSON.stringify(this,this.serializeReplacer,2);case"destructured":return this.serializeDestructured()}},S.prototype.toJson=S.prototype.serialize,S.prototype.serializeDestructured=function(e){var t,r,n,i,o,s=[];if((e=e||{}).hasOwnProperty("partitioned")||(e.partitioned=!1),e.hasOwnProperty("delimited")||(e.delimited=!0),e.hasOwnProperty("delimiter")||(e.delimiter=this.options.destructureDelimiter),!0===e.partitioned&&e.hasOwnProperty("partition")&&e.partition>=0)return this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:e.partition});for((o=new S(this.filename)).loadJSONObject(this),t=0;t<o.collections.length;t++)o.collections[t].data=[];if(!0===e.partitioned&&-1===e.partition)return o.serialize({serializationMethod:"normal"});for(s.push(o.serialize({serializationMethod:"normal"})),o=null,t=0;t<this.collections.length;t++)if(n=this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:t}),!1===e.partitioned&&!1===e.delimited){if(!Array.isArray(n))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(i=n.length,r=0;r<i;r++)s.push(n[r]),n[r]=null;s.push("")}else s.push(n);return e.partitioned?(e.delimited,s):e.delimited?(s.push(""),s.join(e.delimiter)):(s.push(""),s)},S.prototype.serializeCollection=function(e){var t,r,n=[];if((e=e||{}).hasOwnProperty("delimited")||(e.delimited=!0),!e.hasOwnProperty("collectionIndex"))throw new Error("serializeCollection called without 'collectionIndex' option");for(t=this.collections[e.collectionIndex].data.length,n=[],r=0;r<t;r++)n.push(JSON.stringify(this.collections[e.collectionIndex].data[r]));return e.delimited?(n.push(""),n.join(e.delimiter)):n},S.prototype.deserializeDestructured=function(e,t){var r,n,i,o=[],s=0,a=1,u=!1;if((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),t.partitioned){if(t.hasOwnProperty("partition"))return-1===t.partition?r=JSON.parse(e[0]):this.deserializeCollection(e[t.partition+1],t);for(n=(r=JSON.parse(e[0])).collections.length,s=0;s<n;s++)r.collections[s].data=this.deserializeCollection(e[s+1],t);return r}if(t.delimited){if(o=e.split(t.delimiter),e=null,0===o.length)return null}else o=e;for(n=(r=JSON.parse(o[0])).collections.length,o[0]=null;!u;)o[a],""===o[a]?++s>n&&(u=!0):(i=JSON.parse(o[a]),r.collections[s].data.push(i)),o[a++]=null;return r},S.prototype.deserializeCollection=function(e,t){var r,n,i=[];for((t=t||{}).hasOwnProperty("partitioned")||(t.partitioned=!1),t.hasOwnProperty("delimited")||(t.delimited=!0),t.hasOwnProperty("delimiter")||(t.delimiter=this.options.destructureDelimiter),t.delimited?(i=e.split(t.delimiter)).pop():i=e,n=i.length,r=0;r<n;r++)i[r]=JSON.parse(i[r]);return i},S.prototype.loadJSON=function(e,t){var r;r=0===e.length?{}:"destructured"===this.options.serializationMethod?this.deserializeDestructured(e):JSON.parse(e),this.loadJSONObject(r,t)},S.prototype.loadJSONObject=function(e,r){var n,i,s,a,u,c,l=0,f=e.collections?e.collections.length:0;function h(e){var t,n=r[e.name];return n.proto?(t=n.inflate||o.copyProperties,function(e){var r=new n.proto;return t(e,r),r}):n.inflate}for(this.name=e.name,e.hasOwnProperty("throttledSaves")&&r&&!r.hasOwnProperty("throttledSaves")&&(this.throttledSaves=e.throttledSaves),this.collections=[];l<f;l+=1){if(n=e.collections[l],(i=this.addCollection(n.name,{disableChangesApi:n.disableChangesApi,disableDeltaChangesApi:n.disableDeltaChangesApi,disableMeta:n.disableMeta,disableFreeze:!n.hasOwnProperty("disableFreeze")||n.disableFreeze})).adaptiveBinaryIndices=!!n.hasOwnProperty("adaptiveBinaryIndices")&&!0===n.adaptiveBinaryIndices,i.transactional=n.transactional,i.asyncListeners=n.asyncListeners,i.cloneObjects=n.cloneObjects,i.cloneMethod=n.cloneMethod||"parse-stringify",i.autoupdate=n.autoupdate,i.changes=n.changes,i.dirtyIds=n.dirtyIds||[],r&&!0===r.retainDirtyFlags?i.dirty=n.dirty:i.dirty=!1,s=n.data.length,a=0,r&&r.hasOwnProperty(n.name))for(u=h(n);a<s;a++)c=u(n.data[a]),i.data[a]=c,i.addAutoUpdateObserver(c),i.disableFreeze||t(i.data[a]);else for(;a<s;a++)i.data[a]=n.data[a],i.addAutoUpdateObserver(i.data[a]),i.disableFreeze||t(i.data[a]);if(i.maxId=void 0===n.maxId?0:n.maxId,void 0!==n.binaryIndices&&(i.binaryIndices=n.binaryIndices),void 0!==n.transforms&&(i.transforms=n.transforms),i.uniqueNames=[],n.hasOwnProperty("uniqueNames")&&(i.uniqueNames=n.uniqueNames),void 0!==n.DynamicViews){for(var p=0;p<n.DynamicViews.length;p++){var d=n.DynamicViews[p],y=i.addDynamicView(d.name,d.options);y.resultdata=d.resultdata,y.resultsdirty=d.resultsdirty,y.filterPipeline=d.filterPipeline,y.sortCriteriaSimple=d.sortCriteriaSimple,y.sortCriteria=d.sortCriteria,y.sortFunction=null,y.sortDirty=d.sortDirty,i.disableFreeze||(t(y.filterPipeline),y.sortCriteriaSimple?t(y.sortCriteriaSimple):y.sortCriteria&&t(y.sortCriteria)),y.resultset.filteredrows=d.resultset.filteredrows,y.resultset.filterInitialized=d.resultset.filterInitialized,y.rematerialize({removeWhereFilters:!0})}e.databaseVersion<1.5&&(i.ensureAllIndexes(!0),i.dirty=!0)}}},S.prototype.close=function(e){this.autosave&&(this.autosaveDisable(),this.autosaveDirty()&&(this.saveDatabase(e),e=void 0)),e&&this.on("close",e),this.emit("close")},S.prototype.generateChangesNotification=function(e){function t(e){return e.name}var r=[],n=e||this.collections.map(t);return this.collections.forEach((function(e){-1!==n.indexOf(t(e))&&(r=r.concat(e.getChanges()))})),r},S.prototype.serializeChanges=function(e){return JSON.stringify(this.generateChangesNotification(e))},S.prototype.clearChanges=function(){this.collections.forEach((function(e){e.flushChanges&&e.flushChanges()}))},I.prototype.loadDatabase=function(e,t){var r=this;this.options.asyncResponses?setTimeout((function(){r.hashStore.hasOwnProperty(e)?t(r.hashStore[e].value):t(null)}),this.options.asyncTimeout):this.hashStore.hasOwnProperty(e)?t(this.hashStore[e].value):t(null)},I.prototype.saveDatabase=function(e,t,r){var n,i=this;this.options.asyncResponses?setTimeout((function(){n=i.hashStore.hasOwnProperty(e)?i.hashStore[e].savecount:0,i.hashStore[e]={savecount:n+1,lastsave:new Date,value:t},r()}),this.options.asyncTimeout):(n=this.hashStore.hasOwnProperty(e)?this.hashStore[e].savecount:0,this.hashStore[e]={savecount:n+1,lastsave:new Date,value:t},r())},I.prototype.deleteDatabase=function(e,t){this.hashStore.hasOwnProperty(e)&&delete this.hashStore[e],"function"==typeof t&&t()},P.prototype.loadDatabase=function(e,t){var r=this;this.dbname=e,this.dbref=new S(e),this.adapter.loadDatabase(e,(function(e){if(e){"string"!=typeof e&&t(new Error("LokiPartitioningAdapter received an unexpected response from inner adapter loadDatabase()"));var n=JSON.parse(e);r.dbref.loadJSONObject(n),n=null,r.dbref.collections.length,0!==r.dbref.collections.length?(r.pageIterator={collection:0,pageIndex:0},r.loadNextPartition(0,(function(){t(r.dbref)}))):t(r.dbref)}else t(e)}))},P.prototype.loadNextPartition=function(e,t){var r=this.dbname+"."+e,n=this;if(!0===this.options.paging)return this.pageIterator.pageIndex=0,void this.loadNextPage(t);this.adapter.loadDatabase(r,(function(r){var i=n.dbref.deserializeCollection(r,{delimited:!0,collectionIndex:e});n.dbref.collections[e].data=i,++e<n.dbref.collections.length?n.loadNextPartition(e,t):t()}))},P.prototype.loadNextPage=function(e){var t=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,r=this;this.adapter.loadDatabase(t,(function(t){var n=t.split(r.options.delimiter);t="";var i,o=n.length,s=""===n[o-1];for(s&&(n.pop(),""===n[(o=n.length)-1]&&1===o&&(n.pop(),o=n.length)),i=0;i<o;i++)r.dbref.collections[r.pageIterator.collection].data.push(JSON.parse(n[i])),n[i]=null;n=[],s?++r.pageIterator.collection<r.dbref.collections.length?r.loadNextPartition(r.pageIterator.collection,e):e():(r.pageIterator.pageIndex++,r.loadNextPage(e))}))},P.prototype.exportDatabase=function(e,t,r){var n,i=t.collections.length;for(this.dbref=t,this.dbname=e,this.dirtyPartitions=[-1],n=0;n<i;n++)t.collections[n].dirty&&this.dirtyPartitions.push(n);this.saveNextPartition((function(e){r(e)}))},P.prototype.saveNextPartition=function(e){var t=this,r=this.dirtyPartitions.shift(),n=this.dbname+(-1===r?"":"."+r);if(this.options.paging&&-1!==r)return this.pageIterator={collection:r,docIndex:0,pageIndex:0},void this.saveNextPage((function(r){0===t.dirtyPartitions.length?e(r):t.saveNextPartition(e)}));var i=this.dbref.serializeDestructured({partitioned:!0,delimited:!0,partition:r});this.adapter.saveDatabase(n,i,(function(r){r?e(r):0===t.dirtyPartitions.length?e(null):t.saveNextPartition(e)}))},P.prototype.saveNextPage=function(e){var t=this,r=this.dbref.collections[this.pageIterator.collection],n=this.dbname+"."+this.pageIterator.collection+"."+this.pageIterator.pageIndex,i=0,o=r.data.length,s=this.options.delimiter.length,a="",u="",c=!1,l=!1,f=function(r){u="",r&&e(r),c?e(null):(t.pageIterator.pageIndex++,t.saveNextPage(e))};for(0===r.data.length&&(c=!0);;)if(c||(a=JSON.stringify(r.data[this.pageIterator.docIndex]),u+=a,i+=a.length,++this.pageIterator.docIndex>=o&&(c=!0)),i>=this.options.pageSize&&(l=!0),l&&!c||(u+=this.options.delimiter,i+=s),c||l)return void this.adapter.saveDatabase(n,u,f)},O.prototype.loadDatabase=function(e,t){var r=this;this.fs.stat(e,(function(n,i){!n&&i.isFile()?r.fs.readFile(e,{encoding:"utf8"},(function(e,r){t(e?new Error(e):r)})):t(null)}))},O.prototype.saveDatabase=function(e,t,r){var n=this,i=e+"~";this.fs.writeFile(i,t,(function(t){t?r(new Error(t)):n.fs.rename(i,e,r)}))},O.prototype.deleteDatabase=function(e,t){this.fs.unlink(e,(function(e){e?t(new Error(e)):t()}))},A.prototype.loadDatabase=function(e,t){b()?t(localStorage.getItem(e)):t(new Error("localStorage is not available"))},A.prototype.saveDatabase=function(e,t,r){b()?(localStorage.setItem(e,t),r(null)):r(new Error("localStorage is not available"))},A.prototype.deleteDatabase=function(e,t){b()?(localStorage.removeItem(e),t(null)):t(new Error("localStorage is not available"))},S.prototype.throttledSaveDrain=function(e,t){var r=this,n=(new Date).getTime();if(this.throttledSaves||e(!0),(t=t||{}).hasOwnProperty("recursiveWait")||(t.recursiveWait=!0),t.hasOwnProperty("recursiveWaitLimit")||(t.recursiveWaitLimit=!1),t.hasOwnProperty("recursiveWaitLimitDuration")||(t.recursiveWaitLimitDuration=2e3),t.hasOwnProperty("started")||(t.started=(new Date).getTime()),this.throttledSaves&&this.throttledSavePending){if(!t.recursiveWait)return void this.throttledCallbacks.push(e);this.throttledCallbacks.push((function(){return r.throttledSavePending?t.recursiveWaitLimit&&n-t.started>t.recursiveWaitLimitDuration?void e(!1):void r.throttledSaveDrain(e,t):void e(!0)}))}else e(!0)},S.prototype.loadDatabaseInternal=function(e,t){var r=t||function(e,t){if(e)throw e},n=this;null!==this.persistenceAdapter?this.persistenceAdapter.loadDatabase(this.filename,(function(t){if("string"==typeof t){var i=!1;try{n.loadJSON(t,e||{}),i=!0}catch(e){r(e)}i&&(r(null),n.emit("loaded","database "+n.filename+" loaded"))}else{if(!t)return r(null),void n.emit("loaded","empty database "+n.filename+" loaded");if(t instanceof Error)return void r(t);if("object"==typeof t)return n.loadJSONObject(t,e||{}),r(null),void n.emit("loaded","database "+n.filename+" loaded");r("unexpected adapter response : "+t)}})):r(new Error("persistenceAdapter not configured"))},S.prototype.loadDatabase=function(e,t){var r=this;this.throttledSaves?this.throttledSaveDrain((function(n){if(n)return r.throttledSavePending=!0,void r.loadDatabaseInternal(e,(function(e){0===r.throttledCallbacks.length?r.throttledSavePending=!1:r.saveDatabase(),"function"==typeof t&&t(e)}));"function"==typeof t&&t(new Error("Unable to pause save throttling long enough to read database"))}),e):this.loadDatabaseInternal(e,t)},S.prototype.saveDatabaseInternal=function(e){var t,r=e||function(e){if(e)throw e},n=this;this.persistenceAdapter?"incremental"===this.persistenceAdapter.mode?(this.ignoreAutosave=!0,this.persistenceAdapter.saveDatabase(this.filename,(function(){if(n.ignoreAutosave=!1,!t){var e=n.copy({removeNonSerializable:!0});return t=n.collections.map((function(e){return[e.dirty,e.dirtyIds]})),n.collections.forEach((function(e){e.dirty=!1,e.dirtyIds=[]})),e}r(new Error("adapter error - getLokiCopy called more than once"))}),(function(e){n.ignoreAutosave=!1,e&&t&&n.collections.forEach((function(e,r){var n=t[r];e.dirty=e.dirty||n[0],e.dirtyIds=e.dirtyIds.concat(n[1])})),r(e)}))):"reference"===this.persistenceAdapter.mode&&"function"==typeof this.persistenceAdapter.exportDatabase?this.persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}),(function(e){n.autosaveClearFlags(),r(e)})):(this.autosaveClearFlags(),this.persistenceAdapter.saveDatabase(this.filename,this.serialize(),(function(e){r(e)}))):r(new Error("persistenceAdapter not configured"))},S.prototype.saveDatabase=function(e){if(this.throttledSaves)if(this.throttledSavePending)this.throttledCallbacks.push(e);else{var t=this.throttledCallbacks;this.throttledCallbacks=[],t.unshift(e),this.throttledSavePending=!0;var r=this;this.saveDatabaseInternal((function(e){r.throttledSavePending=!1,t.forEach((function(t){"function"==typeof t&&setTimeout((function(){t(e)}),1)})),r.throttledCallbacks.length>0&&r.saveDatabase()}))}else this.saveDatabaseInternal(e)},S.prototype.save=S.prototype.saveDatabase,S.prototype.deleteDatabase=function(e,t){var r=t||function(e,t){if(e)throw e};"function"!=typeof e||t||(r=e),null!==this.persistenceAdapter?this.persistenceAdapter.deleteDatabase(this.filename,(function(e){r(e)})):r(new Error("persistenceAdapter not configured"))},S.prototype.autosaveDirty=function(){for(var e=0;e<this.collections.length;e++)if(this.collections[e].dirty)return!0;return!1},S.prototype.autosaveClearFlags=function(){for(var e=0;e<this.collections.length;e++)this.collections[e].dirty=!1},S.prototype.autosaveEnable=function(e,t){this.autosave=!0;var r=5e3,n=this;void 0!==this.autosaveInterval&&null!==this.autosaveInterval&&(r=this.autosaveInterval),this.autosaveHandle=setInterval((function(){n.autosaveDirty()&&!n.ignoreAutosave&&n.saveDatabase(t)}),r)},S.prototype.autosaveDisable=function(){void 0!==this.autosaveHandle&&null!==this.autosaveHandle&&(clearInterval(this.autosaveHandle),this.autosaveHandle=null)},x.prototype.reset=function(){return this.filteredrows.length>0&&(this.filteredrows=[]),this.filterInitialized=!1,this},x.prototype.toJSON=function(){var e=this.copy();return e.collection=null,e},x.prototype.limit=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t=new x(this.collection);return t.filteredrows=this.filteredrows.slice(0,e),t.filterInitialized=!0,t},x.prototype.offset=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t=new x(this.collection);return t.filteredrows=this.filteredrows.slice(e),t.filterInitialized=!0,t},x.prototype.copy=function(){var e=new x(this.collection);return this.filteredrows.length>0&&(e.filteredrows=this.filteredrows.slice()),e.filterInitialized=this.filterInitialized,e},x.prototype.branch=x.prototype.copy,x.prototype.transform=function(e,t){var r,n,i=this;if("string"==typeof e&&this.collection.transforms.hasOwnProperty(e)&&(e=this.collection.transforms[e]),"object"!=typeof e||!Array.isArray(e))throw new Error("Invalid transform");for(void 0!==t&&(e=o.resolveTransformParams(e,t)),r=0;r<e.length;r++)switch((n=e[r]).type){case"find":i.find(n.value);break;case"where":i.where(n.value);break;case"simplesort":i.simplesort(n.property,n.desc||n.options);break;case"compoundsort":i.compoundsort(n.value);break;case"sort":i.sort(n.value);break;case"limit":i=i.limit(n.value);break;case"offset":i=i.offset(n.value);break;case"map":i=i.map(n.value,n.dataOptions);break;case"eqJoin":i=i.eqJoin(n.joinData,n.leftJoinKey,n.rightJoinKey,n.mapFun,n.dataOptions);break;case"mapReduce":i=i.mapReduce(n.mapFunction,n.reduceFunction);break;case"update":i.update(n.value);break;case"remove":i.remove()}return i},x.prototype.sort=function(e){this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var t,r,n=(t=e,r=this.collection.data,function(e,n){return t(r[e],r[n])});return this.filteredrows.sort(n),this},x.prototype.simplesort=function(e,t){var r,n=10,i=this.collection.data.length,s=this.filteredrows.length,a=this.collection.binaryIndices.hasOwnProperty(e);if(void 0!==t&&!1!==t||(t={desc:!1}),!0===t&&(t={desc:!0}),0===s){if(this.filterInitialized)return this;if(this.collection.binaryIndices.hasOwnProperty(e))return this.collection.ensureIndex(e),this.filteredrows=this.collection.binaryIndices[e].values.slice(0),t.desc&&this.filteredrows.reverse(),this;this.filteredrows=this.collection.prepareFullDocIndex()}else if(!t.disableIndexIntersect&&a&&(r=i/s,t.useJavascriptSorting&&(n=6),r<=n||t.forceIndexIntersect)){var u,c=this.filteredrows,f={};for(u=0;u<s;u++)f[c[u]]=!0;var h=this.collection.binaryIndices[e].values;return this.filteredrows=h.filter((function(e){return f[e]})),t.desc&&this.filteredrows.reverse(),this}if(t.useJavascriptSorting)return this.sort((function(t,r){return t[e]===r[e]?0:t[e]>r[e]?1:t[e]<r[e]?-1:void 0}));var p,d,y,v,g,m,b=(p=e,d=t.desc,y=this.collection.data,function(e,t){return~p.indexOf(".")?(m=p.split("."),v=o.getIn(y[e],m,!0),g=o.getIn(y[t],m,!0)):(v=y[e][p],g=y[t][p]),l(v,g,d)});return this.filteredrows.sort(b),this},x.prototype.compoundsort=function(e){if(0===e.length)throw new Error("Invalid call to compoundsort, need at least one property");var t;if(1===e.length)return t=e[0],Array.isArray(t)?this.simplesort(t[0],t[1]):this.simplesort(t,!1);for(var r=0,n=e.length;r<n;r+=1)t=e[r],Array.isArray(t)||(e[r]=[t,!1]);this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());var i,o,s=(i=e,o=this.collection.data,function(e,t){return f(i,o[e],o[t])});return this.filteredrows.sort(s),this},x.prototype.findOr=function(e){for(var t=null,r=0,n=0,i=[],o=[],s=0,a=(this.count(),0),u=e.length;a<u;a++)for(n=(t=this.branch().find(e[a]).filteredrows).length,r=0;r<n;r++)void 0===o[s=t[r]]&&(o[s]=!0,i.push(s));return this.filteredrows=i,this.filterInitialized=!0,this},x.prototype.$or=x.prototype.findOr,x.prototype.findAnd=function(e){for(var t=0,r=e.length;t<r;t++){if(0===this.count())return this;this.find(e[t])}return this},x.prototype.$and=x.prototype.findAnd,x.prototype.find=function(t,r){if(0===this.collection.data.length)return this.filteredrows=[],this.filterInitialized=!0,this;var n,i,s,a,u,c,l,f=t||"getAll",p=!1,d=[],g=[],m=null;if(r=r||!1,"object"==typeof f){for(n in f)(a={})[n]=f[n],g.push(a),e.call(f,n)&&(i=n,s=f[n]);if(g.length>1)return this.find({$and:g},r)}if(!i||"getAll"===f)return r&&(this.filterInitialized?this.filteredrows=this.filteredrows.slice(0,1):(this.filteredrows=this.collection.data.length>0?[0]:[],this.filterInitialized=!0)),this;if("$and"===i||"$or"===i)return this[i](s),r&&this.filteredrows.length>1&&(this.filteredrows=this.filteredrows.slice(0,1)),this;if(null===s||"object"!=typeof s||s instanceof Date)u="$eq",c=s;else{if("object"!=typeof s)throw new Error("Do not know what you want to do.");for(l in s)if(e.call(s,l)){u=l,c=s[l];break}}"$regex"!==u&&"object"!=typeof c||(c=k(u,c));var b=-1!==i.indexOf(".");!this.filterInitialized&&this.collection.binaryIndices[i]&&v[u]&&(!0!==this.collection.adaptiveBinaryIndices&&this.collection.ensureIndex(i),p=!0,m=this.collection.binaryIndices[i]),!p&&"$in"===u&&Array.isArray(c)&&"undefined"!=typeof Set&&(c=new Set(c),u="$inSet");var w,S,I=y[u],P=this.collection.data,O=0,A=0,x=0;if(this.filterInitialized){if(A=(w=this.filteredrows).length,b){for(i=i.split("."),O=0;O<A;O++)if(h(S=P[x=w[O]],i,I,c,S)&&(d.push(x),r))return this.filteredrows=d,this}else for(O=0;O<A;O++)if(I((S=P[x=w[O]])[i],c,S)&&(d.push(x),r))return this.filteredrows=d,this}else if(p){var j=this.collection.calculateRange(u,i,c);if("$in"!==u){for(O=j[0];O<=j[1];O++)if(!0!==v[u]){if(v[u](o.getIn(P[m.values[O]],i,b),c)&&(d.push(m.values[O]),r))return this.filteredrows=d,this.filterInitialized=!0,this}else if(d.push(m.values[O]),r)return this.filteredrows=d,this.filterInitialized=!0,this}else for(O=0,A=j.length;O<A;O++)if(d.push(m.values[j[O]]),r)return this.filteredrows=d,this.filterInitialized=!0,this}else if(A=P.length,b){for(i=i.split("."),O=0;O<A;O++)if(h(S=P[O],i,I,c,S)&&(d.push(O),r))return this.filteredrows=d,this.filterInitialized=!0,this}else for(O=0;O<A;O++)if(I((S=P[O])[i],c,S)&&(d.push(O),r))return this.filteredrows=d,this.filterInitialized=!0,this;return this.filteredrows=d,this.filterInitialized=!0,this},x.prototype.where=function(e){var t,r=[];if("function"!=typeof e)throw new TypeError("Argument is not a stored view or a function");t=e;try{if(this.filterInitialized){for(var n=this.filteredrows.length;n--;)!0===t(this.collection.data[this.filteredrows[n]])&&r.push(this.filteredrows[n]);return this.filteredrows=r,this}for(var i=this.collection.data.length;i--;)!0===t(this.collection.data[i])&&r.push(i);return this.filteredrows=r,this.filterInitialized=!0,this}catch(e){throw e}},x.prototype.count=function(){return this.filterInitialized?this.filteredrows.length:this.collection.count()},x.prototype.data=function(e){var t,r,n,i,o=[],s=this.collection.data;if((e=e||{}).removeMeta&&!e.forceClones&&(e.forceClones=!0,e.forceCloneMethod=e.forceCloneMethod||"shallow"),!this.collection.disableDeltaChangesApi&&this.collection.disableFreeze&&(e.forceClones=!0,e.forceCloneMethod="parse-stringify"),!this.filterInitialized){if(0===this.filteredrows.length){if(this.collection.cloneObjects||e.forceClones){for(r=s.length,i=e.forceCloneMethod||this.collection.cloneMethod,n=0;n<r;n++)t=g(s[n],i),e.removeMeta&&(delete t.$loki,delete t.meta),o.push(t);return o}return s.slice()}this.filterInitialized=!0}var a=this.filteredrows;if(r=a.length,this.collection.cloneObjects||e.forceClones)for(i=e.forceCloneMethod||this.collection.cloneMethod,n=0;n<r;n++)t=g(s[a[n]],i),e.removeMeta&&(delete t.$loki,delete t.meta),o.push(t);else for(n=0;n<r;n++)o.push(s[a[n]]);return o},x.prototype.update=function(e){if("function"!=typeof e)throw new TypeError("Argument is not a function");this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex());for(var t,r=this.filteredrows.length,n=this.collection.data,i=0;i<r;i++)this.disableFreeze&&!this.collection.cloneObjects&&this.collection.disableDeltaChangesApi?(e(n[this.filteredrows[i]]),this.collection.update(n[this.filteredrows[i]])):(e(t=g(n[this.filteredrows[i]],this.collection.cloneMethod)),this.collection.update(t));return this},x.prototype.remove=function(){return this.filterInitialized||0!==this.filteredrows.length||(this.filteredrows=this.collection.prepareFullDocIndex()),this.collection.removeBatchByPositions(this.filteredrows),this.filteredrows=[],this},x.prototype.mapReduce=function(e,t){try{return t(this.data().map(e))}catch(e){throw e}},x.prototype.eqJoin=function(e,t,r,n,i){var o,s,a,u=[],c=[],l=[],f="function"==typeof t,h="function"==typeof r,p={};if(o=(u=this.data(i)).length,e instanceof _)c=e.chain().data(i);else if(e instanceof x)c=e.data(i);else{if(!Array.isArray(e))throw new TypeError("joinData needs to be an array or result set");c=e}s=c.length;for(var d=0;d<s;d++)p[a=h?r(c[d]):c[d][r]]=c[d];n||(n=function(e,t){return{left:e,right:t}});for(var y=0;y<o;y++)a=f?t(u[y]):u[y][t],l.push(n(u[y],p[a]||{}));return this.collection=new _("joinData"),this.collection.insert(l),this.filteredrows=[],this.filterInitialized=!1,this},x.prototype.map=function(e,t){var r=this.data(t).map(e);return this.collection=new _("mappedData"),this.collection.insert(r),this.filteredrows=[],this.filterInitialized=!1,this},j.prototype=new w,j.prototype.constructor=j,j.prototype.getSort=function(){return this.sortFunction||this.sortCriteria||this.sortCriteriaSimple},j.prototype.rematerialize=function(e){var t,r,n;e=e||{},this.resultdata=[],this.resultsdirty=!0,this.resultset=new x(this.collection),(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple)&&(this.sortDirty=!0);var i=Object.isFrozen(this.filterPipeline);if(e.hasOwnProperty("removeWhereFilters"))for(i&&(this.filterPipeline=this.filterPipeline.slice()),r=t=this.filterPipeline.length;r--;)"where"===this.filterPipeline[r].type&&(r!==this.filterPipeline.length-1&&(this.filterPipeline[r]=this.filterPipeline[this.filterPipeline.length-1]),this.filterPipeline.length--);var o=this.filterPipeline;for(this.filterPipeline=[],t=o.length,n=0;n<t;n++)this.applyFind(o[n].val,o[n].uid);return i&&Object.freeze(this.filterPipeline),this.data(),this.emit("rebuild",this),this},j.prototype.branchResultset=function(e,t){var r=this.resultset.branch();return void 0===e?r:r.transform(e,t)},j.prototype.toJSON=function(){var e=new j(this.collection,this.name,this.options);return e.resultset=this.resultset,e.resultdata=[],e.resultsdirty=!0,e.filterPipeline=this.filterPipeline,e.sortFunction=this.sortFunction,e.sortCriteria=this.sortCriteria,e.sortCriteriaSimple=this.sortCriteriaSimple||null,e.sortDirty=this.sortDirty,e.collection=null,e},j.prototype.removeFilters=function(e){e=e||{},this.rebuildPending=!1,this.resultset.reset(),this.resultdata=[],this.resultsdirty=!0,this.cachedresultset=null;var t=Object.isFrozen(this.filterPipeline),r=this.filterPipeline.length>0;this.filterPipeline=[],t&&Object.freeze(this.filterPipeline),this.sortFunction=null,this.sortCriteria=null,this.sortCriteriaSimple=null,this.sortDirty=!1,!0===e.queueSortPhase&&this.queueSortPhase(),r&&this.emit("filter")},j.prototype.applySort=function(e){return this.sortFunction=e,this.sortCriteria=null,this.sortCriteriaSimple=null,this.queueSortPhase(),this.emit("sort"),this},j.prototype.applySimpleSort=function(e,r){return this.sortCriteriaSimple={propname:e,options:r||!1},this.collection.disableFreeze||t(this.sortCriteriaSimple),this.sortCriteria=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},j.prototype.applySortCriteria=function(e){return this.sortCriteria=e,this.collection.disableFreeze||t(this.sortCriteria),this.sortCriteriaSimple=null,this.sortFunction=null,this.queueSortPhase(),this.emit("sort"),this},j.prototype.startTransaction=function(){return this.cachedresultset=this.resultset.copy(),this},j.prototype.commit=function(){return this.cachedresultset=null,this},j.prototype.rollback=function(){return this.resultset=this.cachedresultset,this.options.persistent&&(this.resultdata=this.resultset.data(),this.emit("rebuild",this)),this},j.prototype._indexOfFilterWithId=function(e){if("string"==typeof e||"number"==typeof e)for(var t=0,r=this.filterPipeline.length;t<r;t+=1)if(e===this.filterPipeline[t].uid)return t;return-1},j.prototype._addFilter=function(e){var r=Object.isFrozen(this.filterPipeline);r&&(this.filterPipeline=this.filterPipeline.slice()),this.collection.disableFreeze||t(e),this.filterPipeline.push(e),r&&Object.freeze(this.filterPipeline),this.resultset[e.type](e.val)},j.prototype.reapplyFilters=function(){this.resultset.reset(),this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0);var e=this.filterPipeline,t=Object.isFrozen(e);this.filterPipeline=[];for(var r=0,n=e.length;r<n;r+=1)this._addFilter(e[r]);return t&&Object.freeze(this.filterPipeline),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},j.prototype.applyFilter=function(e){var t=this._indexOfFilterWithId(e.uid);if(t>=0){var r=Object.isFrozen(this.filterPipeline);return r&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline[t]=e,r&&(n(e),Object.freeze(this.filterPipeline)),this.reapplyFilters()}return this.cachedresultset=null,this.options.persistent&&(this.resultdata=[],this.resultsdirty=!0),this._addFilter(e),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent(),this.emit("filter"),this},j.prototype.applyFind=function(e,t){return this.applyFilter({type:"find",val:e,uid:t}),this},j.prototype.applyWhere=function(e,t){return this.applyFilter({type:"where",val:e,uid:t}),this},j.prototype.removeFilter=function(e){var t=this._indexOfFilterWithId(e);if(t<0)throw new Error("Dynamic view does not contain a filter with ID: "+e);var r=Object.isFrozen(this.filterPipeline);return r&&(this.filterPipeline=this.filterPipeline.slice()),this.filterPipeline.splice(t,1),r&&Object.freeze(this.filterPipeline),this.reapplyFilters(),this},j.prototype.count=function(){return this.resultsdirty&&(this.resultdata=this.resultset.data()),this.resultset.count()},j.prototype.data=function(e){return(this.sortDirty||this.resultsdirty)&&this.performSortPhase({suppressRebuildEvent:!0}),this.options.persistent?this.resultdata:this.resultset.data(e)},j.prototype.queueRebuildEvent=function(){if(!this.rebuildPending){this.rebuildPending=!0;var e=this;setTimeout((function(){e.rebuildPending&&(e.rebuildPending=!1,e.emit("rebuild",e))}),this.options.minRebuildInterval)}},j.prototype.queueSortPhase=function(){if(!this.sortDirty){this.sortDirty=!0;var e=this;"active"===this.options.sortPriority?setTimeout((function(){e.performSortPhase()}),this.options.minRebuildInterval):this.queueRebuildEvent()}},j.prototype.performSortPhase=function(e){(this.sortDirty||this.resultsdirty)&&(e=e||{},this.sortDirty&&(this.sortFunction?this.resultset.sort(this.sortFunction):this.sortCriteria?this.resultset.compoundsort(this.sortCriteria):this.sortCriteriaSimple&&this.resultset.simplesort(this.sortCriteriaSimple.propname,this.sortCriteriaSimple.options),this.sortDirty=!1),this.options.persistent&&(this.resultdata=this.resultset.data(),this.resultsdirty=!1),e.suppressRebuildEvent||this.emit("rebuild",this))},j.prototype.evaluateDocument=function(e,t){if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var r,n=this.resultset.filteredrows,i=t?-1:n.indexOf(+e),o=n.length,s=new x(this.collection);s.filteredrows=[e],s.filterInitialized=!0;for(var a=0,u=this.filterPipeline.length;a<u;a++)s[(r=this.filterPipeline[a]).type](r.val);var c=0===s.filteredrows.length?-1:0;return-1!==i||-1!==c?-1===i&&-1!==c?(n.push(e),this.options.persistent&&this.resultdata.push(this.collection.data[e]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==i&&-1===c?(i<o-1?(n.splice(i,1),this.options.persistent&&this.resultdata.splice(i,1)):(n.length=o-1,this.options.persistent&&(this.resultdata.length=o-1)),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):-1!==i&&-1!==c?(this.options.persistent&&(this.resultdata[i]=this.collection.data[e]),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent())):void 0:void 0},j.prototype.removeDocument=function(e){var t,r,n,i={},o={},s=[],a=this.resultset,u=this.resultset.filteredrows,c=u.length;if(!this.resultset.filterInitialized)return this.options.persistent&&(this.resultdata=this.resultset.data()),void(this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());for(Array.isArray(e)||(e=[e]),n=e.length,r=0;r<n;r++)i[e[r]]=!0;for(t=0;t<c;t++)i[u[t]]&&(o[t]=!0);Object.keys(o).length>0&&(this.resultset.filteredrows=this.resultset.filteredrows.filter((function(e,t){return!o[t]})),this.options.persistent&&(this.resultdata=this.resultdata.filter((function(e,t){return!o[t]}))),this.sortFunction||this.sortCriteria||this.sortCriteriaSimple?this.queueSortPhase():this.queueRebuildEvent());var l=function(e){return function(t){return t<a.filteredrows[e]}};for(c=a.filteredrows.length,t=0;t<c;t++)s=e.filter(l(t)),a.filteredrows[t]-=s.length},j.prototype.mapReduce=function(e,t){try{return t(this.data().map(e))}catch(e){throw e}},_.prototype=new w,_.prototype.contructor=_,_.prototype.createChange=function(e,t,r,n){this.changes.push({name:e,operation:t,obj:"U"!=t||this.disableDeltaChangesApi?JSON.parse(JSON.stringify(r)):this.getChangeDelta(r,n)})},_.prototype.insertMeta=function(e){var t,r;if(!this.disableMeta&&e)if(Array.isArray(e))for(t=e.length,r=0;r<t;r++)e[r].hasOwnProperty("meta")||(e[r].meta={}),e[r].meta.created=(new Date).getTime(),e[r].meta.revision=0;else e.meta||(e.meta={}),e.meta.created=(new Date).getTime(),e.meta.revision=0},_.prototype.updateMeta=function(e){return this.disableMeta||!e||(this.disableFreeze||((e=i(e)).meta=i(e.meta)),e.meta.updated=(new Date).getTime(),e.meta.revision+=1),e},_.prototype.createInsertChange=function(e){this.createChange(this.name,"I",e)},_.prototype.createUpdateChange=function(e,t){this.createChange(this.name,"U",e,t)},_.prototype.insertMetaWithChange=function(e){this.insertMeta(e),this.createInsertChange(e)},_.prototype.updateMetaWithChange=function(e,t,r){return e=this.updateMeta(e,r),this.createUpdateChange(e,t),e},_.prototype.lokiConsoleWrapper={log:function(){},warn:function(){},error:function(){}},_.prototype.addAutoUpdateObserver=function(e){this.autoupdate&&"function"==typeof Object.observe&&Object.observe(e,this.observerCallback,["add","update","delete","reconfigure","setPrototype"])},_.prototype.removeAutoUpdateObserver=function(e){this.autoupdate&&"function"==typeof Object.observe&&Object.unobserve(e,this.observerCallback)},_.prototype.addTransform=function(e,t){if(this.transforms.hasOwnProperty(e))throw new Error("a transform by that name already exists");this.transforms[e]=t},_.prototype.getTransform=function(e){return this.transforms[e]},_.prototype.setTransform=function(e,t){this.transforms[e]=t},_.prototype.removeTransform=function(e){delete this.transforms[e]},_.prototype.byExample=function(e){var t,r,n;for(t in n=[],e)e.hasOwnProperty(t)&&n.push(((r={})[t]=e[t],r));return{$and:n}},_.prototype.findObject=function(e){return this.findOne(this.byExample(e))},_.prototype.findObjects=function(e){return this.find(this.byExample(e))},_.prototype.ttlDaemonFuncGen=function(){var e=this,t=this.ttl.age;return function(){var r=Date.now();e.chain().where((function(e){var n=e.meta.updated||e.meta.created;return t<r-n})).remove()}},_.prototype.setTTL=function(e,t){e<0?clearInterval(this.ttl.daemon):(this.ttl.age=e,this.ttl.ttlInterval=t,this.ttl.daemon=setInterval(this.ttlDaemonFuncGen(),t))},_.prototype.prepareFullDocIndex=function(){for(var e=this.data.length,t=new Array(e),r=0;r<e;r+=1)t[r]=r;return t},_.prototype.configureOptions=function(e){(e=e||{}).hasOwnProperty("adaptiveBinaryIndices")&&(this.adaptiveBinaryIndices=e.adaptiveBinaryIndices,this.adaptiveBinaryIndices&&this.ensureAllIndexes())},_.prototype.ensureIndex=function(e,t){if(void 0===t&&(t=!1),null==e)throw new Error("Attempting to set index without an associated property");if((!this.binaryIndices[e]||t||this.binaryIndices[e].dirty)&&(!0!==this.adaptiveBinaryIndices||!this.binaryIndices.hasOwnProperty(e)||t)){var r={name:e,dirty:!0,values:this.prepareFullDocIndex()};this.binaryIndices[e]=r;var n,i,a,u,c,l=(n=e,i=this.data,c=!!~n.indexOf(".")&&n.split("."),function(e,t){if(c?(a=o.getIn(i[e],c,!0),u=o.getIn(i[t],c,!0)):(a=i[e][n],u=i[t][n]),a!==u){if(s.lt(a,u,!1))return-1;if(s.gt(a,u,!1))return 1}return 0});r.values.sort(l),r.dirty=!1,this.dirty=!0}},_.prototype.checkAllIndexes=function(t){var r,n=this.binaryIndices,i=[];for(r in n)e.call(n,r)&&(this.checkIndex(r,t)||i.push(r));return i},_.prototype.checkIndex=function(e,t){(t=t||{}).randomSamplingFactor&&!1!==t.randomSampling&&(t.randomSampling=!0),t.randomSamplingFactor=t.randomSamplingFactor||.1,(t.randomSamplingFactor<0||t.randomSamplingFactor>1)&&(t.randomSamplingFactor=.1);var r,n,i,s,a,u=!0;if(!this.binaryIndices.hasOwnProperty(e))throw new Error("called checkIndex on property without an index: "+e);if(this.adaptiveBinaryIndices||this.ensureIndex(e),(s=(a=this.binaryIndices[e].values).length)!==this.data.length)return t.repair&&this.ensureIndex(e,!0),!1;if(0===s)return!0;var c=-1!==e.indexOf(".");if(1===s)u=0===a[0];else if(t.randomSampling){if(y.$lte(o.getIn(this.data[a[0]],e,c),o.getIn(this.data[a[1]],e,c))||(u=!1),y.$lte(o.getIn(this.data[a[s-2]],e,c),o.getIn(this.data[a[s-1]],e,c))||(u=!1),u)for(n=Math.floor((s-1)*t.randomSamplingFactor),r=0;r<n-1;r++)if(i=Math.floor(Math.random()*(s-1)),!y.$lte(o.getIn(this.data[a[i]],e,c),o.getIn(this.data[a[i+1]],e,c))){u=!1;break}}else for(r=0;r<s-1;r++)if(!y.$lte(o.getIn(this.data[a[r]],e,c),o.getIn(this.data[a[r+1]],e,c))){u=!1;break}return!u&&t.repair&&this.ensureIndex(e,!0),u},_.prototype.getBinaryIndexValues=function(e){var t,r=this.binaryIndices[e].values,n=[];for(t=0;t<r.length;t++)n.push(o.getIn(this.data[r[t]],e,!0));return n},_.prototype.getUniqueIndex=function(e,t){var r=this.constraints.unique[e];return!r&&t?this.ensureUniqueIndex(e):r},_.prototype.ensureUniqueIndex=function(e){var t=this.constraints.unique[e];return t||-1==this.uniqueNames.indexOf(e)&&this.uniqueNames.push(e),this.constraints.unique[e]=t=new z(e),this.data.forEach((function(e){t.set(e)})),t},_.prototype.ensureAllIndexes=function(t){var r,n=this.binaryIndices;for(r in n)e.call(n,r)&&this.ensureIndex(r,t)},_.prototype.flagBinaryIndexesDirty=function(){var t,r=this.binaryIndices;for(t in r)e.call(r,t)&&(r[t].dirty=!0)},_.prototype.flagBinaryIndexDirty=function(e){this.binaryIndices[e]&&(this.binaryIndices[e].dirty=!0)},_.prototype.count=function(e){return e?this.chain().find(e).filteredrows.length:this.data.length},_.prototype.ensureId=function(){if(!this.idIndex){for(var e=this.data,t=0,r=e.length,n=new Array(r);t<r;t++)n[t]=e[t].$loki;this.idIndex=n}},_.prototype.ensureIdAsync=function(e){this.async((function(){this.ensureId()}),e)},_.prototype.addDynamicView=function(e,t){var r=new j(this,e,t);return this.DynamicViews.push(r),r},_.prototype.removeDynamicView=function(e){this.DynamicViews=this.DynamicViews.filter((function(t){return t.name!==e}))},_.prototype.getDynamicView=function(e){for(var t=0;t<this.DynamicViews.length;t++)if(this.DynamicViews[t].name===e)return this.DynamicViews[t];return null},_.prototype.findAndUpdate=function(e,t){"function"==typeof e?this.updateWhere(e,t):this.chain().find(e).update(t)},_.prototype.findAndRemove=function(e){this.chain().find(e).remove()},_.prototype.insert=function(e,t){if(!Array.isArray(e))return this.insertOne(e);var r,n=[],i=t&&!this.cloneObjects&&this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0;i&&(this.adaptiveBinaryIndices=!1);try{this.emit("pre-insert",e);for(var o=0,s=e.length;o<s;o++){if(!(r=this.insertOne(e[o],!0)))return;n.push(r)}}finally{i&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}return this.emit("insert",n),1===(n=this.cloneObjects?g(n,this.cloneMethod):n).length?n[0]:n},_.prototype.insertOne=function(e,r){var n,o=null;if("object"!=typeof e?o=new TypeError("Document needs to be an object"):null===e&&(o=new TypeError("Object cannot be null")),null!==o)throw this.emit("error",o),o;var s=this.cloneObjects?g(e,this.cloneMethod):e;if(this.disableFreeze||(s=i(s)),this.disableMeta||(void 0===s.meta?s.meta={revision:0,created:0}:this.disableFreeze||(s.meta=i(s.meta))),r||this.emit("pre-insert",s),this.add(s))return this.disableChangesApi?this.insertMeta(s):this.insertMetaWithChange(s),this.disableFreeze||t(s),n=this.cloneObjects?g(s,this.cloneMethod):s,r||this.emit("insert",n),this.addAutoUpdateObserver(n),n},_.prototype.clear=function(e){var t=this;e=e||{},this.data=[],this.idIndex=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedData=null,this.maxId=0,this.DynamicViews=[],this.dirty=!0,this.constraints={unique:{},exact:{}},!0===e.removeIndices?(this.binaryIndices={},this.uniqueNames=[]):Object.keys(this.binaryIndices).forEach((function(e){t.binaryIndices[e].dirty=!1,t.binaryIndices[e].values=[]}))},_.prototype.update=function(r){var n,i,o;if(Array.isArray(r)){o=r.length,(n=!this.cloneObjects&&this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0)&&(this.adaptiveBinaryIndices=!1);try{for(i=0;i<o;i+=1)this.update(r[i])}finally{n&&(this.ensureAllIndexes(),this.adaptiveBinaryIndices=!0)}}else{if(!e.call(r,"$loki"))throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();var s,a,u,c,l,f=this.get(r.$loki,!0),h=this;if(!f)throw new Error("Trying to update a document not in collection.");s=f[0],u=f[1],a=this.cloneObjects||!this.disableDeltaChangesApi&&this.disableFreeze?g(r,this.cloneMethod):r,this.emit("pre-update",r),this.uniqueNames.forEach((function(e){h.getUniqueIndex(e,!0).update(s,a)})),this.data[u]=a,a!==r&&this.addAutoUpdateObserver(r);for(var p=0;p<this.DynamicViews.length;p++)this.DynamicViews[p].evaluateDocument(u,!1);if(this.adaptiveBinaryIndices){var d=this.binaryIndices;for(c in d)this.adaptiveBinaryIndexUpdate(u,c)}else this.flagBinaryIndexesDirty();return this.idIndex[u]=a.$loki,this.isIncremental&&this.dirtyIds.push(a.$loki),this.commit(),this.dirty=!0,a=this.disableChangesApi?this.updateMeta(a):this.updateMetaWithChange(a,s),this.disableFreeze||t(a),l=this.cloneObjects?g(a,this.cloneMethod):a,this.emit("update",l,s),l}catch(e){throw this.rollback(),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),e}}},_.prototype.add=function(e){if("object"!=typeof e)throw new TypeError("Object being added needs to be an object");if(void 0!==e.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this.maxId++,isNaN(this.maxId)&&(this.maxId=this.data[this.data.length-1].$loki+1);var t=this.maxId;e.$loki=t,this.disableMeta||(e.meta.version=0);for(var r=0,n=this.uniqueNames.length;r<n;r++)this.getUniqueIndex(this.uniqueNames[r],!0).set(e);this.idIndex&&this.idIndex.push(t),this.isIncremental&&this.dirtyIds.push(t),this.data.push(e);var i=this.data.length-1,o=this.DynamicViews.length;for(r=0;r<o;r++)this.DynamicViews[r].evaluateDocument(i,!0);if(this.adaptiveBinaryIndices){var s=this.binaryIndices;for(var a in s)this.adaptiveBinaryIndexInsert(i,a)}else this.flagBinaryIndexesDirty();return this.commit(),this.dirty=!0,this.cloneObjects?g(e,this.cloneMethod):e}catch(e){throw this.rollback(),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),e}},_.prototype.updateWhere=function(e,t){var r,n=this.where(e),i=0;try{for(;i<n.length;i++)r=t(n[i]),this.update(r)}catch(e){this.rollback(),this.lokiConsoleWrapper.error(e.message)}},_.prototype.removeWhere=function(e){var t;"function"==typeof e?(t=this.data.filter(e),this.remove(t)):this.chain().find(e).remove()},_.prototype.removeDataOnly=function(){this.remove(this.data.slice())},_.prototype.removeBatchByPositions=function(e){var t,r,n,i,o=e.length,s={},a=Object.keys(this.binaryIndices).length,u=Object.keys(this.constraints.unique).length,c=this.adaptiveBinaryIndices&&Object.keys(this.binaryIndices).length>0,l=this;try{for(this.startTransaction(),this.ensureId(),n=0;n<o;n++)s[this.idIndex[e[n]]]=!0;if((t=this.DynamicViews.length)>0||a>0||u>0){if(t>0)for(r=0;r<t;r++)this.DynamicViews[r].removeDocument(e);if(this.adaptiveBinaryIndices&&!c){var f,h=this.binaryIndices;for(f in h)this.adaptiveBinaryIndexRemove(e,f)}else this.flagBinaryIndexesDirty();u&&this.uniqueNames.forEach((function(t){var r=l.getUniqueIndex(t);if(r)for(n=0;n<o;n++)null!==(i=l.data[e[n]])[t]&&void 0!==i[t]&&r.remove(i[t])}))}if(!this.disableChangesApi||this.events.delete.length>1)for(n=0;n<o;n++)this.emit("delete",this.data[e[n]]);if(this.data=this.data.filter((function(e){return!s[e.$loki]})),this.isIncremental)for(n=0;n<o;n++)this.dirtyIds.push(this.idIndex[e[n]]);this.idIndex=this.idIndex.filter((function(e){return!s[e]})),this.adaptiveBinaryIndices&&c&&(this.adaptiveBinaryIndices=!1,this.ensureAllIndexes(!0),this.adaptiveBinaryIndices=!0),this.commit(),this.dirty=!0}catch(e){return this.rollback(),c&&(this.adaptiveBinaryIndices=!0),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),null}},_.prototype.removeBatch=function(e){var t,r=e.length,n=this.data.length,i={},o=[];for(t=0;t<n;t++)i[this.data[t].$loki]=t;for(t=0;t<r;t++)"object"==typeof e[t]?o.push(i[e[t].$loki]):o.push(i[e[t]]);this.removeBatchByPositions(o)},_.prototype.remove=function(t){if("number"==typeof t&&(t=this.get(t)),"object"!=typeof t)throw new Error("Parameter is not an object");if(Array.isArray(t))this.removeBatch(t);else{if(!e.call(t,"$loki"))throw new Error("Object is not a document stored in the collection");try{this.startTransaction();var r=this.get(t.$loki,!0),o=r[1],s=this;this.uniqueNames.forEach((function(e){if(null!==t[e]&&void 0!==t[e]){var r=s.getUniqueIndex(e);r&&r.remove(t[e])}}));for(var a=0;a<this.DynamicViews.length;a++)this.DynamicViews[a].removeDocument(o);if(this.adaptiveBinaryIndices){var u,c=this.binaryIndices;for(u in c)this.adaptiveBinaryIndexRemove(o,u)}else this.flagBinaryIndexesDirty();return this.data.splice(o,1),this.removeAutoUpdateObserver(t),this.idIndex.splice(o,1),this.isIncremental&&this.dirtyIds.push(t.$loki),this.commit(),this.dirty=!0,this.emit("delete",r[0]),this.disableFreeze||(t=i(t)),delete t.$loki,delete t.meta,this.disableFreeze||n(t),t}catch(e){return this.rollback(),this.lokiConsoleWrapper.error(e.message),this.emit("error",e),null}}},_.prototype.get=function(e,t){this.idIndex||this.ensureId();var r=t||!1,n=this.idIndex,i=n.length-1,o=0,s=o+i>>1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))throw new TypeError("Passed id is not an integer");for(;n[o]<n[i];)n[s=o+i>>1]<e?o=s+1:i=s;return i===o&&n[o]===e?r?[this.data[o],o]:this.data[o]:null},_.prototype.getBinaryIndexPosition=function(e,t){var r=o.getIn(this.data[e],t,!0),n=this.binaryIndices[t].values,i=this.calculateRange("$eq",t,r);if(0===i[0]&&-1===i[1])return null;for(var s=i[0],a=i[1],u=s;u<=a;u++)if(n[u]===e)return u;return null},_.prototype.adaptiveBinaryIndexInsert=function(e,t){var r=-1!==t.indexOf("."),n=this.binaryIndices[t].values,i=o.getIn(this.data[e],t,r);!0===this.serializableIndices&&i instanceof Date&&(this.data[e][t]=i.getTime(),i=o.getIn(this.data[e],t));var s=0===n.length?0:this.calculateRangeStart(t,i,!0,r);this.binaryIndices[t].values.splice(s,0,e)},_.prototype.adaptiveBinaryIndexUpdate=function(e,t){var r,n=this.binaryIndices[t].values,i=n.length;for(r=0;r<i&&n[r]!==e;r++);this.binaryIndices[t].values.splice(r,1),this.adaptiveBinaryIndexInsert(e,t)},_.prototype.adaptiveBinaryIndexRemove=function(e,t,r){var n,i,o,s,a,u,c,l=this.binaryIndices[t],f={};if(Array.isArray(e)){if(1!==(s=e.length)){for(o=0;o<s;o++)f[e[o]]=!0;if(l.values=l.values.filter((function(e){return!f[e]})),!0===r)return;var h=e.slice();for(h.sort((function(e,t){return e-t})),n=l.values.length,i=0;i<n;i++){for(a=l.values[i],u=0,o=0;o<s&&a>h[o];o++)u++;l.values[i]-=u}return}e=e[0]}if(null===(c=this.getBinaryIndexPosition(e,t)))return null;if(l.values.splice(c,1),!0!==r)for(n=l.values.length,i=0;i<n;i++)l.values[i]>e&&l.values[i]--},_.prototype.calculateRangeStart=function(e,t,r,n){var i=this.data,a=this.binaryIndices[e].values,u=0,c=a.length-1,l=0;if(0===a.length)return-1;for(o.getIn(i[a[u]],e,n),o.getIn(i[a[c]],e,n);u<c;)l=u+c>>1,s.lt(o.getIn(i[a[l]],e,n),t,!1)?u=l+1:c=l;var f=u;return s.aeq(t,o.getIn(i[a[f]],e,n))?f:s.lt(t,o.getIn(i[a[f]],e,n),!1)?r?f:f-1:r?f+1:f},_.prototype.calculateRangeEnd=function(e,t,r){var n=this.data,i=this.binaryIndices[e].values,a=0,u=i.length-1,c=0;if(0===i.length)return-1;for(o.getIn(n[i[a]],e,r),o.getIn(n[i[u]],e,r);a<u;)c=a+u>>1,s.lt(t,o.getIn(n[i[c]],e,r),!1)?u=c:a=c+1;var l=u;return s.aeq(t,o.getIn(n[i[l]],e,r))?l:s.gt(t,o.getIn(n[i[l]],e,r),!1)?l+1:s.aeq(t,o.getIn(n[i[l-1]],e,r))?l-1:l},_.prototype.calculateRange=function(e,t,r){var n,i,a,u=this.data,c=this.binaryIndices[t].values,l=0,f=c.length-1;if(0===u.length)return[0,-1];var h=-1!==t.indexOf("."),p=o.getIn(u[c[l]],t,h),d=o.getIn(u[c[f]],t,h);switch(e){case"$eq":case"$aeq":case"$dteq":if(s.lt(r,p,!1)||s.gt(r,d,!1))return[0,-1];break;case"$gt":if(s.gt(r,d,!0))return[0,-1];if(s.gt(p,r,!1))return[l,f];break;case"$gte":if(s.gt(r,d,!1))return[0,-1];if(s.gt(p,r,!0))return[l,f];break;case"$lt":if(s.lt(r,p,!0))return[0,-1];if(s.lt(d,r,!1))return[l,f];break;case"$lte":if(s.lt(r,p,!1))return[0,-1];if(s.lt(d,r,!0))return[l,f];break;case"$between":return s.gt(r[0],d,!1)||s.lt(r[1],p,!1)?[0,-1]:((n=this.calculateRangeStart(t,r[0],!1,h))<0&&n++,(a=this.calculateRangeEnd(t,r[1],h))>f&&a--,s.gt(o.getIn(u[c[n]],t,h),r[0],!0)||n++,s.lt(o.getIn(u[c[a]],t,h),r[1],!0)||a--,a<n?[0,-1]:[n,a]);case"$in":for(var y=[],v=[],g=0,m=r.length;g<m;g++)for(var b=this.calculateRange("$eq",t,r[g]),w=b[0];w<=b[1];w++)void 0===y[w]&&(y[w]=!0,v.push(w));return v}switch(e){case"$eq":case"$aeq":case"$dteq":case"$gte":case"$lt":n=this.calculateRangeStart(t,r,!1,h),i=o.getIn(u[c[n]],t,h)}switch(e){case"$eq":case"$aeq":case"$dteq":case"$lte":case"$gt":a=this.calculateRangeEnd(t,r,h),o.getIn(u[c[a]],t,h)}switch(e){case"$eq":case"$aeq":case"$dteq":return s.aeq(i,r)?[n,a]:[0,-1];case"$gt":return s.aeq(o.getIn(u[c[a]],t,h),r)?[a+1,f]:[a,f];case"$gte":return s.aeq(o.getIn(u[c[n]],t,h),r)?[n,f]:[n+1,f];case"$lt":return s.aeq(o.getIn(u[c[n]],t,h),r)?[l,n-1]:[l,n];case"$lte":return s.aeq(o.getIn(u[c[a]],t,h),r)?[l,a]:[l,a-1];default:return[0,u.length-1]}},_.prototype.by=function(e,t){var r;if(void 0===t)return r=this,function(t){return r.by(e,t)};var n=this.getUniqueIndex(e,!0).get(t);return this.cloneObjects?g(n,this.cloneMethod):n},_.prototype.findOne=function(e){e=e||{};var t=this.chain().find(e,!0).data();return Array.isArray(t)&&0===t.length?null:this.cloneObjects?g(t[0],this.cloneMethod):t[0]},_.prototype.chain=function(e,t){var r=new x(this);return void 0===e?r:r.transform(e,t)},_.prototype.find=function(e){return this.chain().find(e).data()},_.prototype.findOneUnindexed=function(e,t){for(var r=this.data.length;r--;)if(o.getIn(this.data[r],e,!0)===t)return this.data[r];return null},_.prototype.startTransaction=function(){if(this.transactional){this.cachedData=g(this.data,this.cloneMethod),this.cachedIndex=this.idIndex,this.cachedBinaryIndex=this.binaryIndices,this.cachedDirtyIds=this.dirtyIds;for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].startTransaction()}},_.prototype.commit=function(){if(this.transactional){this.cachedData=null,this.cachedIndex=null,this.cachedBinaryIndex=null,this.cachedDirtyIds=null;for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].commit()}},_.prototype.rollback=function(){if(this.transactional){null!==this.cachedData&&null!==this.cachedIndex&&(this.data=this.cachedData,this.idIndex=this.cachedIndex,this.binaryIndices=this.cachedBinaryIndex,this.dirtyIds=this.cachedDirtyIds);for(var e=0;e<this.DynamicViews.length;e++)this.DynamicViews[e].rollback()}},_.prototype.async=function(e,t){setTimeout((function(){if("function"!=typeof e)throw new TypeError("Argument passed for async execution is not a function");e(),t()}),0)},_.prototype.where=function(e){return this.chain().where(e).data()},_.prototype.mapReduce=function(e,t){try{return t(this.data.map(e))}catch(e){throw e}},_.prototype.eqJoin=function(e,t,r,n,i){return new x(this).eqJoin(e,t,r,n,i)},_.prototype.stages={},_.prototype.getStage=function(e){return this.stages[e]||(this.stages[e]={}),this.stages[e]},_.prototype.commitLog=[],_.prototype.stage=function(e,t){var r=JSON.parse(JSON.stringify(t));return this.getStage(e)[t.$loki]=r,r},_.prototype.commitStage=function(e,t){var r,n=this.getStage(e),i=(new Date).getTime();for(r in n)this.update(n[r]),this.commitLog.push({timestamp:i,message:t,data:JSON.parse(JSON.stringify(n[r]))});this.stages[e]={}},_.prototype.no_op=function(){},_.prototype.extract=function(e){for(var t=0,r=this.data.length,n=E(e),i=[];t<r;t+=1)i.push(T(this.data[t],e,n));return i},_.prototype.max=function(e){return Math.max.apply(null,this.extract(e))},_.prototype.min=function(e){return Math.min.apply(null,this.extract(e))},_.prototype.maxRecord=function(e){for(var t,r=0,n=this.data.length,i=E(e),o={index:0,value:void 0};r<n;r+=1)void 0!==t?t<T(this.data[r],e,i)&&(t=T(this.data[r],e,i),o.index=this.data[r].$loki):(t=T(this.data[r],e,i),o.index=this.data[r].$loki);return o.value=t,o},_.prototype.minRecord=function(e){for(var t,r=0,n=this.data.length,i=E(e),o={index:0,value:void 0};r<n;r+=1)void 0!==t?t>T(this.data[r],e,i)&&(t=T(this.data[r],e,i),o.index=this.data[r].$loki):(t=T(this.data[r],e,i),o.index=this.data[r].$loki);return o.value=t,o},_.prototype.extractNumerical=function(e){return this.extract(e).map(C).filter(Number).filter((function(e){return!isNaN(e)}))},_.prototype.avg=function(e){return L(this.extractNumerical(e))},_.prototype.stdDev=function(e){return N(this.extractNumerical(e))},_.prototype.mode=function(e){var t,r,n,i={},o=this.extract(e);for(r in o.forEach((function(e){i[e]?i[e]+=1:i[e]=1})),i)t?t<i[r]&&(n=r):(n=r,t=i[r]);return n},_.prototype.median=function(e){var t=this.extractNumerical(e);t.sort(M);var r=Math.floor(t.length/2);return t.length%2?t[r]:(t[r-1]+t[r])/2},F.prototype={keys:[],values:[],sort:function(e,t){return e<t?-1:e>t?1:0},setSort:function(e){this.bs=new $(e)},bs:function(){return new $(this.sort)},set:function(e,t){var r=this.bs(this.keys,e);r.found?this.values[r.index]=t:(this.keys.splice(r.index,0,e),this.values.splice(r.index,0,t))},get:function(e){return this.values[B(this.keys,e,this.sort).index]}},z.prototype.keyMap={},z.prototype.lokiMap={},z.prototype.set=function(e){var t=e[this.field];if(null!=t){if(this.keyMap[t])throw new Error("Duplicate key for property "+this.field+": "+t);this.keyMap[t]=e,this.lokiMap[e.$loki]=t}},z.prototype.get=function(e){return this.keyMap[e]},z.prototype.byId=function(e){return this.keyMap[this.lokiMap[e]]},z.prototype.update=function(e,t){if(this.lokiMap[e.$loki]!==t[this.field]){var r=this.lokiMap[e.$loki];this.set(t),this.keyMap[r]=void 0}else this.keyMap[e[this.field]]=t},z.prototype.remove=function(e){var t=this.keyMap[e];if(null==t)throw new Error("Key is not in unique index: "+this.field);this.keyMap[e]=void 0,this.lokiMap[t.$loki]=void 0},z.prototype.clear=function(){this.keyMap=Object.create(null),this.lokiMap=Object.create(null)},R.prototype={set:function(e,t){this.index[e]?this.index[e].push(t):this.index[e]=[t]},remove:function(e,t){var r=this.index[e];for(var n in r)r[n]==t&&r.splice(n,1);r.length<1&&(this.index[e]=void 0)},get:function(e){return this.index[e]},clear:function(e){this.index={}}},q.prototype={keys:[],values:[],sort:function(e,t){return e<t?-1:e>t?1:0},bs:function(){return new $(this.sort)},setSort:function(e){this.bs=new $(e)},set:function(e,t){var r=B(this.keys,e,this.sort);r.found?this.values[r.index].push(t):(this.keys.splice(r.index,0,e),this.values.splice(r.index,0,[t]))},get:function(e){var t=B(this.keys,e,this.sort);return t.found?this.values[t.index]:[]},getLt:function(e){var t=B(this.keys,e,this.sort),r=t.index;return t.found&&r--,this.getAll(e,0,r)},getGt:function(e){var t=B(this.keys,e,this.sort),r=t.index;return t.found&&r++,this.getAll(e,r,this.keys.length)},getAll:function(e,t,r){for(var n=[],i=t;i<r;i++)n=n.concat(this.values[i]);return n},getPos:function(e){return B(this.keys,e,this.sort)},remove:function(e,t){var r=B(this.keys,e,this.sort).index,n=this.values[r];for(var i in n)n[i]==t&&n.splice(i,1);n.length<1&&(this.keys.splice(r,1),this.values.splice(r,1))},clear:function(){this.keys=[],this.values=[]}},S.deepFreeze=t,S.freeze=n,S.unFreeze=i,S.LokiOps=y,S.Collection=_,S.DynamicView=j,S.Resultset=x,S.KeyValueStore=F,S.LokiMemoryAdapter=I,S.LokiPartitioningAdapter=P,S.LokiLocalStorageAdapter=A,S.LokiFsAdapter=O,S.persistenceAdapters={fs:O,localStorage:A},S.aeq=a,S.lt=u,S.gt=c,S.Comparators=s,S}()},void 0===(o="function"==typeof n?n.apply(t,i):n)||(e.exports=o)},1528:function(e,t){var r,n,i;!function(o,s){"use strict";"object"==typeof e.exports?e.exports=s():(n=[],void 0===(i="function"==typeof(r=s)?r.apply(t,n):r)||(e.exports=i))}(0,(function(){"use strict";var e=Object.prototype.toString;function t(e,t){return null!=e&&Object.prototype.hasOwnProperty.call(e,t)}function r(e){if(!e)return!0;if(i(e)&&0===e.length)return!0;if("string"!=typeof e){for(var r in e)if(t(e,r))return!1;return!0}return!1}function n(t){return e.call(t)}var i=Array.isArray||function(t){return"[object Array]"===e.call(t)};function o(e){var t=parseInt(e);return t.toString()===e?t:e}function s(e){var s,a,u=function(e){return Object.keys(u).reduce((function(t,r){return"create"===r||"function"==typeof u[r]&&(t[r]=u[r].bind(u,e)),t}),{})};function c(e,t){if(s(e,t))return e[t]}function l(e,t,r,n){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if("string"==typeof t)return l(e,t.split(".").map(o),r,n);var i=t[0],s=a(e,i);return 1===t.length?(void 0!==s&&n||(e[i]=r),s):(void 0===s&&("number"==typeof t[1]?e[i]=[]:e[i]={}),l(e[i],t.slice(1),r,n))}return s=(e=e||{}).includeInheritedProps?function(){return!0}:function(e,r){return"number"==typeof r&&Array.isArray(e)||t(e,r)},a=e.includeInheritedProps?function(e,t){"string"!=typeof t&&"number"!=typeof t&&(t=String(t));var r=c(e,t);if("__proto__"===t||"prototype"===t||"constructor"===t&&"function"==typeof r)throw new Error("For security reasons, object's magic properties cannot be set");return r}:function(e,t){return c(e,t)},u.has=function(r,n){if("number"==typeof n?n=[n]:"string"==typeof n&&(n=n.split(".")),!n||0===n.length)return!!r;for(var s=0;s<n.length;s++){var a=o(n[s]);if(!("number"==typeof a&&i(r)&&a<r.length||(e.includeInheritedProps?a in Object(r):t(r,a))))return!1;r=r[a]}return!0},u.ensureExists=function(e,t,r){return l(e,t,r,!0)},u.set=function(e,t,r,n){return l(e,t,r,n)},u.insert=function(e,t,r,n){var o=u.get(e,t);n=~~n,i(o)||(o=[],u.set(e,t,o)),o.splice(n,0,r)},u.empty=function(e,t){var o,a;if(!r(t)&&(null!=e&&(o=u.get(e,t)))){if("string"==typeof o)return u.set(e,t,"");if(function(e){return"boolean"==typeof e||"[object Boolean]"===n(e)}(o))return u.set(e,t,!1);if("number"==typeof o)return u.set(e,t,0);if(i(o))o.length=0;else{if(!function(e){return"object"==typeof e&&"[object Object]"===n(e)}(o))return u.set(e,t,null);for(a in o)s(o,a)&&delete o[a]}}},u.push=function(e,t){var r=u.get(e,t);i(r)||(r=[],u.set(e,t,r)),r.push.apply(r,Array.prototype.slice.call(arguments,2))},u.coalesce=function(e,t,r){for(var n,i=0,o=t.length;i<o;i++)if(void 0!==(n=u.get(e,t[i])))return n;return r},u.get=function(e,t,r){if("number"==typeof t&&(t=[t]),!t||0===t.length)return e;if(null==e)return r;if("string"==typeof t)return u.get(e,t.split("."),r);var n=o(t[0]),i=a(e,n);return void 0===i?r:1===t.length?i:u.get(e[n],t.slice(1),r)},u.del=function(e,t){if("number"==typeof t&&(t=[t]),null==e)return e;if(r(t))return e;if("string"==typeof t)return u.del(e,t.split("."));var n=o(t[0]);return a(e,n),s(e,n)?1!==t.length?u.del(e[n],t.slice(1)):(i(e)?e.splice(n,1):delete e[n],e):e},u}var a=s();return a.create=s,a.withInheritedProps=s({includeInheritedProps:!0}),a}))},1368:e=>{e.exports=function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3];n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&i)+t[1]-389564586|0)<<12|o>>>20)+r|0)&r|~o&n)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&r)+t[3]-1044525330|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&i)+t[5]+1200080426|0)<<12|o>>>20)+r|0)&r|~o&n)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&r)+t[7]-45705983|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&i)+t[9]-1958414417|0)<<12|o>>>20)+r|0)&r|~o&n)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&r)+t[11]-1990404162|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&i)+t[13]-40341101|0)<<12|o>>>20)+r|0)&r|~o&n)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&r)+t[15]+1236535329|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[1]-165796510|0)<<5|r>>>27)+n|0)&i|n&~i)+t[6]-1069501632|0)<<9|o>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|i>>>18)+o|0)&r|o&~r)+t[0]-373897302|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[5]-701558691|0)<<5|r>>>27)+n|0)&i|n&~i)+t[10]+38016083|0)<<9|o>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|i>>>18)+o|0)&r|o&~r)+t[4]-405537848|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[9]+568446438|0)<<5|r>>>27)+n|0)&i|n&~i)+t[14]-1019803690|0)<<9|o>>>23)+r|0)&n|r&~n)+t[3]-187363961|0)<<14|i>>>18)+o|0)&r|o&~r)+t[8]+1163531501|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&i|n&~i)+t[2]-51403784|0)<<9|o>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&r|o&~r)+t[12]-1926607734|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[5]-378558|0)<<4|r>>>28)+n|0)^n^i)+t[8]-2022574463|0)<<11|o>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^r)+t[14]-35309556|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^i)+t[4]+1272893353|0)<<11|o>>>21)+r|0)^r^n)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^r)+t[10]-1094730640|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^i)+t[0]-358537222|0)<<11|o>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^r)+t[6]+76029189|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[9]-640364487|0)<<4|r>>>28)+n|0)^n^i)+t[12]-421815835|0)<<11|o>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^r)+t[2]-995338651|0)<<23|n>>>9)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[0]-198630844|0)<<6|r>>>26)+n|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~r))+t[5]-57434055|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[12]+1700485571|0)<<6|r>>>26)+n|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~r))+t[1]-2054922799|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[8]+1873313359|0)<<6|r>>>26)+n|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~r))+t[13]+1309151649|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[4]-145523070|0)<<6|r>>>26)+n|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+i|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}function n(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function i(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function o(e){var t,i,o,s,a,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,n(e.substring(t-64,t)));for(i=(e=e.substring(t-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),u=parseInt(s[1],16)||0,o[14]=a,o[15]=u,r(l,o),l}function s(e){var t,n,o,s,a,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,i(e.subarray(t-64,t)));for(n=(e=t-64<c?e.subarray(t-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)o[t>>2]|=e[t]<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),u=parseInt(s[1],16)||0,o[14]=a,o[15]=u,r(l,o),l}function a(e){var r,n="";for(r=0;r<4;r+=1)n+=t[e>>8*r+4&15]+t[e>>8*r&15];return n}function u(e){var t;for(t=0;t<e.length;t+=1)e[t]=a(e[t]);return e.join("")}function c(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function l(e,t){var r,n=e.length,i=new ArrayBuffer(n),o=new Uint8Array(i);for(r=0;r<n;r+=1)o[r]=e.charCodeAt(r);return t?o:i}function f(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function h(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}function p(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function d(){this.reset()}return u(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(r,n){var i,o,s,a,u=this.byteLength,c=t(r,u),l=u;return n!==e&&(l=t(n,u)),c>l?new ArrayBuffer(0):(i=l-c,o=new ArrayBuffer(i),s=new Uint8Array(o),a=new Uint8Array(this,c,i),s.set(a),o)}}(),d.prototype.append=function(e){return this.appendBinary(c(e)),this},d.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)r(this._hash,n(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},d.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),r=u(this._hash),e&&(r=p(r)),this.reset(),r},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(e,t){var n,i,o,s=t;if(e[s>>2]|=128<<(s%4<<3),s>55)for(r(this._hash,e),s=0;s<16;s+=1)e[s]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=i,e[15]=o,r(this._hash,e)},d.hash=function(e,t){return d.hashBinary(c(e),t)},d.hashBinary=function(e,t){var r=u(o(e));return t?p(r):r},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(e){var t,n=h(this._buff.buffer,e,!0),o=n.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)r(this._hash,i(n.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n[t]<<(t%4<<3);return this._finish(o,i),r=u(this._hash),e&&(r=p(r)),this.reset(),r},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var e=d.prototype.getState.call(this);return e.buff=f(e.buff),e},d.ArrayBuffer.prototype.setState=function(e){return e.buff=l(e.buff,!0),d.prototype.setState.call(this,e)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(e,t){var r=u(s(new Uint8Array(e)));return t?p(r):r},d}()},7462:(e,t,r)=>{var n=r(2825),i=r(7187).EventEmitter,o=r(9539),s=e.exports=function(e,t){if(!(this instanceof s))return new s(e,t);i.call(this),(t=t||{}).maxLineLength=t.maxLineLength||4096,t.retainBuffer=!!t.retainBuffer;var r=this,o=new Buffer(t.maxLineLength),a=0,u=0,c=0,l=function(e,n){try{var i=o.slice(0,a);r.emit("line",t.retainBuffer?i:i.toString(),e,n)}catch(e){r.emit("error",e)}finally{a=0}};this.input="string"==typeof e?n.createReadStream(e,t):e,this.input.on("open",(function(e){r.emit("open",e)})).on("data",(function(e){for(var t=0;t<e.length;t++)10==e[t]||13==e[t]?10==e[t]&&(u++,l(u,c)):(o[a]=e[t],a++),c++})).on("error",(function(e){r.emit("error",e)})).on("end",(function(){a&&(u++,l(u,c)),r.emit("end")})).on("close",(function(){r.emit("close")}))};o.inherits(s,i)},8322:e=>{e.exports=function(e){"use strict";var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function r(e,t){var r=e[0],n=e[1],i=e[2],o=e[3];n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[0]-680876936|0)<<7|r>>>25)+n|0)&n|~r&i)+t[1]-389564586|0)<<12|o>>>20)+r|0)&r|~o&n)+t[2]+606105819|0)<<17|i>>>15)+o|0)&o|~i&r)+t[3]-1044525330|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[4]-176418897|0)<<7|r>>>25)+n|0)&n|~r&i)+t[5]+1200080426|0)<<12|o>>>20)+r|0)&r|~o&n)+t[6]-1473231341|0)<<17|i>>>15)+o|0)&o|~i&r)+t[7]-45705983|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[8]+1770035416|0)<<7|r>>>25)+n|0)&n|~r&i)+t[9]-1958414417|0)<<12|o>>>20)+r|0)&r|~o&n)+t[10]-42063|0)<<17|i>>>15)+o|0)&o|~i&r)+t[11]-1990404162|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&i|~n&o)+t[12]+1804603682|0)<<7|r>>>25)+n|0)&n|~r&i)+t[13]-40341101|0)<<12|o>>>20)+r|0)&r|~o&n)+t[14]-1502002290|0)<<17|i>>>15)+o|0)&o|~i&r)+t[15]+1236535329|0)<<22|n>>>10)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[1]-165796510|0)<<5|r>>>27)+n|0)&i|n&~i)+t[6]-1069501632|0)<<9|o>>>23)+r|0)&n|r&~n)+t[11]+643717713|0)<<14|i>>>18)+o|0)&r|o&~r)+t[0]-373897302|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[5]-701558691|0)<<5|r>>>27)+n|0)&i|n&~i)+t[10]+38016083|0)<<9|o>>>23)+r|0)&n|r&~n)+t[15]-660478335|0)<<14|i>>>18)+o|0)&r|o&~r)+t[4]-405537848|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[9]+568446438|0)<<5|r>>>27)+n|0)&i|n&~i)+t[14]-1019803690|0)<<9|o>>>23)+r|0)&n|r&~n)+t[3]-187363961|0)<<14|i>>>18)+o|0)&r|o&~r)+t[8]+1163531501|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n&o|i&~o)+t[13]-1444681467|0)<<5|r>>>27)+n|0)&i|n&~i)+t[2]-51403784|0)<<9|o>>>23)+r|0)&n|r&~n)+t[7]+1735328473|0)<<14|i>>>18)+o|0)&r|o&~r)+t[12]-1926607734|0)<<20|n>>>12)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[5]-378558|0)<<4|r>>>28)+n|0)^n^i)+t[8]-2022574463|0)<<11|o>>>21)+r|0)^r^n)+t[11]+1839030562|0)<<16|i>>>16)+o|0)^o^r)+t[14]-35309556|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[1]-1530992060|0)<<4|r>>>28)+n|0)^n^i)+t[4]+1272893353|0)<<11|o>>>21)+r|0)^r^n)+t[7]-155497632|0)<<16|i>>>16)+o|0)^o^r)+t[10]-1094730640|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[13]+681279174|0)<<4|r>>>28)+n|0)^n^i)+t[0]-358537222|0)<<11|o>>>21)+r|0)^r^n)+t[3]-722521979|0)<<16|i>>>16)+o|0)^o^r)+t[6]+76029189|0)<<23|n>>>9)+i|0,n=((n+=((i=((i+=((o=((o+=((r=((r+=(n^i^o)+t[9]-640364487|0)<<4|r>>>28)+n|0)^n^i)+t[12]-421815835|0)<<11|o>>>21)+r|0)^r^n)+t[15]+530742520|0)<<16|i>>>16)+o|0)^o^r)+t[2]-995338651|0)<<23|n>>>9)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[0]-198630844|0)<<6|r>>>26)+n|0)|~i))+t[7]+1126891415|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[14]-1416354905|0)<<15|i>>>17)+o|0)|~r))+t[5]-57434055|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[12]+1700485571|0)<<6|r>>>26)+n|0)|~i))+t[3]-1894986606|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[10]-1051523|0)<<15|i>>>17)+o|0)|~r))+t[1]-2054922799|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[8]+1873313359|0)<<6|r>>>26)+n|0)|~i))+t[15]-30611744|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[6]-1560198380|0)<<15|i>>>17)+o|0)|~r))+t[13]+1309151649|0)<<21|n>>>11)+i|0,n=((n+=((o=((o+=(n^((r=((r+=(i^(n|~o))+t[4]-145523070|0)<<6|r>>>26)+n|0)|~i))+t[11]-1120210379|0)<<10|o>>>22)+r|0)^((i=((i+=(r^(o|~n))+t[2]+718787259|0)<<15|i>>>17)+o|0)|~r))+t[9]-343485551|0)<<21|n>>>11)+i|0,e[0]=r+e[0]|0,e[1]=n+e[1]|0,e[2]=i+e[2]|0,e[3]=o+e[3]|0}function n(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}function i(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24);return r}function o(e){var t,i,o,s,a,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,n(e.substring(t-64,t)));for(i=(e=e.substring(t-64)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<i;t+=1)o[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),u=parseInt(s[1],16)||0,o[14]=a,o[15]=u,r(l,o),l}function s(e){var t,n,o,s,a,u,c=e.length,l=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=c;t+=64)r(l,i(e.subarray(t-64,t)));for(n=(e=t-64<c?e.subarray(t-64):new Uint8Array(0)).length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],t=0;t<n;t+=1)o[t>>2]|=e[t]<<(t%4<<3);if(o[t>>2]|=128<<(t%4<<3),t>55)for(r(l,o),t=0;t<16;t+=1)o[t]=0;return s=(s=8*c).toString(16).match(/(.*?)(.{0,8})$/),a=parseInt(s[2],16),u=parseInt(s[1],16)||0,o[14]=a,o[15]=u,r(l,o),l}function a(e){var r,n="";for(r=0;r<4;r+=1)n+=t[e>>8*r+4&15]+t[e>>8*r&15];return n}function u(e){var t;for(t=0;t<e.length;t+=1)e[t]=a(e[t]);return e.join("")}function c(e){return/[\u0080-\uFFFF]/.test(e)&&(e=unescape(encodeURIComponent(e))),e}function l(e,t){var r,n=e.length,i=new ArrayBuffer(n),o=new Uint8Array(i);for(r=0;r<n;r+=1)o[r]=e.charCodeAt(r);return t?o:i}function f(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function h(e,t,r){var n=new Uint8Array(e.byteLength+t.byteLength);return n.set(new Uint8Array(e)),n.set(new Uint8Array(t),e.byteLength),r?n:n.buffer}function p(e){var t,r=[],n=e.length;for(t=0;t<n-1;t+=2)r.push(parseInt(e.substr(t,2),16));return String.fromCharCode.apply(String,r)}function d(){this.reset()}return u(o("hello")),"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function t(e,t){return(e=0|e||0)<0?Math.max(e+t,0):Math.min(e,t)}ArrayBuffer.prototype.slice=function(r,n){var i,o,s,a,u=this.byteLength,c=t(r,u),l=u;return n!==e&&(l=t(n,u)),c>l?new ArrayBuffer(0):(i=l-c,o=new ArrayBuffer(i),s=new Uint8Array(o),a=new Uint8Array(this,c,i),s.set(a),o)}}(),d.prototype.append=function(e){return this.appendBinary(c(e)),this},d.prototype.appendBinary=function(e){this._buff+=e,this._length+=e.length;var t,i=this._buff.length;for(t=64;t<=i;t+=64)r(this._hash,n(this._buff.substring(t-64,t)));return this._buff=this._buff.substring(t-64),this},d.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n.charCodeAt(t)<<(t%4<<3);return this._finish(o,i),r=u(this._hash),e&&(r=p(r)),this.reset(),r},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(e){return this._buff=e.buff,this._length=e.length,this._hash=e.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(e,t){var n,i,o,s=t;if(e[s>>2]|=128<<(s%4<<3),s>55)for(r(this._hash,e),s=0;s<16;s+=1)e[s]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(n[2],16),o=parseInt(n[1],16)||0,e[14]=i,e[15]=o,r(this._hash,e)},d.hash=function(e,t){return d.hashBinary(c(e),t)},d.hashBinary=function(e,t){var r=u(o(e));return t?p(r):r},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(e){var t,n=h(this._buff.buffer,e,!0),o=n.length;for(this._length+=e.byteLength,t=64;t<=o;t+=64)r(this._hash,i(n.subarray(t-64,t)));return this._buff=t-64<o?new Uint8Array(n.buffer.slice(t-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(e){var t,r,n=this._buff,i=n.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<i;t+=1)o[t>>2]|=n[t]<<(t%4<<3);return this._finish(o,i),r=u(this._hash),e&&(r=p(r)),this.reset(),r},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var e=d.prototype.getState.call(this);return e.buff=f(e.buff),e},d.ArrayBuffer.prototype.setState=function(e){return e.buff=l(e.buff,!0),d.prototype.setState.call(this,e)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(e,t){var r=u(s(new Uint8Array(e)));return t?p(r):r},d}()},3086:(e,t,r)=>{var n=r(624);function i(){n.call(this)}i.prototype=new n,e.exports=i,i.Stream=i,i.prototype.pipe=function(e,t){var r=this;function n(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function i(){r.readable&&r.resume&&r.resume()}r.on("data",n),e.on("drain",i),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",a));var o=!1;function s(){o||(o=!0,e.end())}function a(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){if(c(),!this.hasListeners("error"))throw e}function c(){r.off("data",n),e.off("drain",i),r.off("end",s),r.off("close",a),r.off("error",u),e.off("error",u),r.off("end",c),r.off("close",c),e.off("end",c),e.off("close",c)}return r.on("error",u),e.on("error",u),r.on("end",c),r.on("close",c),e.on("end",c),e.on("close",c),e.emit("pipe",r),e}},2467:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserialize=t.registerSerializer=void 0;const n=r(7381);let i=n.DefaultSerializer;t.registerSerializer=function(e){i=n.extendSerializer(i,e)},t.deserialize=function(e){return i.deserialize(e)},t.serialize=function(e){return i.serialize(e)}},7381:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultSerializer=t.extendSerializer=void 0,t.extendSerializer=function(e,t){const r=e.deserialize.bind(e),n=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,r),serialize:e=>t.serialize(e,n)}};const r={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})};t.DefaultSerializer={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?r.deserialize(e):e;var t},serialize:e=>e instanceof Error?r.serialize(e):e}},8258:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.$worker=t.$transferable=t.$terminate=t.$events=t.$errors=void 0,t.$errors=Symbol("thread.errors"),t.$events=Symbol("thread.events"),t.$terminate=Symbol("thread.terminate"),t.$transferable=Symbol("thread.transferable"),t.$worker=Symbol("thread.worker")},8180:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Transfer=t.isTransferDescriptor=void 0;const n=r(8258);t.isTransferDescriptor=function(e){return e&&"object"==typeof e&&e[n.$transferable]},t.Transfer=function(e,t){if(!t){if(!(r=e)||"object"!=typeof r)throw Error();t=[e]}var r;return{[n.$transferable]:!0,send:e,transferables:t}}},3229:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageType=t.MasterMessageType=void 0,function(e){e.cancel="cancel",e.run="run"}(t.MasterMessageType||(t.MasterMessageType={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(t.WorkerMessageType||(t.WorkerMessageType={}))},3447:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={isWorkerRuntime:function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}},1934:function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function s(e){try{u(n.next(e))}catch(e){o(e)}}function a(e){try{u(n.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.expose=t.isWorkerRuntime=t.Transfer=t.registerSerializer=void 0;const o=i(r(6898)),s=r(2467),a=r(8180),u=r(3229),c=i(r(3447));var l=r(2467);Object.defineProperty(t,"registerSerializer",{enumerable:!0,get:function(){return l.registerSerializer}});var f=r(8180);Object.defineProperty(t,"Transfer",{enumerable:!0,get:function(){return f.Transfer}}),t.isWorkerRuntime=c.default.isWorkerRuntime;let h=!1;const p=new Map,d=e=>e&&e.type===u.MasterMessageType.run,y=e=>o.default(e)||function(e){return e&&"object"==typeof e&&"function"==typeof e.subscribe}(e);function v(e){return a.isTransferDescriptor(e)?{payload:e.send,transferables:e.transferables}:{payload:e,transferables:void 0}}function g(e,t){const{payload:r,transferables:n}=v(t),i={type:u.WorkerMessageType.error,uid:e,error:s.serialize(r)};c.default.postMessageToMaster(i,n)}function m(e,t,r){const{payload:n,transferables:i}=v(r),o={type:u.WorkerMessageType.result,uid:e,complete:!!t||void 0,payload:n};c.default.postMessageToMaster(o,i)}function b(e){try{const t={type:u.WorkerMessageType.uncaughtError,error:s.serialize(e)};c.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}function w(e,t,r){return n(this,void 0,void 0,(function*(){let n;try{n=t(...r)}catch(t){return g(e,t)}const i=y(n)?"observable":"promise";if(function(e,t){const r={type:u.WorkerMessageType.running,uid:e,resultType:t};c.default.postMessageToMaster(r)}(e,i),y(n)){const t=n.subscribe((t=>m(e,!1,s.serialize(t))),(t=>{g(e,s.serialize(t)),p.delete(e)}),(()=>{m(e,!0),p.delete(e)}));p.set(e,t)}else try{const t=yield n;m(e,!0,s.serialize(t))}catch(t){g(e,s.serialize(t))}}))}t.expose=function(e){if(!c.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(h)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(h=!0,"function"==typeof e)c.default.subscribeToMasterMessages((t=>{d(t)&&!t.method&&w(t.uid,e,t.args.map(s.deserialize))})),function(){const e={type:u.WorkerMessageType.init,exposed:{type:"function"}};c.default.postMessageToMaster(e)}();else{if("object"!=typeof e||!e)throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${e}`);c.default.subscribeToMasterMessages((t=>{d(t)&&t.method&&w(t.uid,e[t.method],t.args.map(s.deserialize))}));!function(e){const t={type:u.WorkerMessageType.init,exposed:{type:"module",methods:e}};c.default.postMessageToMaster(t)}(Object.keys(e).filter((t=>"function"==typeof e[t])))}c.default.subscribeToMasterMessages((e=>{if((t=e)&&t.type===u.MasterMessageType.cancel){const t=e.uid,r=p.get(t);r&&(r.unsubscribe(),p.delete(t))}var t}))},"undefined"!=typeof self&&"function"==typeof self.addEventListener&&c.default.isWorkerRuntime()&&(self.addEventListener("error",(e=>{setTimeout((()=>b(e.error||e)),250)})),self.addEventListener("unhandledrejection",(e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout((()=>b(t)),250)}))),"undefined"!=typeof process&&"function"==typeof process.on&&c.default.isWorkerRuntime()&&(process.on("uncaughtException",(e=>{setTimeout((()=>b(e)),250)})),process.on("unhandledRejection",(e=>{e&&"string"==typeof e.message&&setTimeout((()=>b(e)),250)})))},384:e=>{e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},5955:(e,t,r)=>{"use strict";var n=r(2584),i=r(8662),o=r(6430),s=r(5692);function a(e){return e.call.bind(e)}var u="undefined"!=typeof BigInt,c="undefined"!=typeof Symbol,l=a(Object.prototype.toString),f=a(Number.prototype.valueOf),h=a(String.prototype.valueOf),p=a(Boolean.prototype.valueOf);if(u)var d=a(BigInt.prototype.valueOf);if(c)var y=a(Symbol.prototype.valueOf);function v(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function g(e){return"[object Map]"===l(e)}function m(e){return"[object Set]"===l(e)}function b(e){return"[object WeakMap]"===l(e)}function w(e){return"[object WeakSet]"===l(e)}function S(e){return"[object ArrayBuffer]"===l(e)}function I(e){return"undefined"!=typeof ArrayBuffer&&(S.working?S(e):e instanceof ArrayBuffer)}function P(e){return"[object DataView]"===l(e)}function O(e){return"undefined"!=typeof DataView&&(P.working?P(e):e instanceof DataView)}t.isArgumentsObject=n,t.isGeneratorFunction=i,t.isTypedArray=s,t.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):s(e)||O(e)},t.isUint8Array=function(e){return"Uint8Array"===o(e)},t.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===o(e)},t.isUint16Array=function(e){return"Uint16Array"===o(e)},t.isUint32Array=function(e){return"Uint32Array"===o(e)},t.isInt8Array=function(e){return"Int8Array"===o(e)},t.isInt16Array=function(e){return"Int16Array"===o(e)},t.isInt32Array=function(e){return"Int32Array"===o(e)},t.isFloat32Array=function(e){return"Float32Array"===o(e)},t.isFloat64Array=function(e){return"Float64Array"===o(e)},t.isBigInt64Array=function(e){return"BigInt64Array"===o(e)},t.isBigUint64Array=function(e){return"BigUint64Array"===o(e)},g.working="undefined"!=typeof Map&&g(new Map),t.isMap=function(e){return"undefined"!=typeof Map&&(g.working?g(e):e instanceof Map)},m.working="undefined"!=typeof Set&&m(new Set),t.isSet=function(e){return"undefined"!=typeof Set&&(m.working?m(e):e instanceof Set)},b.working="undefined"!=typeof WeakMap&&b(new WeakMap),t.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(b.working?b(e):e instanceof WeakMap)},w.working="undefined"!=typeof WeakSet&&w(new WeakSet),t.isWeakSet=function(e){return w(e)},S.working="undefined"!=typeof ArrayBuffer&&S(new ArrayBuffer),t.isArrayBuffer=I,P.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&P(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=O;var A="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function x(e){return"[object SharedArrayBuffer]"===l(e)}function k(e){return void 0!==A&&(void 0===x.working&&(x.working=x(new A)),x.working?x(e):e instanceof A)}function j(e){return v(e,f)}function _(e){return v(e,h)}function E(e){return v(e,p)}function C(e){return u&&v(e,d)}function D(e){return c&&v(e,y)}t.isSharedArrayBuffer=k,t.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},t.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},t.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},t.isGeneratorObject=function(e){return"[object Generator]"===l(e)},t.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},t.isNumberObject=j,t.isStringObject=_,t.isBooleanObject=E,t.isBigIntObject=C,t.isSymbolObject=D,t.isBoxedPrimitive=function(e){return j(e)||_(e)||E(e)||C(e)||D(e)},t.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(I(e)||k(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},9539:(e,t,r)=>{var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},i=/%[sdj%]/g;t.format=function(e){if(!m(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(u(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,o=n.length,s=String(e).replace(i,(function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),a=n[r];r<o;a=n[++r])v(a)||!S(a)?s+=" "+a:s+=" "+u(a);return s},t.deprecate=function(e,r){if("undefined"!=typeof process&&!0===process.noDeprecation)return e;if("undefined"==typeof process)return function(){return t.deprecate(e,r).apply(this,arguments)};var n=!1;return function(){if(!n){if(process.throwDeprecation)throw new Error(r);process.traceDeprecation?console.trace(r):console.error(r),n=!0}return e.apply(this,arguments)}};var o={},s=/^$/;if(process.env.NODE_DEBUG){var a=process.env.NODE_DEBUG;a=a.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),s=new RegExp("^"+a+"$","i")}function u(e,r){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(r)?n.showHidden=r:r&&t._extend(n,r),b(n.showHidden)&&(n.showHidden=!1),b(n.depth)&&(n.depth=2),b(n.colors)&&(n.colors=!1),b(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),f(n,e,n.depth)}function c(e,t){var r=u.styles[t];return r?"["+u.colors[r][0]+"m"+e+"["+u.colors[r][1]+"m":e}function l(e,t){return e}function f(e,r,n){if(e.customInspect&&r&&O(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return m(i)||(i=f(e,i,n)),i}var o=function(e,t){if(b(t))return e.stylize("undefined","undefined");if(m(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(g(t))return e.stylize(""+t,"number");if(y(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,r);if(o)return o;var s=Object.keys(r),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),P(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(r);if(0===s.length){if(O(r)){var u=r.name?": "+r.name:"";return e.stylize("[Function"+u+"]","special")}if(w(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(I(r))return e.stylize(Date.prototype.toString.call(r),"date");if(P(r))return h(r)}var c,l="",S=!1,A=["{","}"];(d(r)&&(S=!0,A=["[","]"]),O(r))&&(l=" [Function"+(r.name?": "+r.name:"")+"]");return w(r)&&(l=" "+RegExp.prototype.toString.call(r)),I(r)&&(l=" "+Date.prototype.toUTCString.call(r)),P(r)&&(l=" "+h(r)),0!==s.length||S&&0!=r.length?n<0?w(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),c=S?function(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)_(t,String(s))?o.push(p(e,t,r,n,String(s),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(p(e,t,r,n,i,!0))})),o}(e,r,n,a,s):s.map((function(t){return p(e,r,n,a,t,S)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,l,A)):A[0]+l+A[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,r,n,i,o){var s,a,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?a=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(a=e.stylize("[Setter]","special")),_(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(u.value)<0?(a=v(r)?f(e,u.value,null):f(e,u.value,r-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+a.split("\n").map((function(e){return"   "+e})).join("\n")):a=e.stylize("[Circular]","special")),b(s)){if(o&&i.match(/^\d+$/))return a;(s=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function d(e){return Array.isArray(e)}function y(e){return"boolean"==typeof e}function v(e){return null===e}function g(e){return"number"==typeof e}function m(e){return"string"==typeof e}function b(e){return void 0===e}function w(e){return S(e)&&"[object RegExp]"===A(e)}function S(e){return"object"==typeof e&&null!==e}function I(e){return S(e)&&"[object Date]"===A(e)}function P(e){return S(e)&&("[object Error]"===A(e)||e instanceof Error)}function O(e){return"function"==typeof e}function A(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!o[e])if(s.test(e)){var r=process.pid;o[e]=function(){var n=t.format.apply(t,arguments);console.error("%s %d: %s",e,r,n)}}else o[e]=function(){};return o[e]},t.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=r(5955),t.isArray=d,t.isBoolean=y,t.isNull=v,t.isNullOrUndefined=function(e){return null==e},t.isNumber=g,t.isString=m,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=b,t.isRegExp=w,t.types.isRegExp=w,t.isObject=S,t.isDate=I,t.types.isDate=I,t.isError=P,t.types.isNativeError=P,t.isFunction=O,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(384);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function j(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),k[e.getMonth()],t].join(" ")}function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",j(),t.format.apply(t,arguments))},t.inherits=r(5717),t._extend=function(e,t){if(!t||!S(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var E="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function C(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(E&&e[E]){var t;if("function"!=typeof(t=e[E]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,i)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),E&&Object.defineProperty(t,E,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=E,t.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var n=t.pop();if("function"!=typeof n)throw new TypeError("The last argument must be of type Function");var i=this,o=function(){return n.apply(i,arguments)};e.apply(this,t).then((function(e){process.nextTick(o.bind(null,null,e))}),(function(e){process.nextTick(C.bind(null,e,o))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,n(e)),t}},6430:(e,t,r)=>{"use strict";var n=r(9804),i=r(3083),o=r(1924),s=o("Object.prototype.toString"),a=r(6410)(),u="undefined"==typeof globalThis?r.g:globalThis,c=i(),l=o("String.prototype.slice"),f={},h=r(882),p=Object.getPrototypeOf;a&&h&&p&&n(c,(function(e){if("function"==typeof u[e]){var t=new u[e];if(Symbol.toStringTag in t){var r=p(t),n=h(r,Symbol.toStringTag);if(!n){var i=p(r);n=h(i,Symbol.toStringTag)}f[e]=n.get}}}));var d=r(5692);e.exports=function(e){return!!d(e)&&(a&&Symbol.toStringTag in e?function(e){var t=!1;return n(f,(function(r,n){if(!t)try{var i=r.call(e);i===n&&(t=i)}catch(e){}})),t}(e):l(s(e),8,-1))}},693:()=>{},2825:()=>{},199:()=>{},3083:(e,t,r)=>{"use strict";var n=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],i="undefined"==typeof globalThis?r.g:globalThis;e.exports=function(){for(var e=[],t=0;t<n.length;t++)"function"==typeof i[n[t]]&&(e[e.length]=n[t]);return e}},882:(e,t,r)=>{"use strict";var n=r(210)("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";r(4063),r(1528);function e(e){return"string"==typeof e?e:e.key}var t=r(3050),n=r.n(t),i=(r(6313),r(8322)),o=r.n(i),s=r(9134),a=r.n(s);var u=0;function c(){var e=(new Date).getTime();return e<=u&&(e=u+1),u=e,e}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))}Promise.resolve(!0),Promise.resolve(!1),Promise.resolve(null);var f=Promise.resolve();function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return"object"==typeof window&&window.requestIdleCallback?new Promise((function(t){return window.requestIdleCallback(t,{timeout:e})})):l(0)}function p(e){if(!e)throw new Error("ensureNotFalsy() is falsy");return e}function d(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t="",r="abcdefghijklmnopqrstuvwxyz",n=0;n<e;n++)t+=r.charAt(Math.floor(Math.random()*r.length));return t}function y(e){return Object.assign({},e)}a()();function v(e){var t=e.split("-");return{height:parseInt(t[0],10),hash:t[1]}}function g(e){var t=Object.assign({},e,{_rev_tree:void 0}),r=JSON.stringify(t);return o().hash(r)}function m(e,t){var r=e.get(t);if(!r)throw new Error("missing value from map "+t);return r}var b=function(e,t){return b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},b(e,t)};function w(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}b(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}Object.create;function S(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return s}function P(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))}Object.create;function O(e){return"function"==typeof e}function A(e){var t=e((function(e){Error.call(e),e.stack=(new Error).stack}));return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var x=A((function(e){return function(t){e(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(e,t){return t+1+") "+e.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t}}));function k(e,t){if(e){var r=e.indexOf(t);0<=r&&e.splice(r,1)}}var j=function(){function e(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._teardowns=null}var t;return e.prototype.unsubscribe=function(){var e,t,r,n,i;if(!this.closed){this.closed=!0;var o=this._parentage;if(o)if(this._parentage=null,Array.isArray(o))try{for(var s=S(o),a=s.next();!a.done;a=s.next()){a.value.remove(this)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}else o.remove(this);var u=this.initialTeardown;if(O(u))try{u()}catch(e){i=e instanceof x?e.errors:[e]}var c=this._teardowns;if(c){this._teardowns=null;try{for(var l=S(c),f=l.next();!f.done;f=l.next()){var h=f.value;try{C(h)}catch(e){i=null!=i?i:[],e instanceof x?i=P(P([],I(i)),I(e.errors)):i.push(e)}}}catch(e){r={error:e}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(r)throw r.error}}}if(i)throw new x(i)}},e.prototype.add=function(t){var r;if(t&&t!==this)if(this.closed)C(t);else{if(t instanceof e){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._teardowns=null!==(r=this._teardowns)&&void 0!==r?r:[]).push(t)}},e.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},e.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},e.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&k(t,e)},e.prototype.remove=function(t){var r=this._teardowns;r&&k(r,t),t instanceof e&&t._removeParent(this)},e.EMPTY=((t=new e).closed=!0,t),e}(),_=j.EMPTY;function E(e){return e instanceof j||e&&"closed"in e&&O(e.remove)&&O(e.add)&&O(e.unsubscribe)}function C(e){O(e)?e():e.unsubscribe()}var D={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},M={setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=M.delegate;return((null==r?void 0:r.setTimeout)||setTimeout).apply(void 0,P([],I(e)))},clearTimeout:function(e){var t=M.delegate;return((null==t?void 0:t.clearTimeout)||clearTimeout)(e)},delegate:void 0};function L(e){M.setTimeout((function(){var t=D.onUnhandledError;if(!t)throw e;t(e)}))}function N(){}var T=B("C",void 0,void 0);function B(e,t,r){return{kind:e,value:t,error:r}}var $=null;function F(e){if(D.useDeprecatedSynchronousErrorHandling){var t=!$;if(t&&($={errorThrown:!1,error:null}),e(),t){var r=$,n=r.errorThrown,i=r.error;if($=null,n)throw i}}else e()}function z(e){D.useDeprecatedSynchronousErrorHandling&&$&&($.errorThrown=!0,$.error=e)}var R=function(e){function t(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,E(t)&&t.add(r)):r.destination=J,r}return w(t,e),t.create=function(e,t,r){return new q(e,t,r)},t.prototype.next=function(e){this.isStopped?V(function(e){return B("N",e,void 0)}(e),this):this._next(e)},t.prototype.error=function(e){this.isStopped?V(B("E",void 0,e),this):(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped?V(T,this):(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(j),q=function(e){function t(t,r,n){var i,o=e.call(this)||this;if(O(t))i=t;else if(t){var s;i=t.next,r=t.error,n=t.complete,o&&D.useDeprecatedNextContext?(s=Object.create(t)).unsubscribe=function(){return o.unsubscribe()}:s=t,i=null==i?void 0:i.bind(s),r=null==r?void 0:r.bind(s),n=null==n?void 0:n.bind(s)}return o.destination={next:i?U(i,o):N,error:U(null!=r?r:W,o),complete:n?U(n,o):N},o}return w(t,e),t}(R);function U(e,t){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{e.apply(void 0,P([],I(t)))}catch(e){D.useDeprecatedSynchronousErrorHandling?z(e):L(e)}}}function W(e){throw e}function V(e,t){var r=D.onStoppedNotification;r&&M.setTimeout((function(){return r(e,t)}))}var J={closed:!0,next:N,error:W,complete:N},K="function"==typeof Symbol&&Symbol.observable||"@@observable";function Q(e){return e}function G(e){return 0===e.length?Q:1===e.length?e[0]:function(t){return e.reduce((function(e,t){return t(e)}),t)}}var H=function(){function e(e){e&&(this._subscribe=e)}return e.prototype.lift=function(t){var r=new e;return r.source=this,r.operator=t,r},e.prototype.subscribe=function(e,t,r){var n,i=this,o=(n=e)&&n instanceof R||function(e){return e&&O(e.next)&&O(e.error)&&O(e.complete)}(n)&&E(n)?e:new q(e,t,r);return F((function(){var e=i,t=e.operator,r=e.source;o.add(t?t.call(o,r):r?i._subscribe(o):i._trySubscribe(o))})),o},e.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},e.prototype.forEach=function(e,t){var r=this;return new(t=Y(t))((function(t,n){var i=new q({next:function(t){try{e(t)}catch(e){n(e),i.unsubscribe()}},error:n,complete:t});r.subscribe(i)}))},e.prototype._subscribe=function(e){var t;return null===(t=this.source)||void 0===t?void 0:t.subscribe(e)},e.prototype[K]=function(){return this},e.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return G(e)(this)},e.prototype.toPromise=function(e){var t=this;return new(e=Y(e))((function(e,r){var n;t.subscribe((function(e){return n=e}),(function(e){return r(e)}),(function(){return e(n)}))}))},e.create=function(t){return new e(t)},e}();function Y(e){var t;return null!==(t=null!=e?e:D.Promise)&&void 0!==t?t:Promise}var Z=A((function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}})),X=function(e){function t(){var t=e.call(this)||this;return t.closed=!1,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return w(t,e),t.prototype.lift=function(e){var t=new ee(this,this);return t.operator=e,t},t.prototype._throwIfClosed=function(){if(this.closed)throw new Z},t.prototype.next=function(e){var t=this;F((function(){var r,n;if(t._throwIfClosed(),!t.isStopped){var i=t.observers.slice();try{for(var o=S(i),s=o.next();!s.done;s=o.next()){s.value.next(e)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}}}))},t.prototype.error=function(e){var t=this;F((function(){if(t._throwIfClosed(),!t.isStopped){t.hasError=t.isStopped=!0,t.thrownError=e;for(var r=t.observers;r.length;)r.shift().error(e)}}))},t.prototype.complete=function(){var e=this;F((function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var t=e.observers;t.length;)t.shift().complete()}}))},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var t=this,r=t.hasError,n=t.isStopped,i=t.observers;return r||n?_:(i.push(e),new j((function(){return k(i,e)})))},t.prototype._checkFinalizedStatuses=function(e){var t=this,r=t.hasError,n=t.thrownError,i=t.isStopped;r?e.error(n):i&&e.complete()},t.prototype.asObservable=function(){var e=new H;return e.source=this,e},t.create=function(e,t){return new ee(e,t)},t}(H),ee=function(e){function t(t,r){var n=e.call(this)||this;return n.destination=t,n.source=r,n}return w(t,e),t.prototype.next=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)},t.prototype.error=function(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)},t.prototype.complete=function(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)},t.prototype._subscribe=function(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:_},t}(X);function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function re(e,t,r){return t&&te(e.prototype,t),r&&te(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function ne(e,t){return ne=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ne(e,t)}function ie(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ne(e,t)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}function se(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function ae(e,t,r){return ae=se()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&ne(i,r.prototype),i},ae.apply(null,arguments)}function ue(e){var t="function"==typeof Map?new Map:void 0;return ue=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return ae(e,arguments,oe(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),ne(n,e)},ue(e)}var ce=function(e){return"RxDB Error-Code "+e+".\n        - To find out what this means, use the dev-mode-plugin https://pubkey.github.io/rxdb/custom-build.html#dev-mode\n        - Or search for this code https://github.com/pubkey/rxdb/search?q="+e+"\n        "};function le(e,t,r){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((function(t){var r="[object Object]";try{r=JSON.stringify(e[t],(function(e,t){return void 0===t?null:t}),2)}catch(e){}return t+":"+r})).join("\n"),t+="}")}(r)}var fe=function(e){function t(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=le(r,t,i);return(n=e.call(this,o)||this).code=t,n.message=o,n.parameters=i,n.rxdb=!0,n}return ie(t,e),t.prototype.toString=function(){return this.message},re(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}]),t}(ue(Error));TypeError;function he(e,t){return new fe(e,ce(e),t)}var pe=function(e,t){try{return e.options||(e.options={}),Promise.resolve(kt(e.databaseName,t)).then((function(t){var r=Object.assign({},e.options.collection,{indices:[],unique:["_id"]},At),n=t.database.addCollection(e.collectionName,r);t.collections[e.collectionName]=n;var i=e.collectionName+bt,o=Object.assign({unique:["eventId"],indices:["sequence"]},At),s=t.database.addCollection(i,o);return t.collections[i]=n,{changesCollection:s,collection:n,databaseState:t}}))}catch(e){return Promise.reject(e)}},de=1,ye=function(){function e(e,t,r,n,i,o){var s=this;this.changes$=new X,this.instanceId=de++,this.closed=!1,this.storage=e,this.databaseName=t,this.collectionName=r,this.internals=n,this.options=i,this.databaseSettings=o,Ot.add(this),this.internals.leaderElector&&this.internals.leaderElector.awaitLeadership().then((function(){p(s.internals.leaderElector).broadcastChannel.addEventListener("message",(function(e){try{return Promise.resolve(vt(s,e))}catch(e){return Promise.reject(e)}}))}))}var t=e.prototype;return t.bulkWrite=function(e){try{var t=this;if(0===e.length)throw he("P2",{args:{documentWrites:e}});return Promise.resolve(dt(t)).then((function(r){if(!r)return gt(t,"bulkWrite",[e]);var n=c();return Promise.resolve(l(0)).then((function(){var i={success:{},error:{}},o=new Map,s={id:d(10),events:[]};return e.forEach((function(e){var t=e.document._id;o.set(t,e);var a=y(e.document),u=r.collection.by("_id",t),l=e.previous?e.previous:r.collection.by("_id",t),f=(l?v(l._rev).height+1:1)+"-"+g(e.document);if(a._rev=f,u){if(!e.previous||u._rev!==e.previous._rev){var h={isError:!0,status:409,documentId:t,writeRow:e};return void(i.error[t]=h)}var p=y(a);p.$loki=u.$loki,p.$lastWriteAt=n,r.collection.update(p)}else{var d=y(a);d.$lastWriteAt=n,r.collection.insert(d)}i.success[t]=It(a);var m,b=c();if(e.previous)if(e.document._deleted){var w=y(e.previous);w._rev=f,m={operation:"DELETE",doc:null,id:t,previous:w}}else m={operation:"UPDATE",doc:a,id:t,previous:e.previous};else m={operation:"INSERT",doc:a,id:t,previous:null};if(!e.document._deleted||e.previous&&!e.previous._deleted){var S="DELETE"===m.operation?m.previous:m.doc,I={eventId:Pt(!0,S._id,S._rev?S._rev:""),documentId:t,change:m,startTime:n,endTime:b};s.events.push(I)}else;})),r.databaseState.saveQueue.addWrite(),t.changes$.next(s),i}))}))}catch(e){return Promise.reject(e)}},t.findLocalDocumentsById=function(e){try{var t=this;return Promise.resolve(dt(t)).then((function(r){return r?Promise.resolve(l(0)).then((function(){var t={};return e.forEach((function(e){var n=r.collection.by("_id",e);n&&!n._deleted&&(t[e]=It(n))})),t})):gt(t,"findLocalDocumentsById",[e])}))}catch(e){return Promise.reject(e)}},t.changeStream=function(){return this.changes$.asObservable()},t.close=function(){try{var e=function(){Et(t.storage,t.databaseName)},t=this;t.closed=!0,t.changes$.complete(),Ot.delete(t);var r=function(){if(t.internals.localState)return Promise.resolve(p(t.internals.localState)).then((function(e){return Promise.resolve(mt(t.databaseName,[p(e.collection),p(e.changesCollection)])).then((function(){}))}))}();return Promise.resolve(r&&r.then?r.then(e):e())}catch(e){return Promise.reject(e)}},t.remove=function(){try{var e=this;return Promise.resolve(dt(e)).then((function(t){if(!t)return gt(e,"remove",[]);t.databaseState.database.removeCollection(t.collection.name),t.databaseState.database.removeCollection(t.changesCollection.name),e.close()}))}catch(e){return Promise.reject(e)}},e}(),ve=r(5643),ge=r.n(ve);const me={add:function(e){if("function"==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope);else{if("function"!=typeof window.addEventListener)return;window.addEventListener("beforeunload",(function(){e()}),!0),window.addEventListener("unload",(function(){e()}),!0)}}};var be=r(199),we=r.n(be),Se=ge()?we():me,Ie=new Set,Pe=!1;function Oe(e){if(Pe||(Pe=!0,Se.add(Ae)),"function"!=typeof e)throw new Error("Listener is no function");return Ie.add(e),{remove:function(){return Ie.delete(e)},run:function(){return Ie.delete(e),e()}}}function Ae(){var e=[];return Ie.forEach((function(t){e.push(t()),Ie.delete(t)})),Promise.all(e)}var xe=function(){function e(e,t){this.writesSinceLastRun=0,this.saveQueue=f,this.saveQueueC=0,this.lokiDatabase=e,this.databaseSettings=t}var t=e.prototype;return t.addWrite=function(){this.writesSinceLastRun=this.writesSinceLastRun+1,this.run()},t.run=function(){var e=this;return!this.databaseSettings.adapter||this.saveQueueC>2||(this.saveQueueC=this.saveQueueC+1,this.saveQueue=this.saveQueue.then((function(){try{return Promise.resolve(Promise.all([h(),l(100)])).then((function(){if(0!==e.writesSinceLastRun)return Promise.resolve(Promise.all([h(),l(100)]).then((function(){return h()}))).then((function(){if(0!==e.writesSinceLastRun){var t=e.writesSinceLastRun;return e.writesSinceLastRun=0,new Promise((function(r,n){e.lokiDatabase.saveDatabase((function(i){i?(e.writesSinceLastRun=e.writesSinceLastRun+t,n(i)):(e.databaseSettings.autosaveCallback&&e.databaseSettings.autosaveCallback(),r())}))}))}}))}))}catch(e){return Promise.reject(e)}})).catch((function(){})).then((function(){e.saveQueueC=e.saveQueueC-1}))),this.saveQueue},e}();Promise.resolve(!1);var ke=Promise.resolve(!0),je=Promise.resolve();function _e(e,t){return e||(e=0),new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}function Ee(){return Math.random().toString(36).substring(2)}var Ce=0,De=0;function Me(){var e=(new Date).getTime();return e===Ce?1e3*e+ ++De:(Ce=e,De=0,1e3*e)}var Le="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);const Ne={create:function(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),je}catch(e){return Promise.reject(e)}},canBeUsed:function(){if(Le&&"undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1},type:"native",averageResponseTime:function(){return 150},microSeconds:Me};var Te=function(){function e(e){this.ttl=e,this.set=new Set,this.timeMap=new Map}return e.prototype.has=function(e){return this.set.has(e)},e.prototype.add=function(e){var t=this;this.timeMap.set(e,Be()),this.set.add(e),setTimeout((function(){!function(e){var t=Be()-e.ttl,r=e.set[Symbol.iterator]();for(;;){var n=r.next().value;if(!n)return;if(!(e.timeMap.get(n)<t))return;e.timeMap.delete(n),e.set.delete(n)}}(t)}),0)},e.prototype.clear=function(){this.set.clear(),this.timeMap.clear()},e}();function Be(){return(new Date).getTime()}function $e(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var Fe="messages";function ze(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function Re(e,t){var r=e.transaction(Fe).objectStore(Fe),n=[];return new Promise((function(e){(function(){try{var e=IDBKeyRange.bound(t+1,1/0);return r.openCursor(e)}catch(e){return r.openCursor()}}()).onsuccess=function(r){var i=r.target.result;i?i.value.id<t+1?i.continue(t+1):(n.push(i.value),i.continue()):e(n)}}))}function qe(e,t){return function(e,t){var r=(new Date).getTime()-t,n=e.transaction(Fe).objectStore(Fe),i=[];return new Promise((function(e){n.openCursor().onsuccess=function(t){var n=t.target.result;if(n){var o=n.value;if(!(o.time<r))return void e(i);i.push(o),n.continue()}else e(i)}}))}(e,t).then((function(t){return Promise.all(t.map((function(t){return function(e,t){var r=e.transaction([Fe],"readwrite").objectStore(Fe).delete(t);return new Promise((function(e){r.onsuccess=function(){return e()}}))}(e,t.id)})))}))}function Ue(e){e.closed||We(e).then((function(){return _e(e.options.idb.fallbackInterval)})).then((function(){return Ue(e)}))}function We(e){return e.closed?je:e.messagesCallback?Re(e.db,e.lastCursorId).then((function(t){var r=t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time}));return r.forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),je})):je}const Ve={create:function(e,t){return t=$e(t),function(e){var t="pubkey.broadcast-channel-0-"+e,r=ze().open(t,1);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(Fe,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}(e).then((function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:Ee(),eMIs:new Te(2*t.idb.ttl),writeBlockPromise:je,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},Ue(n),n}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,We(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,r){var n={uuid:t,time:(new Date).getTime(),data:r},i=e.transaction([Fe],"readwrite");return new Promise((function(e,t){i.oncomplete=function(){return e()},i.onerror=function(e){return t(e)},i.objectStore(Fe).add(n)}))}(e.db,e.uuid,t)})).then((function(){var t,r;0===(t=0,r=10,Math.floor(Math.random()*(r-t+1)+t))&&qe(e.db,e.options.idb.ttl)})),e.writeBlockPromise},canBeUsed:function(){return!Le&&!!ze()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:Me};function Je(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function Ke(e){return"pubkey.broadcastChannel-"+e}function Qe(){if(Le)return!1;var e=Je();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}const Ge={create:function(e,t){if(t=$e(t),!Qe())throw new Error("BroadcastChannel: localstorage cannot be used");var r=Ee(),n=new Te(t.localstorage.removeTimeout),i={channelName:e,uuid:r,eMIs:n};return i.listener=function(e,t){var r=Ke(e),n=function(e){e.key===r&&t(JSON.parse(e.newValue))};return window.addEventListener("storage",n),n}(e,(function(e){i.messagesCallback&&e.uuid!==r&&e.token&&!n.has(e.token)&&(e.data.time&&e.data.time<i.messagesCallbackTime||(n.add(e.token),i.messagesCallback(e.data)))})),i},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(r){_e().then((function(){var n=Ke(e.channelName),i={token:Ee(),time:(new Date).getTime(),data:t,uuid:e.uuid},o=JSON.stringify(i);Je().setItem(n,o);var s=document.createEvent("Event");s.initEvent("storage",!0,!0),s.key=n,s.newValue=o,window.dispatchEvent(s),r()}))}))},canBeUsed:Qe,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:Me};var He=Me,Ye=new Set;const Ze={create:function(e){var t={name:e,messagesCallback:null};return Ye.add(t),t},close:function(e){Ye.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(r){return setTimeout((function(){Array.from(Ye).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),r()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:He};var Xe=[Ne,Ve,Ge];var et,tt=new Set,rt=0,nt=function(e,t){var r,n,i;this.id=rt++,tt.add(this),this.name=e,et&&(t=et),this.options=$e(t),this.method=function(e){var t=[].concat(e.methods,Xe).filter(Boolean);if(e.type){if("simulate"===e.type)return Ze;var r=t.find((function(t){return t.type===e.type}));if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||Le||(t=t.filter((function(e){return"idb"!==e.type})));var n=t.find((function(e){return e.canBeUsed()}));if(n)return n;throw new Error("No useable method found in "+JSON.stringify(Xe.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,n=(r=this).method.create(r.name,r.options),(i=n)&&"function"==typeof i.then?(r._prepP=n,n.then((function(e){r._state=e}))):r._state=n};function it(e,t,r){var n={time:e.method.microSeconds(),type:t,data:r};return(e._prepP?e._prepP:je).then((function(){var t=e.method.postMessage(e._state,n);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function ot(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function st(e,t,r){e._addEL[t].push(r),function(e){if(!e._iL&&ot(e)){var t=function(t){e._addEL[t.type].forEach((function(e){var r=1e5,n=e.time-r;t.time>=n&&e.fn(t.data)}))},r=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,r)})):(e._iL=!0,e.method.onMessage(e._state,t,r))}}(e)}function at(e,t,r){e._addEL[t]=e._addEL[t].filter((function(e){return e!==r})),function(e){if(e._iL&&!ot(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}nt._pubkey=!0,nt.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed");return it(this,"message",e)},postInternal:function(e){return it(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};at(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,st(this,"message",t)):this._onML=null},addEventListener:function(e,t){st(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){at(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){tt.delete(this),this.closed=!0;var t=this._prepP?this._prepP:je;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}};var ut=function(e,t){var r=this;this.broadcastChannel=e,this._options=t,this.isLeader=!1,this.hasLeader=!1,this.isDead=!1,this.token=Ee(),this._aplQ=je,this._aplQC=0,this._unl=[],this._lstns=[],this._dpL=function(){},this._dpLC=!1;var n=function(e){"leader"===e.context&&("death"===e.action&&(r.hasLeader=!1),"tell"===e.action&&(r.hasLeader=!0))};this.broadcastChannel.addEventListener("internal",n),this._lstns.push(n)};function ct(e,t){var r={context:"leader",action:t,token:e.token};return e.broadcastChannel.postInternal(r)}function lt(e,t){if(e._leaderElector)throw new Error("BroadcastChannel already has a leader-elector");t=function(e,t){return e||(e={}),(e=JSON.parse(JSON.stringify(e))).fallbackInterval||(e.fallbackInterval=3e3),e.responseTime||(e.responseTime=t.method.averageResponseTime(t.options)),e}(t,e);var r=new ut(e,t);return e._befC.push((function(){return r.die()})),e._leaderElector=r,r}function ft(e,t,r){if(!e.s){if(r instanceof ht){if(!r.s)return void(r.o=ft.bind(null,e,t));1&t&&(t=r.s),r=r.v}if(r&&r.then)return void r.then(ft.bind(null,e,t),ft.bind(null,e,2));e.s=t,e.v=r;var n=e.o;n&&n(e)}}ut.prototype={applyOnce:function(e){var t=this;if(this.isLeader)return _e(0,!0);if(this.isDead)return _e(0,!1);if(this._aplQC>1)return this._aplQ;var r=function(){if(t.isLeader)return ke;var r,n=!1,i=new Promise((function(e){r=function(){n=!0,e()}})),o=[],s=function(e){"leader"===e.context&&e.token!=t.token&&(o.push(e),"apply"===e.action&&e.token>t.token&&r(),"tell"===e.action&&(r(),t.hasLeader=!0))};t.broadcastChannel.addEventListener("internal",s);var a=e?4*t._options.responseTime:t._options.responseTime;return ct(t,"apply").then((function(){return Promise.race([_e(a),i.then((function(){return Promise.reject(new Error)}))])})).then((function(){return ct(t,"apply")})).then((function(){return Promise.race([_e(a),i.then((function(){return Promise.reject(new Error)}))])})).catch((function(){})).then((function(){return t.broadcastChannel.removeEventListener("internal",s),!n&&function(e){e.isLeader=!0,e.hasLeader=!0;var t=Oe((function(){return e.die()}));e._unl.push(t);var r=function(t){"leader"===t.context&&"apply"===t.action&&ct(e,"tell"),"leader"!==t.context||"tell"!==t.action||e._dpLC||(e._dpLC=!0,e._dpL(),ct(e,"tell"))};return e.broadcastChannel.addEventListener("internal",r),e._lstns.push(r),ct(e,"tell")}(t).then((function(){return!0}))}))};return this._aplQC=this._aplQC+1,this._aplQ=this._aplQ.then((function(){return r()})).then((function(){t._aplQC=t._aplQC-1})),this._aplQ.then((function(){return t.isLeader}))},awaitLeadership:function(){return this._aLP||(this._aLP=function(e){if(e.isLeader)return je;return new Promise((function(t){var r=!1;function n(){r||(r=!0,e.broadcastChannel.removeEventListener("internal",i),t(!0))}e.applyOnce().then((function(){e.isLeader&&n()})),function t(){return _e(e._options.fallbackInterval).then((function(){if(!e.isDead&&!r)return e.isLeader?void n():e.applyOnce(!0).then((function(){e.isLeader?n():t()}))}))}();var i=function(t){"leader"===t.context&&"death"===t.action&&(e.hasLeader=!1,e.applyOnce().then((function(){e.isLeader&&n()})))};e.broadcastChannel.addEventListener("internal",i),e._lstns.push(i)}))}(this)),this._aLP},set onduplicate(e){this._dpL=e},die:function(){var e=this;return this._lstns.forEach((function(t){return e.broadcastChannel.removeEventListener("internal",t)})),this._lstns=[],this._unl.forEach((function(e){return e.remove()})),this._unl=[],this.isLeader&&(this.hasLeader=!1,this.isLeader=!1),this.isDead=!0,ct(this,"death")}};var ht=function(){function e(){}return e.prototype.then=function(t,r){var n=new e,i=this.s;if(i){var o=1&i?t:r;if(o){try{ft(n,1,o(this.v))}catch(e){ft(n,2,e)}return n}return this}return this.o=function(e){try{var i=e.v;1&e.s?ft(n,1,t?t(i):i):r?ft(n,1,r(i)):ft(n,2,i)}catch(e){ft(n,2,e)}},n},e}();function pt(e){return e instanceof ht&&1&e.s}var dt=function(e){try{if(e.closed)return Promise.resolve(!1);var t="function"==typeof e.query;if(e.internals.localState)return Promise.resolve(e.internals.localState);var r=p(e.internals.leaderElector);return Promise.resolve(yt(r)).then((function(){return e.internals.localState?e.internals.localState:!(!r.isLeader||e.internals.localState)&&(e.internals.localState=t?Ct({databaseName:e.databaseName,collectionName:e.collectionName,options:e.options,schema:e.schema,multiInstance:!!e.internals.leaderElector},e.databaseSettings):pe({databaseName:e.databaseName,collectionName:e.collectionName,options:e.options,multiInstance:!!e.internals.leaderElector},e.databaseSettings),p(e.internals.localState))}))}catch(e){return Promise.reject(e)}},yt=function(e){try{var t=function(e,t,r){for(var n;;){var i=e();if(pt(i)&&(i=i.v),!i)return o;if(i.then){n=0;break}var o=r();if(o&&o.then){if(!pt(o)){n=1;break}o=o.s}if(t){var s=t();if(s&&s.then&&!pt(s)){n=2;break}}}var a=new ht,u=ft.bind(null,a,2);return(0===n?i.then(l):1===n?o.then(c):s.then(f)).then(void 0,u),a;function c(n){o=n;do{if(t&&(s=t())&&s.then&&!pt(s))return void s.then(f).then(void 0,u);if(!(i=e())||pt(i)&&!i.v)return void ft(a,1,o);if(i.then)return void i.then(l).then(void 0,u);pt(o=r())&&(o=o.v)}while(!o||!o.then);o.then(c).then(void 0,u)}function l(e){e?(o=r())&&o.then?o.then(c).then(void 0,u):c(o):ft(a,1,o)}function f(){(i=e())?i.then?i.then(l).then(void 0,u):l(i):ft(a,1,o)}}((function(){return!e.hasLeader}),void 0,(function(){return Promise.resolve(e.applyOnce()).then((function(){return Promise.resolve(l(0)).then((function(){}))}))}));return Promise.resolve(t&&t.then?t.then((function(){})):void 0)}catch(e){return Promise.reject(e)}},vt=function(e,t){try{var r="function"==typeof e.query?wt:St,n=function(){if(t.type===r&&t.requestId&&t.databaseName===e.databaseName&&t.collectionName===e.collectionName&&!t.response){var n,i=function(){var r={response:!0,requestId:t.requestId,databaseName:e.databaseName,collectionName:e.collectionName,result:n,isError:a,type:t.type};p(e.internals.leaderElector).broadcastChannel.postMessage(r)},o=t.operation,s=t.params,a=!1,u=function(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}((function(){var t;return Promise.resolve((t=e)[o].apply(t,s)).then((function(e){n=e}))}),(function(e){a=!0,n=e}));return u&&u.then?u.then(i):i()}}();return Promise.resolve(n&&n.then?n.then((function(){})):void 0)}catch(e){return Promise.reject(e)}},gt=function(e,t,r){try{var n="function"==typeof e.query?wt:St,i=p(e.internals.leaderElector);return Promise.resolve(yt(i)).then((function(){var o,s,a=i.broadcastChannel,u=new Promise((function(e){o=function(t){"leader"===t.context&&"death"===t.action&&e({retry:!0})},a.addEventListener("internal",o)})),c=d(12),l=new Promise((function(e,t){s=function(t){t.type===n&&!0===t.response&&t.requestId===c&&(t.isError?e({retry:!1,error:t.result}):e({retry:!1,result:t.result}))},a.addEventListener("message",s)}));return a.postMessage({response:!1,type:n,operation:t,params:r,requestId:c,databaseName:e.databaseName,collectionName:e.collectionName}),Promise.race([u,l]).then((function(n){var i;if(a.removeEventListener("message",s),a.removeEventListener("internal",o),n.retry)return(i=e)[t].apply(i,r);if(n.error)throw n.error;return n.result}))}))}catch(e){return Promise.reject(e)}},mt=function(e,t){try{return Promise.resolve(xt.get(e)).then((function(r){if(r)return Promise.resolve(r.saveQueue.run()).then((function(){t.forEach((function(e){var t=e.name;delete r.collections[t]}));var n=function(){if(0===Object.keys(r.collections).length)return xt.delete(e),r.unloads.forEach((function(e){return e.remove()})),Promise.resolve(new Promise((function(e,t){r.database.close((function(r){r?t(r):e()}))}))).then((function(){}))}();if(n&&n.then)return n.then((function(){}))}))}))}catch(e){return Promise.reject(e)}},bt="-rxdb-changes",wt="rxdb-lokijs-remote-request",St="rxdb-lokijs-remote-request-key-object";function It(e){if(!e.$loki)return e;var t=y(e);return delete t.$loki,delete t.$lastWriteAt,t}function Pt(e,t,r){return(e?"local":"non-local")+"|"+t+"|"+r}var Ot=new Set,At={disableChangesApi:!0,disableMeta:!0,disableDeltaChangesApi:!0,disableFreeze:!0,cloneMethod:"shallow-assign",clone:!1,transactional:!1,autoupdate:!1},xt=new Map;function kt(e,t){var r=xt.get(e);if(!r){var i=!!t.adapter;r=function(){try{var r=function(){var e=[];return i&&e.push(Oe((function(){return u.run()}))),{database:a,databaseSettings:s,saveQueue:u,collections:{},unloads:e}},o=i?"adapter":"memory";t.persistenceMethod&&(o=t.persistenceMethod);var s=Object.assign({autoload:i,persistenceMethod:o,verbose:!0},t,{autoload:!1,autosave:!1,throttledSaves:!1}),a=new(n())(e+".db",y(s)),u=new xe(a,s),c=function(){if(i){var e=new Promise((function(e,t){a.loadDatabase({},(function(r){s.autoloadCallback&&s.autoloadCallback(r),r?t(r):e()}))}));return u.saveQueue=u.saveQueue.then((function(){return e})),Promise.resolve(e).then((function(){}))}}();return Promise.resolve(c&&c.then?c.then(r):r())}catch(e){return Promise.reject(e)}}(),xt.set(e,r)}return r}function jt(t,r){var n,i=e(t.primaryKey),o=r.sort?r.sort:[(n={},n[i]="asc",n)];return function(e,t){var n=0;if(o.find((function(r){var i=Object.keys(r)[0],o="asc"===Object.values(r)[0]?1:-1,s=e[i],a=t[i];return s!==a&&(s>a?(n=1*o,!0):(n=-1*o,!0))})),!n)throw he("SNH",{args:{query:r,a:e,b:t}});return n}}function _t(e,t){var r=e.leaderElectorByLokiDbName.get(t);r?r.intancesCount=r.intancesCount+1:(r={leaderElector:lt(new nt("rxdb-lokijs-"+t)),intancesCount:1},e.leaderElectorByLokiDbName.set(t,r));return r.leaderElector}function Et(e,t){var r=e.leaderElectorByLokiDbName.get(t);r&&(r.intancesCount=r.intancesCount-1,0===r.intancesCount&&(r.leaderElector.broadcastChannel.close(),e.leaderElectorByLokiDbName.delete(t)))}var Ct=function(t,r){try{return t.options||(t.options={}),Promise.resolve(kt(t.databaseName,r)).then((function(r){var n=[];t.schema.indexes&&t.schema.indexes.forEach((function(e){var t;t=e,Array.isArray(t)||n.push(e)}));var i=e(t.schema.primaryKey);n.push(i);var o=Object.assign({},t.options.collection,{indices:n,unique:[i]},At),s=r.database.addCollection(t.collectionName,o);r.collections[t.collectionName]=s;var a=t.collectionName+bt,u=Object.assign({unique:["eventId"],indices:["sequence"]},At),c=r.database.addCollection(a,u);return r.collections[t.collectionName]=c,{databaseState:r,collection:s,changesCollection:c}}))}catch(e){return Promise.reject(e)}},Dt=c(),Mt=function(){function t(t,r,n,i,o,s,a){var u=this;this.changes$=new X,this.lastChangefeedSequence=0,this.instanceId=Dt++,this.closed=!1,this.storage=t,this.databaseName=r,this.collectionName=n,this.schema=i,this.internals=o,this.options=s,this.databaseSettings=a,this.primaryPath=e(this.schema.primaryKey),Ot.add(this),this.internals.leaderElector&&this.internals.leaderElector.awaitLeadership().then((function(){p(u.internals.leaderElector).broadcastChannel.addEventListener("message",(function(e){try{return Promise.resolve(vt(u,e))}catch(e){return Promise.reject(e)}}))}))}var r=t.prototype;return r.addChangeDocumentMeta=function(e){try{var t=this;return Promise.resolve(p(t.internals.localState)).then((function(r){if(!t.lastChangefeedSequence){var n=r.changesCollection.chain().simplesort("sequence",!0).limit(1).data()[0];n&&(t.lastChangefeedSequence=n.sequence)}var i=t.lastChangefeedSequence+1;r.changesCollection.insert({id:e,sequence:i}),t.lastChangefeedSequence=i}))}catch(e){return Promise.reject(e)}},r.bulkWrite=function(e){try{var t=this;if(0===e.length)throw he("P2",{args:{documentWrites:e}});return Promise.resolve(dt(t)).then((function(r){return r?Promise.resolve(l(0)).then((function(){var n={success:{},error:{}},i={id:d(10),events:[]};return e.forEach((function(e){var o=c(),s=e.document[t.primaryPath],a=r.collection.by(t.primaryPath,s);if(a){var u=a._rev;if(!e.previous&&a._deleted&&(e.previous=a),!e.previous&&!a._deleted||e.previous&&u!==e.previous._rev){var l={isError:!0,status:409,documentId:s,writeRow:e};n.error[s]=l}else{var f=v(u).height+1+"-"+g(e.document),h=!!e.document._deleted,p=Object.assign({},e.document,{$loki:a.$loki,$lastWriteAt:o,_rev:f,_deleted:h,_attachments:{}});r.collection.update(p),t.addChangeDocumentMeta(s);var d=null;if(e.previous&&e.previous._deleted&&!p._deleted)d={id:s,operation:"INSERT",previous:null,doc:It(p)};else if(!e.previous||e.previous._deleted||p._deleted){if(e.previous&&!e.previous._deleted&&p._deleted){var m=y(e.previous);m._rev=f,d={id:s,operation:"DELETE",previous:m,doc:null}}}else d={id:s,operation:"UPDATE",previous:e.previous,doc:It(p)};if(!d)throw he("SNH",{args:{writeRow:e}});i.events.push({eventId:Pt(!1,s,f),documentId:s,change:d,startTime:o,endTime:c()}),n.success[s]=It(p)}}else{var b="1-"+g(e.document),w=!!e.document._deleted,S=Object.assign({},e.document,{_rev:b,_deleted:w,_attachments:{}}),I=y(S);I.$lastWriteAt=o,r.collection.insert(I),w||(t.addChangeDocumentMeta(s),i.events.push({eventId:Pt(!1,s,b),documentId:s,change:{doc:S,id:s,operation:"INSERT",previous:null},startTime:o,endTime:c()})),n.success[s]=S}})),r.databaseState.saveQueue.addWrite(),t.changes$.next(i),n})):gt(t,"bulkWrite",[e])}))}catch(e){return Promise.reject(e)}},r.bulkAddRevisions=function(e){try{var t=this;if(0===e.length)throw he("P3",{args:{documents:e}});return Promise.resolve(dt(t)).then((function(r){return r?Promise.resolve(l(0)).then((function(){var n={id:d(10),events:[]};e.forEach((function(e){var i=c(),o=e[t.primaryPath],s=r.collection.by(t.primaryPath,o);if(s){var a=v(e._rev),u=v(s._rev),l=!1;if(a.height!==u.height?a.height>u.height&&(l=!0):a.hash>u.hash&&(l=!0),l){var f=y(e);f.$loki=s.$loki,f.$lastWriteAt=i,r.collection.update(f);var h=null;s._deleted&&!e._deleted?h={id:o,operation:"INSERT",previous:null,doc:e}:s._deleted||e._deleted?!s._deleted&&e._deleted?h={id:o,operation:"DELETE",previous:It(s),doc:null}:s._deleted&&e._deleted&&(h=null):h={id:o,operation:"UPDATE",previous:It(s),doc:e},h&&(n.events.push({documentId:o,eventId:Pt(!1,o,e._rev),change:h,startTime:i,endTime:c()}),t.addChangeDocumentMeta(o))}}else{var p=y(e);p.$lastWriteAt=i,r.collection.insert(p),n.events.push({documentId:o,eventId:Pt(!1,o,e._rev),change:{doc:e,id:o,operation:"INSERT",previous:null},startTime:i,endTime:c()}),t.addChangeDocumentMeta(o)}})),r.databaseState.saveQueue.addWrite(),t.changes$.next(n)})):gt(t,"bulkAddRevisions",[e])}))}catch(e){return Promise.reject(e)}},r.findDocumentsById=function(e,t){try{var r=this;return Promise.resolve(dt(r)).then((function(n){if(!n)return gt(r,"findDocumentsById",[e,t]);var i={};return e.forEach((function(e){var o=n.collection.by(r.primaryPath,e);!o||o._deleted&&!t||(i[e]=It(o))})),i}))}catch(e){return Promise.reject(e)}},r.query=function(e){try{var t=this;return Promise.resolve(dt(t)).then((function(r){if(!r)return gt(t,"query",[e]);var n=r.collection.chain().find(e.selector);return e.sort&&(n=n.sort(jt(t.schema,e))),e.skip&&(n=n.offset(e.skip)),e.limit&&(n=n.limit(e.limit)),{documents:n.data().map((function(e){return It(e)}))}}))}catch(e){return Promise.reject(e)}},r.getAttachmentData=function(e,t){throw new Error("Attachments are not implemented in the lokijs RxStorage. Make a pull request.")},r.getChangedDocuments=function(e){try{var t=this;return Promise.resolve(dt(t)).then((function(r){var n;if(!r)return gt(t,"getChangedDocuments",[e]);var i="before"===e.direction,o="after"===e.direction?"$gt":"$lt",s=r.changesCollection.chain().find({sequence:(n={},n[o]=e.sinceSequence,n)}).simplesort("sequence",i);e.limit&&(s=s.limit(e.limit));var a,u=s.data().map((function(e){return{id:e.id,sequence:e.sequence}})),c=i?u[0]:(a=u)[a.length-1];return{changedDocuments:u,lastSequence:c?c.sequence:e.sinceSequence}}))}catch(e){return Promise.reject(e)}},r.changeStream=function(){return this.changes$.asObservable()},r.close=function(){try{var e=function(){Et(t.storage,t.databaseName)},t=this;t.closed=!0,t.changes$.complete(),Ot.delete(t);var r=function(){if(t.internals.localState)return Promise.resolve(t.internals.localState).then((function(e){return Promise.resolve(kt(t.databaseName,t.databaseSettings)).then((function(r){return Promise.resolve(r.saveQueue.run()).then((function(){return Promise.resolve(mt(t.databaseName,[e.collection,e.changesCollection])).then((function(){}))}))}))}))}();return Promise.resolve(r&&r.then?r.then(e):e())}catch(e){return Promise.reject(e)}},r.remove=function(){try{var e=this;return Promise.resolve(dt(e)).then((function(t){if(!t)return gt(e,"remove",[]);t.databaseState.database.removeCollection(e.collectionName),t.databaseState.database.removeCollection(t.changesCollection.name),e.close()}))}catch(e){return Promise.reject(e)}},t}(),Lt=function(e){return btoa(e)};var Nt=r(1368),Tt=r.n(Nt),Bt=self.setImmediate||self.setTimeout;function $t(e,t,r,n,i){(r>0||n<t.size)&&(t=function(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.slice(t,r)}(t,r,n)),function(e,t){var r=new FileReader;r.onloadend=function(e){var r=e.target.result||new ArrayBuffer(0);t(r)},r.readAsArrayBuffer(e)}(t,(function(t){e.append(t),i()}))}function Ft(e,t,r,n,i){(r>0||n<t.length)&&(t=t.substring(r,n)),e.appendBinary(t),i()}function zt(e,t){var r="string"==typeof e,n=r?e.length:e.size,i=Math.min(32768,n),o=Math.ceil(n/i),s=0,a=r?new(Tt()):new(Tt().ArrayBuffer),u=r?Ft:$t;function c(){Bt(f)}function l(){var e=function(e){return Lt(e)}(a.end(!0));t(e),a.destroy()}function f(){var t=s*i,r=t+i;s++,u(a,e,t,r,s<o?c:l)}f()}var Rt={hash:function(e){return new Promise((function(t){zt(e,(function(e){t(e)}))}))},hashKey:"md5",prepareQuery:function(t,r){var n,i,o=e(t.primaryKey);(Object.keys(r.selector).length>0?r.selector={$and:[{_deleted:!1},r.selector]}:r.selector={_deleted:!1},r.sort)?r.sort.find((function(e){return t=e,Object.keys(t)[0]===o;var t}))||r.sort.push(((n={})[o]="asc",n)):r.sort=[(i={},i[o]="asc",i)];return r},getSortComparator:function(e,t){return jt(e,t)},getQueryMatcher:function(e,t){return function(e){var r=y(e);r._deleted=!!r._deleted;var i={data:[r],binaryIndices:{}};Object.setPrototypeOf(i,n().Collection.prototype);var o={collection:i};return Object.setPrototypeOf(o,n().Resultset.prototype),o.find(t.selector,!0),o.filteredrows.length>0}}},qt=function(){function e(e){this.name="lokijs",this.statics=Rt,this.leaderElectorByLokiDbName=new Map,this.databaseSettings=e}var t=e.prototype;return t.createStorageInstance=function(e){return function(e,t,r){try{var n=function(){var n=new Mt(e,t.databaseName,t.collectionName,t.schema,i,t.options,r);return t.multiInstance&&p(i.leaderElector).awaitLeadership().then((function(){return dt(n)})),n},i={},o=function(){if(!t.multiInstance)return i.localState=Ct(t,r),Promise.resolve(i.localState).then((function(){}));var n=_t(e,t.databaseName);i.leaderElector=n}();return Promise.resolve(o&&o.then?o.then(n):n())}catch(e){return Promise.reject(e)}}(this,e,this.databaseSettings)},t.createKeyObjectStorageInstance=function(e){return y(e).collectionName=e.collectionName+"-key-object",function(e,t,r){try{var n=function(){var n=new ye(e,t.databaseName,t.collectionName,i,t.options,r);return t.multiInstance&&p(i.leaderElector).awaitLeadership().then((function(){return dt(n)})),n},i={},o=function(){if(!t.multiInstance)return i.localState=pe(t,r),Promise.resolve(i.localState).then((function(){}));var n=_t(e,t.databaseName);i.leaderElector=n}();return Promise.resolve(o&&o.then?o.then(n):n())}catch(e){return Promise.reject(e)}}(this,e,this.databaseSettings)},e}();var Ut=r(1934);const Wt=Ut.expose;Ut.registerSerializer,Ut.Transfer;var Vt,Jt,Kt,Qt,Gt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new qt(e);return t}({adapter:new(r(6194))});Vt={storage:Gt},Jt=0,Kt=new Map,Qt={createStorageInstance:function(e){try{var t=Jt++;return Promise.resolve(Vt.storage.createStorageInstance(e)).then((function(e){return Kt.set(t,e),t}))}catch(e){return Promise.reject(e)}},bulkWrite:function(e,t){return m(Kt,e).bulkWrite(t)},bulkAddRevisions:function(e,t){return m(Kt,e).bulkAddRevisions(t)},findDocumentsById:function(e,t,r){return m(Kt,e).findDocumentsById(t,r)},query:function(e,t){return m(Kt,e).query(t)},getAttachmentData:function(e,t,r){return m(Kt,e).getAttachmentData(t,r)},getChangedDocuments:function(e,t){return m(Kt,e).getChangedDocuments(t)},changeStream:function(e){return m(Kt,e).changeStream()},close:function(e){return m(Kt,e).close()},remove:function(e){return m(Kt,e).remove()},createKeyObjectStorageInstance:function(e){try{var t=Jt++;return Promise.resolve(Vt.storage.createKeyObjectStorageInstance(e)).then((function(e){return Kt.set(t,e),t}))}catch(e){return Promise.reject(e)}},bulkWriteLocal:function(e,t){return m(Kt,e).bulkWrite(t)},findLocalDocumentsById:function(e,t){return m(Kt,e).findLocalDocumentsById(t)}},Wt(Qt)})()})();
//# sourceMappingURL=lokijs-fs.worker.js.map