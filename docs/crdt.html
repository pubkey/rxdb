<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-crdt" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">CRDT - Conflict-free replicated data type Database | RxDB - JavaScript Database</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" name="twitter:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" property="og:url" content="https://rxdb.info/crdt.html"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CRDT - Conflict-free replicated data type Database | RxDB - JavaScript Database"><meta data-rh="true" name="description" content="Learn how RxDB&#x27;s CRDT Plugin resolves document conflicts automatically in distributed systems, ensuring seamless merges and consistent data."><meta data-rh="true" property="og:description" content="Learn how RxDB&#x27;s CRDT Plugin resolves document conflicts automatically in distributed systems, ensuring seamless merges and consistent data."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rxdb.info/crdt.html"><link data-rh="true" rel="alternate" href="https://rxdb.info/crdt.html" hreflang="en"><link data-rh="true" rel="alternate" href="https://rxdb.info/crdt.html" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-62D63SY3S0"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-62D63SY3S0",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-PL63TR5",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<meta name="theme-color" content="#ed168f">
<link rel="icon" type="image/svg+xml" href="/files/logo/logo.svg">
<link rel="apple-touch-icon" href="/img/apple-touch-icon.png" sizes="180x180">
<link rel="preconnect" href="https://consentcdn.cookiebot.com/">
<link rel="preconnect" href="https://consent.cookiebot.com/">
<link rel="preconnect" href="https://region1.analytics.google.com/">
<link rel="preconnect" href="https://www.redditstatic.com/">
<link rel="preconnect" href="https://pixel-config.reddit.com/"><link rel="stylesheet" href="/assets/css/styles.5d19d235.css">
<script src="/assets/js/runtime~main.77bed412.js" defer="defer"></script>
<script src="/assets/js/main.65bd90ab.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PL63TR5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","dark"),document.documentElement.setAttribute("data-theme-choice","dark"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/files/logo/logo_text_white.svg"><link rel="preload" as="image" href="./files/document-replication-conflict.svg"><link rel="preload" as="image" href="./files/crdt-conflict-free-replicated-data-type.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/files/logo/logo_text_white.svg" alt="RxDB" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/files/logo/logo_text_white.svg" alt="RxDB" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/overview.html">Docs</a><div class="dropdown-wrapper"><a class="navbar__item navbar__link" dropdown="sync" href="/replication.html">Sync</a></div><div class="dropdown-wrapper"><a class="navbar__item navbar__link" dropdown="storages" href="/rx-storage.html">Storages</a></div><a class="navbar__item navbar__link" href="/premium/">Premium</a><a class="navbar__item navbar__link" href="/consulting/">Support</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="/chat/" class="navbar__item navbar__link navbar-icon navbar__item navbar-icon-discord" target="_blank"> </a><a href="/code/" class="navbar__item navbar__link navbar-icon navbar__item navbar-icon-github" target="_blank"> </a><div class="navbarSearchContainer_dCNk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" aria-label="Search" class="navbar__search-input search-bar" style="margin-left:auto;margin-right:auto;display:block"></div></div></div></div><div class="navbar-line" style="position:fixed;left:0;z-index:10;height:2px;width:100vw;background-color:var(--color-top);border-top-right-radius:2px;border-bottom-right-radius:2px;transform-origin:left center;will-change:transform;backface-visibility:hidden;contain:layout;transform:scaleX(0)"></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP"><div style="padding:10px;padding-top:30px;margin-left:auto;margin-right:auto"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" aria-label="Search" class="navbar__search-input search-bar" style="margin-left:auto;margin-right:auto;display:block"></div></div><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/overview.html"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/overview.html"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quickstart.html"><span title="ðŸš€ Quickstart" class="linkLabel_WmDU">ðŸš€ Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/install.html"><span title="Installation" class="linkLabel_WmDU">Installation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-mode.html"><span title="Development Mode" class="linkLabel_WmDU">Development Mode</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/typescript.html"><span title="TypeScript Setup" class="linkLabel_WmDU">TypeScript Setup</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-database.html"><span title="Core Entities" class="categoryLinkLabel_W154">Core Entities</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-storage.html"><span title="ðŸ’¾ Storages" class="categoryLinkLabel_W154">ðŸ’¾ Storages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/schema-validation.html"><span title="Storage Wrappers" class="categoryLinkLabel_W154">Storage Wrappers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/replication.html"><span title="ðŸ”„ Replication" class="categoryLinkLabel_W154">ðŸ”„ Replication</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-server.html"><span title="Server" class="categoryLinkLabel_W154">Server</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/transactions-conflicts-revisions.html"><span title="How RxDB works" class="categoryLinkLabel_W154">How RxDB works</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/migration-schema.html"><span title="Advanced Features" class="categoryLinkLabel_W154">Advanced Features</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/migration-schema.html"><span title="Migration" class="categoryLinkLabel_W154">Migration</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rx-attachment.html"><span title="Attachments" class="linkLabel_WmDU">Attachments</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rx-pipeline.html"><span title="RxPipelines" class="linkLabel_WmDU">RxPipelines</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reactivity.html"><span title="Custom Reactivity" class="linkLabel_WmDU">Custom Reactivity</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rx-state.html"><span title="RxState" class="linkLabel_WmDU">RxState</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/rx-local-document.html"><span title="Local Documents" class="linkLabel_WmDU">Local Documents</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cleanup.html"><span title="Cleanup" class="linkLabel_WmDU">Cleanup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/backup.html"><span title="Backup" class="linkLabel_WmDU">Backup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/leader-election.html"><span title="Leader Election" class="linkLabel_WmDU">Leader Election</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/middleware.html"><span title="Middleware" class="linkLabel_WmDU">Middleware</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/crdt.html"><span title="CRDT" class="linkLabel_WmDU">CRDT</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/population.html"><span title="Population" class="linkLabel_WmDU">Population</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/orm.html"><span title="ORM" class="linkLabel_WmDU">ORM</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/fulltext-search.html"><span title="Fulltext Search ðŸ‘‘" class="linkLabel_WmDU">Fulltext Search ðŸ‘‘</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/articles/javascript-vector-database.html"><span title="Vector Database" class="linkLabel_WmDU">Vector Database</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/query-optimizer.html"><span title="Query Optimizer ðŸ‘‘" class="linkLabel_WmDU">Query Optimizer ðŸ‘‘</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/third-party-plugins.html"><span title="Third Party Plugins" class="linkLabel_WmDU">Third Party Plugins</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-storage-performance.html"><span title="Performance" class="categoryLinkLabel_W154">Performance</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/releases/16.0.0.html"><span title="Releases" class="categoryLinkLabel_W154">Releases</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/articles/browser-database.html"><span title="Articles" class="categoryLinkLabel_W154">Articles</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contribution.html"><span title="Contribute" class="linkLabel_WmDU">Contribute</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/consulting/"><span title="Contact" class="categoryLinkLabel_W154">Contact</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>RxDB CRDT Plugin</h1></header>
<p>Whenever there are multiple instances in a distributed system, data writes can cause conflicts. Two different clients could do a write to the same document at the same time or while they are both offline. When the clients replicate the document state with the server, a conflict emerges that must be resolved by the system.</p>
<p>In <a class="" href="/">RxDB</a>, conflicts are normally resolved by setting a <code>conflictHandler</code> when creating a collection. The conflict handler is a JavaScript function that gets the two conflicting states of the same document and it will return the resolved document state.
The <a class="" href="/replication.html#conflict-handling">default conflict handler</a> will always drop the fork state and use the master state to ensure that clients that have been offline for a long time, do not overwrite other clients changes when they go online again.</p>
<p align="center"><img src="./files/document-replication-conflict.svg" alt="document replication conflict" width="250"></p>
<p>With CRDTs (short for <a href="https://en.wikipedia.org/wiki/Conflict-free_replicated_data_type" target="_blank" rel="noopener noreferrer" class="">Conflict-free replicated data type</a>), all document
writes are represented as CRDT operations in plain JSON. The CRDT operations are stored together with the document and each time a conflict arises, the CRDT conflict handler will automatically merge the operations in a deterministic way. Using CRDTs is an easy way to &quot;magically&quot; handle all conflict problems in your application by storing the deltas of writes together with the document data.</p>
<p align="center"><img src="./files/crdt-conflict-free-replicated-data-type.svg" alt="CRDT Conflict-free replicated data type" width="300"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="rxdb-crdt-operations">RxDB CRDT operations<a href="#rxdb-crdt-operations" class="hash-link" aria-label="Direct link to RxDB CRDT operations" title="Direct link to RxDB CRDT operations" translate="no">â€‹</a></h2>
<p>In RxDB, a CRDT operation is defined with NoSQL update operators, like you might know them from <a href="https://www.mongodb.com/docs/manual/reference/operator/update/" target="_blank" rel="noopener noreferrer" class="">MongoDB update operations</a> or the <a class="" href="/rx-document.html#update">RxDB update plugin</a>.
To run the operators, RxDB uses the <a href="https://github.com/kofrasa/mingo#updating-documents" target="_blank" rel="noopener noreferrer" class="">mingo library</a>.</p>
<p>A CRDT operator example:</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="js" data-theme="css-variables"><code data-language="js" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> myCRDTOperation</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">    // increment the points field by +1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    $inc</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        points</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">    // set the modified field to true</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    $set</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        modified</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> true</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">};</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="operators">Operators<a href="#operators" class="hash-link" aria-label="Direct link to Operators" title="Direct link to Operators" translate="no">â€‹</a></h3>
<p>At the moment, not all possible operators are implemented in <a href="https://github.com/kofrasa/mingo#updating-documents" target="_blank" rel="noopener noreferrer" class="">mingo</a>, if you need additional ones, you should make a pull request there.</p>
<p>The following operators can be used at this point in time:</p>
<ul>
<li class=""><code>$min</code></li>
<li class=""><code>$max</code></li>
<li class=""><code>$inc</code></li>
<li class=""><code>$set</code></li>
<li class=""><code>$unset</code></li>
<li class=""><code>$push</code></li>
<li class=""><code>$addToSet</code></li>
<li class=""><code>$pop</code></li>
<li class=""><code>$pullAll</code></li>
<li class=""><code>$rename</code></li>
</ul>
<p>For the exact definition on how each operator behaves, check out the <a href="https://www.mongodb.com/docs/manual/reference/operator/update/" target="_blank" rel="noopener noreferrer" class="">MongoDB documentation on update operators</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation" translate="no">â€‹</a></h2>
<p>To use CRDTs with RxDB, you need the following:</p>
<ul>
<li class="">Add the CRDT plugin via <code>addRxPlugin</code>.</li>
<li class="">Add a field to your schema that defines where to store the CRDT operations via <code>getCRDTSchemaPart()</code></li>
<li class="">Set the <code>crdt</code> options in your schema.</li>
<li class="">Do <strong>NOT</strong> set a custom conflict handler, the plugin will use its own one.</li>
</ul>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-comment)">// import the relevant parts from the CRDT plugin</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    getCRDTSchemaPart</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    RxDBcrdtPlugin</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">} </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb/plugins/crdt&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// add the CRDT plugin to RxDB</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { addRxPlugin } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">addRxPlugin</span><span style="color:var(--shiki-foreground)">(RxDBcrdtPlugin);</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// create a database</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { createRxDatabase } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { getRxStorageLocalstorage } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb/plugins/storage-localstorage&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> myDatabase</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-token-keyword)"> await</span><span style="color:var(--shiki-token-function)"> createRxDatabase</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">  name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;heroesdb&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">  storage</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-function)"> getRxStorageLocalstorage</span><span style="color:var(--shiki-foreground)">()</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// create a schema with the CRDT options</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> mySchema</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    version</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 0</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    primaryKey</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;id&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    type</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;object&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    properties</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            type</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;string&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            maxLength</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 100</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        points</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            type</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;number&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            maximum</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 100</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            minimum</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 0</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        crdts</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-function)"> getCRDTSchemaPart</span><span style="color:var(--shiki-foreground)">() </span><span style="color:var(--shiki-token-comment)">// use this field to store the CRDT operations</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    required</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> [</span><span style="color:var(--shiki-token-string-expression)">&#x27;id&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-string-expression)"> &#x27;points&#x27;</span><span style="color:var(--shiki-foreground)">]</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    crdt</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">// CRDT options</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        field</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;crdts&#x27;</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// add a collection</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> db</span><span style="color:var(--shiki-token-function)">.addCollections</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    users</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        schema</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> mySchema</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// insert a document</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> myDocument</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-token-keyword)"> await</span><span style="color:var(--shiki-token-constant)"> db</span><span style="color:var(--shiki-token-function)">.</span><span style="color:var(--shiki-token-constant)">users</span><span style="color:var(--shiki-token-function)">.insert</span><span style="color:var(--shiki-foreground)">({id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;alice&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-foreground)"> points</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 0</span><span style="color:var(--shiki-foreground)">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// run a CRDT operation that increments the &#x27;points&#x27; by one</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> myDocument</span><span style="color:var(--shiki-token-function)">.updateCRDT</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $inc</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            points</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="conditional-crdt-operations">Conditional CRDT operations<a href="#conditional-crdt-operations" class="hash-link" aria-label="Direct link to Conditional CRDT operations" title="Direct link to Conditional CRDT operations" translate="no">â€‹</a></h2>
<p>By default, all CRDTs operations will be run to build the current document state. But in many cases, more granular operations are required to better reflect the desired business logic. For these cases, conditional CRDTs can be used.</p>
<p>For example if you have a field <code>points</code> with a <code>maximum</code> of <code>100</code>, you might want to only run the <code>$inc</code> operation, if the <code>points</code> value is less than <code>100</code>.
In an conditional CRDT, you can specify a <code>selector</code> and the operation sets <code>ifMatch</code> and <code>ifNotMatch</code>. At each time the CRDT is applied to the document state, first the selector will run and evaluate which operations path must be used.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> myDocument</span><span style="color:var(--shiki-token-function)">.updateCRDT</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">    // only if the selector matches, the ifMatch operation will run</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        age</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            $lt</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 100</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">    // an operation that runs if the selector matches</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $inc</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            points</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">    // if the selector does NOT match, you could run a different operation instead</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifNotMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">        // ...</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="running-multiples-operations-at-once">Running multiples operations at once<a href="#running-multiples-operations-at-once" class="hash-link" aria-label="Direct link to Running multiples operations at once" title="Direct link to Running multiples operations at once" translate="no">â€‹</a></h2>
<p>By default, one CRDT operation is applied to the document in a single database write.
To represent more complex logic chains, it might make sense to use multiple CRDTs and write them at once inside of a single atomic document write.</p>
<p>For these cases, the <code>updateCRDT()</code> method allows to pass an array of operations.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> myDocument</span><span style="color:var(--shiki-token-function)">.updateCRDT</span><span style="color:var(--shiki-foreground)">([</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { </span><span style="color:var(--shiki-token-comment)">/** ... **/</span><span style="color:var(--shiki-foreground)"> }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">]);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="crdts-on-inserts">CRDTs on inserts<a href="#crdts-on-inserts" class="hash-link" aria-label="Direct link to CRDTs on inserts" title="Direct link to CRDTs on inserts" translate="no">â€‹</a></h2>
<p>When CRDTs are enabled with the plugin, all insert operations are automatically mapped as CRDT operation with the <code>$set</code> operator.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-comment)">// Calling RxCollection.insert()</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> myRxCollection</span><span style="color:var(--shiki-token-function)">.insert</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;foo&#x27;</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    points: </span><span style="color:var(--shiki-token-constant)">1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// is exactly equal to calling insertCRDT()</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> myRxCollection</span><span style="color:var(--shiki-token-function)">.insertCRDT</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $set</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;foo&#x27;</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            points: </span><span style="color:var(--shiki-token-constant)">1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<p>When the same document is inserted in multiple client instances and then replicated, a conflict will emerge and the insert-CRDTs will overwrite each other in a deterministic order.
You can use <code>insertCRDT()</code> to make conditional insert operations with any logic. To check for the previous existence of a document, use the <code>$exists</code> query operation on the primary key of the document.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> myRxCollection</span><span style="color:var(--shiki-token-function)">.insertCRDT</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">        // only run if the document did not exist before.</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> { $exists</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> false</span><span style="color:var(--shiki-foreground)"> }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-foreground)"> </span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">        // if the document did not exist, insert it</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $set</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            id</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;foo&#x27;</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            points: </span><span style="color:var(--shiki-token-constant)">1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifNotMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">        // if document existed already, increment the points by +1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $inc</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            points</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 1</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="deleting-documents">Deleting documents<a href="#deleting-documents" class="hash-link" aria-label="Direct link to Deleting documents" title="Direct link to Deleting documents" translate="no">â€‹</a></h2>
<p>You can delete a document with a CRDT operation by setting <code>_deleted</code> to true. Calling <code>RxDocument.remove()</code> will do exactly the same when CRDTs are activated.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> doc</span><span style="color:var(--shiki-token-function)">.updateCRDT</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ifMatch</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $set</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            _deleted</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> true</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:var(--shiki-token-comment)">// OR</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> doc</span><span style="color:var(--shiki-token-function)">.remove</span><span style="color:var(--shiki-foreground)">();</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="crdts-with-replication">CRDTs with replication<a href="#crdts-with-replication" class="hash-link" aria-label="Direct link to CRDTs with replication" title="Direct link to CRDTs with replication" translate="no">â€‹</a></h2>
<p>CRDT operations are stored inside of a special field besides your &#x27;normal&#x27; document fields.
When replicating document data with the <a class="" href="/replication.html">RxDB replication</a> or the <a class="" href="/replication-couchdb.html">CouchDB replication</a> or even any custom replication, the CRDT operations must be replicated together with the document data as if they would be &#x27;normal&#x27; a document property.</p>
<p>When any instances makes a write to the document, it is required to update the CRDT operations accordingly. For example if your custom backend updates a document, it must also do that by adding a CRDT operation. In <a class="" href="/dev-mode.html">dev-mode</a> RxDB will refuse to store any document data where the document properties do not match the result of the CRDT operations.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-not-automergejs-or-yjs">Why not automerge.js or yjs?<a href="#why-not-automergejs-or-yjs" class="hash-link" aria-label="Direct link to Why not automerge.js or yjs?" title="Direct link to Why not automerge.js or yjs?" translate="no">â€‹</a></h2>
<p>There are already CRDT libraries out there that have been considered to be used with RxDB. The biggest ones are <a href="https://github.com/automerge/automerge" target="_blank" rel="noopener noreferrer" class="">automerge</a> and <a href="https://github.com/yjs/yjs" target="_blank" rel="noopener noreferrer" class="">yjs</a>. The decision was made to not use these but instead go for a more NoSQL way of designing the CRDT format because:</p>
<ul>
<li class="">Users do not have to learn a new syntax but instead can use the NoSQL query operations which they already know to manipulate the JSON data of a document.</li>
<li class="">RxDB is often used to <a class="" href="/replication.html">replicate</a> data with any custom backend on an already existing infrastructure. Using NoSQL operators instead of binary data in CRDTs, makes it easy to implement the exact same logic on these backends so that the backend can also do document writes and still be compliant to the RxDB CRDT plugin.</li>
</ul>
<p>So instead of using YJS or Automerge with a database, you can use RxDB with the CRDT plugin to have a more database specific CRDT approach. This gives you additional features for free such as <a class="" href="/schema-validation.html">schema validation</a> or <a class="" href="/migration-schema.html">data migration</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="when-to-not-use-crdts">When to not use CRDTs<a href="#when-to-not-use-crdts" class="hash-link" aria-label="Direct link to When to not use CRDTs" title="Direct link to When to not use CRDTs" translate="no">â€‹</a></h2>
<p>CRDT can only be use when your business logic allows to represent document changes via static json operators.
If you can have cases where user interaction is required to correctly merge conflicting document states, you cannot use CRDTs for that.</p>
<p>Also when CRDTs are used, it is no longer allowed to do non-CRDT writes to the document properties.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="crdt-alternative">CRDT Alternative<a href="#crdt-alternative" class="hash-link" aria-label="Direct link to CRDT Alternative" title="Direct link to CRDT Alternative" translate="no">â€‹</a></h2>
<p>While the CRDT plugin can automatically merge concurrent document updates, it is not the only way to resolve conflicts in RxDB.
An alternative approach to CRDT is to use RxDB&#x27;s built-in <a class="" href="/transactions-conflicts-revisions.html">conflict handling system</a>.</p>
<blockquote>
<p>Why use conflict handlers instead of CRDT?</p>
</blockquote>
<p>Conflict handlers offer a <strong>simpler and more flexible</strong> way to manage data conflicts. Instead of encoding changes as CRDT operations, you define how RxDB should decide which document version &quot;wins&quot; with plain JavaScript code. This approach is easier to reason about because it works directly with your domain logic. For example, you can compare timestamps, prioritize certain fields, or even involve user interaction to resolve conflicts.</p>
<p>Conflict handlers are:</p>
<ul>
<li class=""><strong>Easier to understand</strong>: you work with plain document states instead of CRDT operations.</li>
<li class=""><strong>Fully customizable</strong>: you can define any merge strategy, from simple last-write-wins to complex rule-based logic.</li>
<li class=""><strong>Compatible with all data types</strong>: unlike CRDTs, which are best suited for numeric or set-based updates.</li>
<li class=""><strong>Transparent</strong>: you always know which state is being written and why.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="downsides-of-crdts">Downsides of CRDTs<a href="#downsides-of-crdts" class="hash-link" aria-label="Direct link to Downsides of CRDTs" title="Direct link to Downsides of CRDTs" translate="no">â€‹</a></h3>
<p>CRDTs are powerful for automatic conflict-free merging, but they also come with trade-offs:</p>
<ul>
<li class=""><strong>Higher conceptual complexity</strong>: CRDTs require understanding of operation semantics, version vectors, and merge determinism.</li>
<li class=""><strong>Limited flexibility</strong>: you can only express changes that fit the supported JSON-style update operators.</li>
<li class=""><strong>Difficult debugging</strong>: when merges don&#x27;t behave as expected, it can be hard to trace the sequence of CRDT operations that led to a state.</li>
<li class=""><strong>Overhead for simple cases</strong>: if your data rarely conflicts or needs human oversight, using CRDTs can add unnecessary complexity.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="when-to-choose-conflict-handlers">When to choose conflict handlers<a href="#when-to-choose-conflict-handlers" class="hash-link" aria-label="Direct link to When to choose conflict handlers" title="Direct link to When to choose conflict handlers" translate="no">â€‹</a></h3>
<p>Use conflict handlers as CRDT alternative if:</p>
<ul>
<li class="">You want full control over merge logic.</li>
<li class="">Your data model includes contextual or user-specific decisions.</li>
<li class="">You prefer a straightforward, rule-based resolution system over automatic merges.</li>
</ul>
<p>Use CRDTs if:</p>
<ul>
<li class="">Your app performs frequent offline writes that can be merged deterministically.</li>
<li class="">Your data can be represented as additive, numeric, or array-based updates.</li>
<li class="">You want minimal manual intervention during replication.</li>
</ul>
<p>Both methods are first-class citizens in RxDB. CRDTs focus on <strong>automatic, deterministic merging</strong>, while conflict handlers emphasize <strong>clarity, flexibility, and control</strong>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="example-merging-different-fields-with-conflict-handlers-instead-of-crdt">Example: merging different fields with conflict handlers instead of CRDT<a href="#example-merging-different-fields-with-conflict-handlers-instead-of-crdt" class="hash-link" aria-label="Direct link to Example: merging different fields with conflict handlers instead of CRDT" title="Direct link to Example: merging different fields with conflict handlers instead of CRDT" translate="no">â€‹</a></h3>
<p>For example, imagine two users edit different fields of the same document at the same time. One updates a <code>name</code>, the other updates a <code>score</code>. A custom conflict handler can merge both changes so no data is lost:</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="ts" data-theme="css-variables"><code data-language="ts" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> mergeFieldsHandler</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">  isEqual</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> (a</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-foreground)"> b) </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-token-constant)"> JSON</span><span style="color:var(--shiki-token-function)">.stringify</span><span style="color:var(--shiki-foreground)">(a) </span><span style="color:var(--shiki-token-keyword)">===</span><span style="color:var(--shiki-token-constant)"> JSON</span><span style="color:var(--shiki-token-function)">.stringify</span><span style="color:var(--shiki-foreground)">(b)</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">  resolve</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> (input) </span><span style="color:var(--shiki-token-keyword)">=&gt;</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    return</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">      ...</span><span style="color:var(--shiki-token-constant)">input</span><span style="color:var(--shiki-foreground)">.realMasterState</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">      name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> input</span><span style="color:var(--shiki-foreground)">.</span><span style="color:var(--shiki-token-constant)">newDocumentState</span><span style="color:var(--shiki-foreground)">.name </span><span style="color:var(--shiki-token-keyword)">??</span><span style="color:var(--shiki-token-constant)"> input</span><span style="color:var(--shiki-foreground)">.</span><span style="color:var(--shiki-token-constant)">realMasterState</span><span style="color:var(--shiki-foreground)">.name</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">      score</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> Math</span><span style="color:var(--shiki-token-function)">.max</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-constant)">input</span><span style="color:var(--shiki-foreground)">.</span><span style="color:var(--shiki-token-constant)">newDocumentState</span><span style="color:var(--shiki-foreground)">.score</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-constant)"> input</span><span style="color:var(--shiki-foreground)">.</span><span style="color:var(--shiki-token-constant)">realMasterState</span><span style="color:var(--shiki-foreground)">.score)</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    };</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">  }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">};</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<p>In this example, if the two versions change different properties, the final merged document includes both updates. This kind of logic is often easier to reason about than designing equivalent CRDT operations.</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/middleware.html"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Middleware</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/population.html"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Population</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#rxdb-crdt-operations" class="table-of-contents__link toc-highlight">RxDB CRDT operations</a><ul><li><a href="#operators" class="table-of-contents__link toc-highlight">Operators</a></li></ul></li><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a></li><li><a href="#conditional-crdt-operations" class="table-of-contents__link toc-highlight">Conditional CRDT operations</a></li><li><a href="#running-multiples-operations-at-once" class="table-of-contents__link toc-highlight">Running multiples operations at once</a></li><li><a href="#crdts-on-inserts" class="table-of-contents__link toc-highlight">CRDTs on inserts</a></li><li><a href="#deleting-documents" class="table-of-contents__link toc-highlight">Deleting documents</a></li><li><a href="#crdts-with-replication" class="table-of-contents__link toc-highlight">CRDTs with replication</a></li><li><a href="#why-not-automergejs-or-yjs" class="table-of-contents__link toc-highlight">Why not automerge.js or yjs?</a></li><li><a href="#when-to-not-use-crdts" class="table-of-contents__link toc-highlight">When to not use CRDTs</a></li><li><a href="#crdt-alternative" class="table-of-contents__link toc-highlight">CRDT Alternative</a><ul><li><a href="#downsides-of-crdts" class="table-of-contents__link toc-highlight">Downsides of CRDTs</a></li><li><a href="#when-to-choose-conflict-handlers" class="table-of-contents__link toc-highlight">When to choose conflict handlers</a></li><li><a href="#example-merging-different-fields-with-conflict-handlers-instead-of-crdt" class="table-of-contents__link toc-highlight">Example: merging different fields with conflict handlers instead of CRDT</a></li></ul></li></ul></div></div></div><ul style="margin-top:25px;list-style-type:none"><li style="line-height:4;color:var(--expo-theme-text-secondary)">Was this page helpful?<div style="border-radius:3px;border-color:var(--fontColor-offwhite);border-style:solid;border-width:1px;vertical-align:middle;padding:5px;padding-left:8px;padding-right:8px;text-align:center;justify-content:center;display:inline-flex;margin-left:20px;cursor:pointer"><img src="/img/thumbs-up-white.svg" loading="lazy" height="14"></div><div style="border-radius:3px;border-color:var(--fontColor-offwhite);border-style:solid;border-width:1px;vertical-align:middle;padding:5px;padding-left:8px;padding-right:8px;text-align:center;justify-content:center;display:inline-flex;margin-left:20px;cursor:pointer;transform:scale(1, -1)"><img src="/img/thumbs-up-white.svg" loading="lazy" height="14"></div></li><li><a href="/chat/" target="_blank" style="color:var(--fontColor-offwhite)"><img src="/img/community-links/discord-logo.svg" style="padding-right:16px;height:18px;vertical-align:middle" loading="lazy">Ask a question on the forums about <!-- -->RxDB CRDT Plugin</a></li></ul></div></main></div></div></div><div class="block footer dark"><div style="display:flex;flex-wrap:wrap;gap:44px" class="content"><div class="half left"><span><a variant="text" href="/" class="footer-logo-button"><img src="/files/logo/logo_text_white.svg" alt="RxDB" loading="lazy" class="width-140-120"></a><div class="footer-community-links"><a variant="text" href="/newsletter/" target="_blank" aria-label="Newsletter"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22.5 13.5v-7a2 2 0 0 0-2-2h-16a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8"></path><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m22.5 7.5-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2.5 7.5M19.5 16.5v6M16.5 19.5h6"></path></svg></a><a variant="text" href="https://twitter.com/intent/user?screen_name=rxdbjs" target="_blank" aria-label="Twitter"><img src="/files/icons/twitter-blue.svg" alt="Twitter" loading="lazy"></a><a variant="text" href="https://www.linkedin.com/company/rxdb" target="_blank" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 21"><g clip-path="url(#a)"><path fill="#fff" d="M17.3 17.6h-3V13c0-1 0-2.5-1.6-2.5-1.5 0-1.8 1.2-1.8 2.5v4.7H8V8h2.9v1.3a3 3 0 0 1 2.9-1.6c3 0 3.6 2 3.6 4.6zM4.5 6.6a1.7 1.7 0 1 1 0-3.5 1.7 1.7 0 0 1 0 3.5m1.5 11H3V8h3zM18.8.4H1.5A1.5 1.5 0 0 0 0 1.8v17.4a1.5 1.5 0 0 0 1.5 1.4h17.3a1.5 1.5 0 0 0 1.5-1.4V1.8A1.5 1.5 0 0 0 18.8.4"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 .4h24v20.5H0z"></path></clipPath></defs></svg></a><a variant="text" href="/code/" target="_blank" aria-label="Github"><span class="navbar-icon-github" style="width:22px;height:22px;display:inline-block"></span></a><a variant="text" href="/chat/" target="_blank" aria-label="Discord"><span class="navbar-icon-discord" style="width:22px;height:22px;display:inline-block"></span></a></div></span></div><div class="half right" style="display:flex;flex:1"><div style="display:flex"><div class="footer-links min-width-180-135"><a variant="text" href="/overview.html" target="">Docs</a><a variant="text" href="/replication.html" target="">Sync</a><a variant="text" href="/rx-storage.html" target="">Storages</a><a variant="text" href="/premium/" target="_blank">Premium</a><a variant="text" href="/consulting/" target="_blank">Support</a></div><div class="footer-links min-width-180-135"><a variant="text" href="/#reviews" target="">Our Customers</a><a variant="text" href="/consulting#become-partner" target="">Become a Partner</a><a variant="text" href="/legal-notice/" target="_blank">Legal Notice</a></div></div></div></div></div><div class="navbar-line" style="display:block;z-index:10;height:1.5px;background-color:var(--color-top);border-top-right-radius:2px;border-bottom-right-radius:2px;width:100%"></div><div class="call-to-action-popup"><div class="close"><div class="text">âœ•</div></div></div></div>
</body>
</html>