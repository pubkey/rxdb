<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-releases/8.0.0" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Meet RxDB 8.0.0 - New Defaults &amp; Performance | RxDB - JavaScript Database</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" name="twitter:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" property="og:url" content="https://rxdb.info/releases/8.0.0.html"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Meet RxDB 8.0.0 - New Defaults &amp; Performance | RxDB - JavaScript Database"><meta data-rh="true" name="description" content="Discover how RxDB 8.0.0 boosts performance, simplifies schema handling, and streamlines reactive data updates for modern apps."><meta data-rh="true" property="og:description" content="Discover how RxDB 8.0.0 boosts performance, simplifies schema handling, and streamlines reactive data updates for modern apps."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rxdb.info/releases/8.0.0.html"><link data-rh="true" rel="alternate" href="https://rxdb.info/releases/8.0.0.html" hreflang="en"><link data-rh="true" rel="alternate" href="https://rxdb.info/releases/8.0.0.html" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-62D63SY3S0"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-62D63SY3S0",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-PL63TR5",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<meta name="theme-color" content="#ed168f">
<link rel="icon" type="image/svg+xml" href="/files/logo/logo.svg">
<link rel="apple-touch-icon" href="/img/apple-touch-icon.png" sizes="180x180">
<link rel="preconnect" href="https://consentcdn.cookiebot.com/">
<link rel="preconnect" href="https://consent.cookiebot.com/">
<link rel="preconnect" href="https://region1.analytics.google.com/">
<link rel="preconnect" href="https://www.redditstatic.com/">
<link rel="preconnect" href="https://pixel-config.reddit.com/"><link rel="stylesheet" href="/assets/css/styles.4b125d73.css">
<script src="/assets/js/runtime~main.7bc265aa.js" defer="defer"></script>
<script src="/assets/js/main.53882305.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PL63TR5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","dark"),document.documentElement.setAttribute("data-theme-choice","dark"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/files/logo/logo_text_white.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/files/logo/logo_text_white.svg" alt="RxDB" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/files/logo/logo_text_white.svg" alt="RxDB" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/overview.html">Docs</a><div class="dropdown-wrapper"><a class="navbar__item navbar__link" dropdown="sync" href="/replication.html">Sync</a></div><div class="dropdown-wrapper"><a class="navbar__item navbar__link" dropdown="storages" href="/rx-storage.html">Storages</a></div><a class="navbar__item navbar__link" href="/premium/">Premium</a><a class="navbar__item navbar__link" href="/consulting/">Support</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="/chat/" class="navbar__item navbar__link navbar-icon navbar__item navbar-icon-discord" target="_blank"> </a><a href="/code/" class="navbar__item navbar__link navbar-icon navbar__item navbar-icon-github" target="_blank"> </a></div></div><div class="navbar-line" style="position:fixed;left:0;z-index:10;height:2px;width:100vw;background-color:var(--color-top);border-top-right-radius:2px;border-bottom-right-radius:2px;transform-origin:left center;will-change:transform;backface-visibility:hidden;contain:layout;transform:scaleX(0)"></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP"><div style="padding:10px;padding-top:30px;margin-left:auto;margin-right:auto"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" aria-label="Search" class="navbar__search-input search-bar" style="margin-left:auto;margin-right:auto;display:block"></div></div><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/overview.html"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/overview.html"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quickstart.html"><span title="ðŸš€ Quickstart" class="linkLabel_WmDU">ðŸš€ Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/install.html"><span title="Installation" class="linkLabel_WmDU">Installation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-mode.html"><span title="Development Mode" class="linkLabel_WmDU">Development Mode</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/typescript.html"><span title="TypeScript Setup" class="linkLabel_WmDU">TypeScript Setup</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-database.html"><span title="Core Entities" class="categoryLinkLabel_W154">Core Entities</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-storage.html"><span title="ðŸ’¾ Storages" class="categoryLinkLabel_W154">ðŸ’¾ Storages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/schema-validation.html"><span title="Storage Wrappers" class="categoryLinkLabel_W154">Storage Wrappers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/replication.html"><span title="ðŸ”„ Replication" class="categoryLinkLabel_W154">ðŸ”„ Replication</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-server.html"><span title="Server" class="categoryLinkLabel_W154">Server</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/transactions-conflicts-revisions.html"><span title="How RxDB works" class="categoryLinkLabel_W154">How RxDB works</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/migration-schema.html"><span title="Advanced Features" class="categoryLinkLabel_W154">Advanced Features</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-storage-performance.html"><span title="Performance" class="categoryLinkLabel_W154">Performance</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/releases/16.0.0.html"><span title="Releases" class="categoryLinkLabel_W154">Releases</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/16.0.0.html"><span title="16.0.0" class="linkLabel_WmDU">16.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/15.0.0.html"><span title="15.0.0" class="linkLabel_WmDU">15.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/14.0.0.html"><span title="14.0.0" class="linkLabel_WmDU">14.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/13.0.0.html"><span title="13.0.0" class="linkLabel_WmDU">13.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/12.0.0.html"><span title="12.0.0" class="linkLabel_WmDU">12.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/11.0.0.html"><span title="11.0.0" class="linkLabel_WmDU">11.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/10.0.0.html"><span title="10.0.0" class="linkLabel_WmDU">10.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/9.0.0.html"><span title="9.0.0" class="linkLabel_WmDU">9.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/releases/8.0.0.html"><span title="8.0.0" class="linkLabel_WmDU">8.0.0</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/articles/browser-database.html"><span title="Articles" class="categoryLinkLabel_W154">Articles</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contribution.html"><span title="Contribute" class="linkLabel_WmDU">Contribute</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/consulting/"><span title="Contact" class="categoryLinkLabel_W154">Contact</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>8.0.0</h1></header>
<p>When I created RxDB, two years ago, there where some things that I did not consider and other things that I just decided wrong.
With the breaking version <code>8.0.0</code> I rewrote some parts of RxDB and changed the API a bit. The focus laid on <strong>better defaults</strong> and <strong>better performance</strong>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="disablekeycompression-by-default">disableKeyCompression by default<a href="#disablekeycompression-by-default" class="hash-link" aria-label="Direct link to disableKeyCompression by default" title="Direct link to disableKeyCompression by default" translate="no">â€‹</a></h2>
<p>Because the keyCompression was confusing and most users do not use it, it is now disabled by default. Also the naming was bad, so <code>disableKeyCompression</code> is now renamed to <code>keyCompression</code> which defaults to <code>false</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="collection-now-only-accepts-a-rxjsonschema-as-schema">collection() now only accepts a RxJsonSchema as schema<a href="#collection-now-only-accepts-a-rxjsonschema-as-schema" class="hash-link" aria-label="Direct link to collection() now only accepts a RxJsonSchema as schema" title="Direct link to collection() now only accepts a RxJsonSchema as schema" translate="no">â€‹</a></h2>
<p>In the past, it was allowed to set an <code>RxSchema</code> or an <code>RxJsonSchema</code> as <code>schema</code>-field when creating a collection. This was confusing and so it is now only allowed to use <code>RxJsonSchema</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="required-fields-have-to-be-set-via-array">required fields have to be set via array<a href="#required-fields-have-to-be-set-via-array" class="hash-link" aria-label="Direct link to required fields have to be set via array" title="Direct link to required fields have to be set via array" translate="no">â€‹</a></h2>
<p>In the past it was allowed to set a field as required by setting the boolean value <code>required: true</code>.
This is against the <a href="https://json-schema.org/understanding-json-schema/reference/object.html#required-properties" target="_blank" rel="noopener noreferrer" class="">json-schema-standard</a> and will make problems when switching between different schema-validation-plugins. Therefore required fields must now be set via <code>required: [&#x27;fieldOne&#x27;, &#x27;fieldTwo&#x27;]</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="setters-are-only-callable-on-temporary-documents">Setters are only callable on temporary documents<a href="#setters-are-only-callable-on-temporary-documents" class="hash-link" aria-label="Direct link to Setters are only callable on temporary documents" title="Direct link to Setters are only callable on temporary documents" translate="no">â€‹</a></h2>
<p>To be similar to mongoosejs, there was the possibility to set a documents value via <code>myDoc.foo = &#x27;bar&#x27;</code> and later call <code>myDoc.save()</code> to persist these changes.
But there was the problem that we have no weak pointers in javascript and therefore we have to store all document-instances in a cache to run change-events on them and make them &#x27;reactive&#x27;. To save memory-space, we reuse the same documents when they are used multiple times. This made it hard to determine what happens when multiple parts of an application used the setters at the same time. Also there was an undefined behavior what should happen when a field is changed via setter and also via replication before <code>save()</code> was called.</p>
<ul>
<li class=""><code>myDoc.age = 50;</code>, <code>myDoc.set(&#x27;age&#x27;, 50);</code> and <code>myDoc.save()</code> is no more allowed on non-temporary-documents</li>
<li class="">Instead, to change document-data, use <code>RxDocument.atomicUpdate()</code> or <code>RxDocument.atomicSet()</code> or <code>RxDocument.update()</code>.</li>
<li class="">The following document-methods no longer exist: <code>synced$</code>, <code>resync()</code></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="middleware-hooks-contain-plain-json-as-first-parameter-and-rxdocument-as-second">middleware-hooks contain plain json as first parameter and RxDocument as second<a href="#middleware-hooks-contain-plain-json-as-first-parameter-and-rxdocument-as-second" class="hash-link" aria-label="Direct link to middleware-hooks contain plain json as first parameter and RxDocument as second" title="Direct link to middleware-hooks contain plain json as first parameter and RxDocument as second" translate="no">â€‹</a></h2>
<p>When the middleware-hooks where created, the goal was to work equal then <a href="http://mongoosejs.com/docs/middleware.html" target="_blank" rel="noopener noreferrer" class="">mongoose</a>. But this is not possible because mongoose is more &#x27;static&#x27; and its documents never change their attributes. RxDB is a reactive database and when the state on disc changes, the attributes of the document also change. This caused some undefined behavior especially with async middleware-hooks. To solve this, hooks now can only modify the plain data, not the <code>RxDocument</code> itself.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="javascript" data-theme="css-variables"><code data-language="javascript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-constant)">myCollection</span><span style="color:var(--shiki-token-function)">.preSave</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-keyword)">function</span><span style="color:var(--shiki-foreground)">(data</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-foreground)"> rxDocument) {</span></span>
<span data-line=""><span style="color:var(--shiki-token-comment)">    // to set age to 50 before saving, change the first parameter</span></span>
<span data-line=""><span style="color:var(--shiki-token-constant)">    data</span><span style="color:var(--shiki-foreground)">.age </span><span style="color:var(--shiki-token-keyword)">=</span><span style="color:var(--shiki-token-constant)"> 50</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">}</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-constant)"> false</span><span style="color:var(--shiki-foreground)">);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="multiinstance-is-now-done-via-broadcast-channel">multiInstance is now done via broadcast-channel<a href="#multiinstance-is-now-done-via-broadcast-channel" class="hash-link" aria-label="Direct link to multiInstance is now done via broadcast-channel" title="Direct link to multiInstance is now done via broadcast-channel" translate="no">â€‹</a></h2>
<p>Because the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Broadcast_Channel_API" target="_blank" rel="noopener noreferrer" class="">BroadcastChannel-API</a> is not usable in all browsers and also not in NodeJs, multiInstance-communication was hard. The hacky workaround was to use a pseudo-socket and regularly check if an other instance has emitted a <code>RxChangeEvent</code>.
This was expensive because even when the database did nothing, we wasted disk-IO and CPU by handling this.</p>
<p>To solve this waste, I spend one month creating <a href="https://github.com/pubkey/broadcast-channel" target="_blank" rel="noopener noreferrer" class="">a module that polyfills the broadcast-channel-api</a> so it works on old browsers, new browsers and even NodeJs. This does not only waste less resources but also has a lower latency. Also the module is used by more projects than RxDB which allows use the fix bugs and improve performance together.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-querychangedetection-via-rxdatabase-option">Set QueryChangeDetection via RxDatabase-option<a href="#set-querychangedetection-via-rxdatabase-option" class="hash-link" aria-label="Direct link to Set QueryChangeDetection via RxDatabase-option" title="Direct link to Set QueryChangeDetection via RxDatabase-option" translate="no">â€‹</a></h2>
<p>In the past, the QueryChangeDetection had to be enabled by importing the QueryChangeDetection and calling a function on it. This was strange and also did not allow to toggle the QueryChangeDetection on specific databases.
Now we set the QueryChangeDetection by adding the boolean field <code>queryChangeDetection: true</code> when creating the database.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="javascript" data-theme="css-variables"><code data-language="javascript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> db</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-token-keyword)"> await</span><span style="color:var(--shiki-token-constant)"> RxDB</span><span style="color:var(--shiki-token-function)">.create</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">  name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;heroesdb&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">  adapter</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;idb&#x27;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">  queryChangeDetection</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> false</span><span style="color:var(--shiki-token-comment)"> // &lt;- queryChangeDetection (optional, default: false)</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span>
<span data-line=""><span style="color:var(--shiki-token-constant)">console</span><span style="color:var(--shiki-token-function)">.dir</span><span style="color:var(--shiki-foreground)">(db);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="reuse-an-rxdocument-prototype-per-collection-instead-of-adding-getterssetters-to-each-document">Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document<a href="#reuse-an-rxdocument-prototype-per-collection-instead-of-adding-getterssetters-to-each-document" class="hash-link" aria-label="Direct link to Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document" title="Direct link to Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document" translate="no">â€‹</a></h2>
<p>Because the fields of an <code>RxDocument</code> are defined dynamically by the schema and we could not use the <code>Proxy</code>-Object because it is not supported in IE11, there was one workaround used: Each time a document is created, all getters and setters where applied on it. This was expensive and now we use a different approach.
Once per collection, a custom RxDocument-prototype and constructor is created and each RxDocument of this collection is created with the constructor. This change is a rewrite internally and should not change anything for RxDB-users. If you use RxDB with vuejs, you might get some problems that can be fixed by upgrading vuejs to the latest version.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="rewritten-the-inmemory-plugin">Rewritten the inMemory-plugin<a href="#rewritten-the-inmemory-plugin" class="hash-link" aria-label="Direct link to Rewritten the inMemory-plugin" title="Direct link to Rewritten the inMemory-plugin" translate="no">â€‹</a></h2>
<p>The inMemory-plugin was written with some wrong estimations. I rewrote it and added much more tests. Also <code>awaitPersistence()</code> can now be used to check if all writes have already been replicated into the parent collection. Also <code>RxCollection.watchForChanges()</code> got split out from the <code>replication</code>-plugin into its own <code>watch-for-changes</code>-plugin because it is used in the inMemory and the replication functionality.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="some-comparisons">Some comparisons<a href="#some-comparisons" class="hash-link" aria-label="Direct link to Some comparisons" title="Direct link to Some comparisons" translate="no">â€‹</a></h2>
<p>(Tested with node 10.6.0 and the memory-adapter, lower is better)</p>
<p>Reproduce with <code>npm run build:size</code> and <code>npm run test:performance</code></p>
<table><thead><tr><th style="text-align:center"></th><th style="text-align:center">7.7.1</th><th>8.0.0</th></tr></thead><tbody><tr><td style="text-align:center">Bundle-Size (Webpack+minify+gzip)</td><td style="text-align:center">110 kb</td><td>101.962 kb</td></tr><tr><td style="text-align:center">Spawn 1000 databases  with 5 collections each</td><td style="text-align:center">8744 ms</td><td>9906 ms</td></tr><tr><td style="text-align:center">insert 2000 documents</td><td style="text-align:center">8006 ms</td><td>5781 ms</td></tr><tr><td style="text-align:center">find 10.000 documents</td><td style="text-align:center">3202 ms</td><td>1312 ms</td></tr></tbody></table></div></article><ul style="margin-top:25px;list-style-type:none"><li style="line-height:4;color:var(--expo-theme-text-secondary)">Was this page helpful?<div style="border-radius:3px;border-color:var(--fontColor-offwhite);border-style:solid;border-width:1px;vertical-align:middle;padding:5px;padding-left:8px;padding-right:8px;text-align:center;justify-content:center;display:inline-flex;margin-left:20px;cursor:pointer"><img src="/img/thumbs-up-white.svg" loading="lazy" height="14"></div><div style="border-radius:3px;border-color:var(--fontColor-offwhite);border-style:solid;border-width:1px;vertical-align:middle;padding:5px;padding-left:8px;padding-right:8px;text-align:center;justify-content:center;display:inline-flex;margin-left:20px;cursor:pointer;transform:scale(1, -1)"><img src="/img/thumbs-up-white.svg" loading="lazy" height="14"></div></li><li><a href="/chat/" target="_blank" style="color:var(--fontColor-offwhite)"><img src="/img/community-links/discord-logo.svg" style="padding-right:16px;height:18px;vertical-align:middle" loading="lazy">Ask a question on the forums about <!-- -->8.0.0</a></li></ul><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a href="/releases/9.0.0.html" class="padding-button" style="display:inline-flex;height:auto;flex-direction:row;justify-content:left;align-items:center;gap:10px;font-size:1rem;font-weight:500;cursor:pointer;text-align:left;transition:all 0.2s ease-in-out;line-height:initial;user-select:none;box-sizing:border-box;text-decoration:none;position:relative;overflow:hidden;background:transparent;color:#fff;border:2px solid #fff;padding-top:14px;padding-bottom:14px"><span style="font-size:80%;display:contents">Previous</span><br>Â« <!-- -->9.0.0</a><a href="/articles/browser-database.html" class="padding-button" style="display:inline-flex;height:auto;flex-direction:row;justify-content:right;align-items:center;gap:10px;font-size:1rem;font-weight:500;cursor:pointer;text-align:right;transition:all 0.2s ease-in-out;line-height:initial;user-select:none;box-sizing:border-box;text-decoration:none;position:relative;overflow:hidden;background:transparent;color:#fff;border:2px solid #fff;padding-top:14px;padding-bottom:14px"><span style="font-size:80%;display:contents">Next</span><br>Benefits of RxDB &amp; Browser Databases<!-- --> Â»</a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#disablekeycompression-by-default" class="table-of-contents__link toc-highlight">disableKeyCompression by default</a></li><li><a href="#collection-now-only-accepts-a-rxjsonschema-as-schema" class="table-of-contents__link toc-highlight">collection() now only accepts a RxJsonSchema as schema</a></li><li><a href="#required-fields-have-to-be-set-via-array" class="table-of-contents__link toc-highlight">required fields have to be set via array</a></li><li><a href="#setters-are-only-callable-on-temporary-documents" class="table-of-contents__link toc-highlight">Setters are only callable on temporary documents</a></li><li><a href="#middleware-hooks-contain-plain-json-as-first-parameter-and-rxdocument-as-second" class="table-of-contents__link toc-highlight">middleware-hooks contain plain json as first parameter and RxDocument as second</a></li><li><a href="#multiinstance-is-now-done-via-broadcast-channel" class="table-of-contents__link toc-highlight">multiInstance is now done via broadcast-channel</a></li><li><a href="#set-querychangedetection-via-rxdatabase-option" class="table-of-contents__link toc-highlight">Set QueryChangeDetection via RxDatabase-option</a></li><li><a href="#reuse-an-rxdocument-prototype-per-collection-instead-of-adding-getterssetters-to-each-document" class="table-of-contents__link toc-highlight">Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document</a></li><li><a href="#rewritten-the-inmemory-plugin" class="table-of-contents__link toc-highlight">Rewritten the inMemory-plugin</a></li><li><a href="#some-comparisons" class="table-of-contents__link toc-highlight">Some comparisons</a></li></ul></div></div></div></div></main></div></div></div><div class="block footer dark"><div style="display:flex;flex-wrap:wrap;gap:44px" class="content"><div class="half left"><span><a variant="text" href="/" class="footer-logo-button"><img src="/files/logo/logo_text_white.svg" alt="RxDB" loading="lazy" class="width-140-120"></a><div class="footer-community-links"><a variant="text" href="/newsletter/" target="_blank" aria-label="Newsletter"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22.5 13.5v-7a2 2 0 0 0-2-2h-16a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8"></path><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m22.5 7.5-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2.5 7.5M19.5 16.5v6M16.5 19.5h6"></path></svg></a><a variant="text" href="https://twitter.com/intent/user?screen_name=rxdbjs" target="_blank" aria-label="Twitter"><img src="/files/icons/twitter-blue.svg" alt="Twitter" loading="lazy"></a><a variant="text" href="https://www.linkedin.com/company/rxdb" target="_blank" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 21"><g clip-path="url(#a)"><path fill="#fff" d="M17.3 17.6h-3V13c0-1 0-2.5-1.6-2.5-1.5 0-1.8 1.2-1.8 2.5v4.7H8V8h2.9v1.3a3 3 0 0 1 2.9-1.6c3 0 3.6 2 3.6 4.6zM4.5 6.6a1.7 1.7 0 1 1 0-3.5 1.7 1.7 0 0 1 0 3.5m1.5 11H3V8h3zM18.8.4H1.5A1.5 1.5 0 0 0 0 1.8v17.4a1.5 1.5 0 0 0 1.5 1.4h17.3a1.5 1.5 0 0 0 1.5-1.4V1.8A1.5 1.5 0 0 0 18.8.4"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 .4h24v20.5H0z"></path></clipPath></defs></svg></a><a variant="text" href="/code/" target="_blank" aria-label="Github"><span class="navbar-icon-github" style="width:22px;height:22px;display:inline-block"></span></a><a variant="text" href="/chat/" target="_blank" aria-label="Discord"><span class="navbar-icon-discord" style="width:22px;height:22px;display:inline-block"></span></a></div></span></div><div class="half right" style="display:flex;flex:1"><div style="display:flex"><div class="footer-links min-width-180-135"><a variant="text" href="/overview.html" target="">Docs</a><a variant="text" href="/replication.html" target="">Sync</a><a variant="text" href="/rx-storage.html" target="">Storages</a><a variant="text" href="/premium/" target="_blank">Premium</a><a variant="text" href="/consulting/" target="_blank">Support</a></div><div class="footer-links min-width-180-135"><a variant="text" href="/#reviews" target="">Our Customers</a><a variant="text" href="/consulting#become-partner" target="">Become a Partner</a><a variant="text" href="/legal-notice/" target="_blank">Legal Notice</a></div></div></div></div></div><div class="navbar-line" style="display:block;z-index:10;height:1.5px;background-color:var(--color-top);border-top-right-radius:2px;border-bottom-right-radius:2px;width:100%"></div><div class="call-to-action-popup"><div class="close-popup"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" class="" style="transform:scale(1);transition:transform 0.2s ease-in-out;display:inline-block;cursor:pointer"><path d="M4 16H8L8 12H4L4 16Z" fill="white"></path><path d="M0 20H4L4 16H0L0 20Z" fill="white"></path><path d="M8 11.9999H12V7.99992H8L8 11.9999Z" fill="white"></path><path d="M4 8.00008H8L8 4.00008H4L4 8.00008Z" fill="white"></path><path d="M0 4.00004L4 4.00004L4 3.8147e-05L0 3.8147e-05L0 4.00004Z" fill="white"></path><path d="M16 11.9999H12V15.9999H16V11.9999Z" fill="white"></path><path d="M20 16H16V20H20V16Z" fill="white"></path><path d="M16 4.00004H12V8.00004H16V4.00004Z" fill="white"></path><path d="M20 0H16V4H20V0Z" fill="white"></path></svg></div></div></div>
</body>
</html>