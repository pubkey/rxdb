<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-releases/8.0.0" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">RxDB 8.0.0 | RxDB - JavaScript Database</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" name="twitter:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" property="og:url" content="https://rxdb.info/releases/8.0.0.html"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="RxDB 8.0.0 | RxDB - JavaScript Database"><meta data-rh="true" name="description" content="RxDB Major Release 8.0.0"><meta data-rh="true" property="og:description" content="RxDB Major Release 8.0.0"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://rxdb.info/releases/8.0.0.html"><link data-rh="true" rel="alternate" href="https://rxdb.info/releases/8.0.0.html" hreflang="en"><link data-rh="true" rel="alternate" href="https://rxdb.info/releases/8.0.0.html" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-62D63SY3S0"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-62D63SY3S0",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-PL63TR5",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script>



<script id="Cookiebot" src="https://consent.cookiebot.com/uc.js?cbid=c429ebbd-6e92-4150-b700-ca186e06bc7c" data-cbid="c429ebbd-6e92-4150-b700-ca186e06bc7c" data-blockingmode="auto"></script>
<script src="/js/analytics.js" async></script><link rel="stylesheet" href="/assets/css/styles.8b698b6b.css">
<script src="/assets/js/runtime~main.b89eda5e.js" defer="defer"></script>
<script src="/assets/js/main.5dbc8e9b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PL63TR5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/files/logo/logo.svg" alt="RxDB Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/files/logo/logo.svg" alt="RxDB Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">RxDB</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/quickstart.html">Docs</a><a class="navbar__item navbar__link" target="_blank" href="/code">Code</a><a class="navbar__item navbar__link" href="/premium">Pricing</a><a class="navbar__item navbar__link" target="_blank" href="/chat">Chat</a><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quickstart.html">ðŸš€ Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/install.html">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/dev-mode.html">Dev-Mode Plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-database.html">RxDatabase</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-schema.html">RxSchema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-collection.html">RxCollection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-document.html">RxDocument</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-query.html">RxQuery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-attachment.html">Attachments</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/rx-storage.html">ðŸ’¾ RxStorage</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/replication.html">ðŸ”„ Replication</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/rx-server.html">Server</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/migration-schema.html">Migration</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/reactivity.html">Signals &amp; Custom Reactivity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-state.html">RxState</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/rx-local-document.html">Local Documents</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/encryption.html">Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/key-compression.html">Key Compression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/leader-election.html">Leader Election</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cleanup.html">Cleanup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/backup.html">Backup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/transactions-conflicts-revisions.html">Transactions, Conflicts and Revisions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/middleware.html">Middleware</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/query-cache.html">Query Cache</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/crdt.html">CRDT - Conflict-free replicated data type Database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/population.html">Population</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/orm.html">ORM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/query-optimizer.html">Query Optimizer ðŸ‘‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/logger.html">Logger ðŸ‘‘</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/plugins.html">Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/nosql-performance-tips.html">RxDB NoSQL Performance Tips</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/third-party-plugins.html">Third Party Plugins</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/tutorials/typescript.html">Tutorials</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/questions-answers.html">Questions and Answers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contribution.html">Contribute to RxDB</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/releases/15.0.0.html">ðŸ†• Releases</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/15.0.0.html">ðŸ†• RxDB 15.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/14.0.0.html">RxDB 14.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/13.0.0.html">RxDB 13.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/12.0.0.html">RxDB 12.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/11.0.0.html">RxDB 11.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/10.0.0.html">RxDB 10.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/9.0.0.html">RxDB 9.0.0</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/releases/8.0.0.html">RxDB 8.0.0</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/offline-first.html">Articles</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">ðŸ†• Releases</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">RxDB 8.0.0</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>8.0.0</h1>
<p>When I created RxDB, two years ago, there where some things that I did not consider and other things that I just decided wrong.
With the breaking version <code>8.0.0</code> I rewrote some parts of RxDB and changed the API a bit. The focus laid on <strong>better defaults</strong> and <strong>better performance</strong>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="disablekeycompression-by-default">disableKeyCompression by default<a href="#disablekeycompression-by-default" class="hash-link" aria-label="Direct link to disableKeyCompression by default" title="Direct link to disableKeyCompression by default">â€‹</a></h2>
<p>Because the keyCompression was confusing and most users do not use it, it is now disabled by default. Also the naming was bad, so <code>disableKeyCompression</code> is now renamed to <code>keyCompression</code> which defaults to <code>false</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="collection-now-only-accepts-a-rxjsonschema-as-schema">collection() now only accepts a RxJsonSchema as schema<a href="#collection-now-only-accepts-a-rxjsonschema-as-schema" class="hash-link" aria-label="Direct link to collection() now only accepts a RxJsonSchema as schema" title="Direct link to collection() now only accepts a RxJsonSchema as schema">â€‹</a></h2>
<p>In the past, it was allowed to set an <code>RxSchema</code> or an <code>RxJsonSchema</code> as <code>schema</code>-field when creating a collection. This was confusing and so it is now only allowed to use <code>RxJsonSchema</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="required-fields-have-to-be-set-via-array">required fields have to be set via array<a href="#required-fields-have-to-be-set-via-array" class="hash-link" aria-label="Direct link to required fields have to be set via array" title="Direct link to required fields have to be set via array">â€‹</a></h2>
<p>In the past it was allowed to set a field as required by setting the boolean value <code>required: true</code>.
This is against the <a href="https://json-schema.org/understanding-json-schema/reference/object.html#required-properties" target="_blank" rel="noopener noreferrer">json-schema-standard</a> and will make problems when switching between different schema-validation-plugins. Therefore required fields must now be set via <code>required: [&#x27;fieldOne&#x27;, &#x27;fieldTwo&#x27;]</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="setters-are-only-callable-on-temporary-documents">Setters are only callable on temporary documents<a href="#setters-are-only-callable-on-temporary-documents" class="hash-link" aria-label="Direct link to Setters are only callable on temporary documents" title="Direct link to Setters are only callable on temporary documents">â€‹</a></h2>
<p>To be similar to mongoosejs, there was the possibility to set a documents value via <code>myDoc.foo = &#x27;bar&#x27;</code> and later call <code>myDoc.save()</code> to persist these changes.
But there was the problem that we have no weak pointers in javascript and therefore we have to store all document-instances in a cache to run change-events on them and make them &#x27;reactive&#x27;. To save memory-space, we reuse the same documents when they are used multiple times. This made it hard to determine what happens when multiple parts of an application used the setters at the same time. Also there was an undefined behavior what should happen when a field is changed via setter and also via replication before <code>save()</code> was called.</p>
<ul>
<li><code>myDoc.age = 50;</code>, <code>myDoc.set(&#x27;age&#x27;, 50);</code> and <code>myDoc.save()</code> is no more allowed on non-temporary-documents</li>
<li>Instead, to change document-data, use <code>RxDocument.atomicUpdate()</code> or <code>RxDocument.atomicSet()</code> or <code>RxDocument.update()</code>.</li>
<li>The following document-methods no longer exist: <code>synced$</code>, <code>resync()</code></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="middleware-hooks-contain-plain-json-as-first-parameter-and-rxdocument-as-second">middleware-hooks contain plain json as first parameter and RxDocument as second<a href="#middleware-hooks-contain-plain-json-as-first-parameter-and-rxdocument-as-second" class="hash-link" aria-label="Direct link to middleware-hooks contain plain json as first parameter and RxDocument as second" title="Direct link to middleware-hooks contain plain json as first parameter and RxDocument as second">â€‹</a></h2>
<p>When the middleware-hooks where created, the goal was to work equal then <a href="http://mongoosejs.com/docs/middleware.html" target="_blank" rel="noopener noreferrer">mongoose</a>. But this is not possible because mongoose is more &#x27;static&#x27; and its documents never change their attributes. RxDB is a reactive database and when the state on disc changes, the attributes of the document also change. This caused some undefined behavior especially with async middleware-hooks. To solve this, hooks now can only modify the plain data, not the <code>RxDocument</code> itself.</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">myCollection</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">preSave</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">function</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token parameter">data</span><span class="token parameter punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token parameter"> rxDocument</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// to set age to 50 before saving, change the first parameter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token property-access">age</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="multiinstance-is-now-done-via-broadcast-channel">multiInstance is now done via broadcast-channel<a href="#multiinstance-is-now-done-via-broadcast-channel" class="hash-link" aria-label="Direct link to multiInstance is now done via broadcast-channel" title="Direct link to multiInstance is now done via broadcast-channel">â€‹</a></h2>
<p>Because the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Broadcast_Channel_API" target="_blank" rel="noopener noreferrer">BroadcastChannel-API</a> is not usable in all browsers and also not in NodeJs, multiInstance-communication was hard. The hacky workaround was to use a pseudo-socket and regularly check if an other instance has emitted a <code>RxChangeEvent</code>.
This was expensive because even when the database did nothing, we wasted disk-IO and CPU by handling this.</p>
<p>To solve this waste, I spend one month creating <a href="https://github.com/pubkey/broadcast-channel" target="_blank" rel="noopener noreferrer">a module that polyfills the broadcast-channel-api</a> so it works on old browsers, new browsers and even NodeJs. This does not only waste less resources but also has a lower latency. Also the module is used by more projects than RxDB which allows use the fix bugs and improve performance together.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-querychangedetection-via-rxdatabase-option">Set QueryChangeDetection via RxDatabase-option<a href="#set-querychangedetection-via-rxdatabase-option" class="hash-link" aria-label="Direct link to Set QueryChangeDetection via RxDatabase-option" title="Direct link to Set QueryChangeDetection via RxDatabase-option">â€‹</a></h2>
<p>In the past, the QueryChangeDetection had to be enabled by importing the QueryChangeDetection and calling a function on it. This was strange and also did not allow to toggle the QueryChangeDetection on specific databases.
Now we set the QueryChangeDetection by adding the boolean field <code>queryChangeDetection: true</code> when creating the database.</p>
<div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">const</span><span class="token plain"> db </span><span class="token operator">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:rgb(189, 147, 249);font-style:italic">await</span><span class="token plain"> </span><span class="token maybe-class-name">RxDB</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">create</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;heroesdb&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">adapter</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;idb&#x27;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token literal-property property">queryChangeDetection</span><span class="token operator">:</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token plain"> </span><span class="token comment" style="color:rgb(98, 114, 164)">// &lt;- queryChangeDetection (optional, default: false)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token method function property-access" style="color:rgb(80, 250, 123)">dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reuse-an-rxdocument-prototype-per-collection-instead-of-adding-getterssetters-to-each-document">Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document<a href="#reuse-an-rxdocument-prototype-per-collection-instead-of-adding-getterssetters-to-each-document" class="hash-link" aria-label="Direct link to Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document" title="Direct link to Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document">â€‹</a></h2>
<p>Because the fields of an <code>RxDocument</code> are defined dynamically by the schema and we could not use the <code>Proxy</code>-Object because it is not supported in IE11, there was one workaround used: Each time a document is created, all getters and setters where applied on it. This was expensive and now we use a different approach.
Once per collection, a custom RxDocument-prototype and constructor is created and each RxDocument of this collection is created with the constructor. This change is a rewrite internally and should not change anything for RxDB-users. If you use RxDB with vuejs, you might get some problems that can be fixed by upgrading vuejs to the latest version.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rewritten-the-inmemory-plugin">Rewritten the inMemory-plugin<a href="#rewritten-the-inmemory-plugin" class="hash-link" aria-label="Direct link to Rewritten the inMemory-plugin" title="Direct link to Rewritten the inMemory-plugin">â€‹</a></h2>
<p>The inMemory-plugin was written with some wrong estimations. I rewrote it and added much more tests. Also <code>awaitPersistence()</code> can now be used to check if all writes have already been replicated into the parent collection. Also <code>RxCollection.watchForChanges()</code> got split out from the <code>replication</code>-plugin into its own <code>watch-for-changes</code>-plugin because it is used in the inMemory and the replication functionality.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="some-comparisons">Some comparisons<a href="#some-comparisons" class="hash-link" aria-label="Direct link to Some comparisons" title="Direct link to Some comparisons">â€‹</a></h2>
<p>(Tested with node 10.6.0 and the memory-adapter, lower is better)</p>
<p>Reproduce with <code>npm run build:size</code> and <code>npm run test:performance</code></p>
<table><thead><tr><th style="text-align:center"></th><th style="text-align:center">7.7.1</th><th>8.0.0</th></tr></thead><tbody><tr><td style="text-align:center">Bundle-Size (Webpack+minify+gzip)</td><td style="text-align:center">110 kb</td><td>101.962 kb</td></tr><tr><td style="text-align:center">Spawn 1000 databases  with 5 collections each</td><td style="text-align:center">8744 ms</td><td>9906 ms</td></tr><tr><td style="text-align:center">insert 2000 documents</td><td style="text-align:center">8006 ms</td><td>5781 ms</td></tr><tr><td style="text-align:center">find 10.000 documents</td><td style="text-align:center">3202 ms</td><td>1312 ms</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/releases/9.0.0.html"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">RxDB 9.0.0</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/offline-first.html"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Local First / Offline First</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#disablekeycompression-by-default" class="table-of-contents__link toc-highlight">disableKeyCompression by default</a></li><li><a href="#collection-now-only-accepts-a-rxjsonschema-as-schema" class="table-of-contents__link toc-highlight">collection() now only accepts a RxJsonSchema as schema</a></li><li><a href="#required-fields-have-to-be-set-via-array" class="table-of-contents__link toc-highlight">required fields have to be set via array</a></li><li><a href="#setters-are-only-callable-on-temporary-documents" class="table-of-contents__link toc-highlight">Setters are only callable on temporary documents</a></li><li><a href="#middleware-hooks-contain-plain-json-as-first-parameter-and-rxdocument-as-second" class="table-of-contents__link toc-highlight">middleware-hooks contain plain json as first parameter and RxDocument as second</a></li><li><a href="#multiinstance-is-now-done-via-broadcast-channel" class="table-of-contents__link toc-highlight">multiInstance is now done via broadcast-channel</a></li><li><a href="#set-querychangedetection-via-rxdatabase-option" class="table-of-contents__link toc-highlight">Set QueryChangeDetection via RxDatabase-option</a></li><li><a href="#reuse-an-rxdocument-prototype-per-collection-instead-of-adding-getterssetters-to-each-document" class="table-of-contents__link toc-highlight">Reuse an RxDocument-prototype per collection instead of adding getters/setters to each document</a></li><li><a href="#rewritten-the-inmemory-plugin" class="table-of-contents__link toc-highlight">Rewritten the inMemory-plugin</a></li><li><a href="#some-comparisons" class="table-of-contents__link toc-highlight">Some comparisons</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/quickstart.html">ðŸš€ Quickstart</a></li><li class="footer__item"><a class="footer__link-item" href="/rx-storage.html">ðŸ’¾ Storage</a></li><li class="footer__item"><a class="footer__link-item" href="/replication.html">ðŸ”„ Replication</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_blank" href="/code">Github</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" href="/chat">Discord</a></li><li class="footer__item"><a href="https://twitter.com/intent/user?screen_name=rxdbjs" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/rxdb" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/rxdb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" target="_blank" href="/premium">Pricing</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" href="/legal-notice">Legal Notice</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright"> </div></div></div></footer></div>
</body>
</html>