<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-releases/9.0.0" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">RxDB 9.0.0 - Faster &amp; Simpler | RxDB - JavaScript Database</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" name="twitter:image" content="https://rxdb.info/img/rxdb_social_card.png"><meta data-rh="true" property="og:url" content="https://rxdb.info/releases/9.0.0.html"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="RxDB 9.0.0 - Faster &amp; Simpler | RxDB - JavaScript Database"><meta data-rh="true" name="description" content="Discover RxDB 9.0.0&#x27;s streamlined plugins, top-level schema definitions, and improved dev-mode. Experience a simpler, faster real-time database."><meta data-rh="true" property="og:description" content="Discover RxDB 9.0.0&#x27;s streamlined plugins, top-level schema definitions, and improved dev-mode. Experience a simpler, faster real-time database."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rxdb.info/releases/9.0.0.html"><link data-rh="true" rel="alternate" href="https://rxdb.info/releases/9.0.0.html" hreflang="en"><link data-rh="true" rel="alternate" href="https://rxdb.info/releases/9.0.0.html" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-62D63SY3S0"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-62D63SY3S0",{})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-PL63TR5",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>






<meta name="theme-color" content="#ed168f">
<link rel="icon" type="image/svg+xml" href="/files/logo/logo.svg">
<link rel="apple-touch-icon" href="/img/apple-touch-icon.png" sizes="180x180">
<link rel="preconnect" href="https://consentcdn.cookiebot.com/">
<link rel="preconnect" href="https://consent.cookiebot.com/">
<link rel="preconnect" href="https://region1.analytics.google.com/">
<link rel="preconnect" href="https://www.redditstatic.com/">
<link rel="preconnect" href="https://pixel-config.reddit.com/"><link rel="stylesheet" href="/assets/css/styles.b066e612.css">
<script src="/assets/js/runtime~main.97dff6ba.js" defer="defer"></script>
<script src="/assets/js/main.738e5ca4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PL63TR5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","dark"),document.documentElement.setAttribute("data-theme-choice","dark"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/files/logo/logo_text_white.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/files/logo/logo_text_white.svg" alt="RxDB" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/files/logo/logo_text_white.svg" alt="RxDB" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/overview.html">Docs</a><div class="dropdown-wrapper"><a class="navbar__item navbar__link" dropdown="sync" href="/replication.html">Sync</a></div><div class="dropdown-wrapper"><a class="navbar__item navbar__link" dropdown="storages" href="/rx-storage.html">Storages</a></div><a class="navbar__item navbar__link" href="/premium/">Premium</a><a class="navbar__item navbar__link" href="/consulting/">Support</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="/chat/" class="navbar__item navbar__link navbar-icon navbar__item navbar-icon-discord" target="_blank"> </a><a href="/code/" class="navbar__item navbar__link navbar-icon navbar__item navbar-icon-github" target="_blank"> </a></div></div><div class="navbar-line" style="position:fixed;left:0;z-index:10;height:2px;width:100vw;background-color:var(--color-top);border-top-right-radius:2px;border-bottom-right-radius:2px;transform-origin:left center;will-change:transform;backface-visibility:hidden;contain:layout;transform:scaleX(0)"></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_mhZE"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Y1UP"><div style="padding:10px;padding-top:30px;margin-left:auto;margin-right:auto"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" aria-label="Search" class="navbar__search-input search-bar" style="margin-left:auto;margin-right:auto;display:block"></div></div><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/overview.html"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/overview.html"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/quickstart.html"><span title="ðŸš€ Quickstart" class="linkLabel_WmDU">ðŸš€ Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/install.html"><span title="Installation" class="linkLabel_WmDU">Installation</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/dev-mode.html"><span title="Development Mode" class="linkLabel_WmDU">Development Mode</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/tutorials/typescript.html"><span title="TypeScript Setup" class="linkLabel_WmDU">TypeScript Setup</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-database.html"><span title="Core Entities" class="categoryLinkLabel_W154">Core Entities</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-storage.html"><span title="ðŸ’¾ Storages" class="categoryLinkLabel_W154">ðŸ’¾ Storages</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/schema-validation.html"><span title="Storage Wrappers" class="categoryLinkLabel_W154">Storage Wrappers</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/replication.html"><span title="ðŸ”„ Replication" class="categoryLinkLabel_W154">ðŸ”„ Replication</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-server.html"><span title="Server" class="categoryLinkLabel_W154">Server</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/transactions-conflicts-revisions.html"><span title="How RxDB works" class="categoryLinkLabel_W154">How RxDB works</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/migration-schema.html"><span title="Advanced Features" class="categoryLinkLabel_W154">Advanced Features</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/rx-storage-performance.html"><span title="Performance" class="categoryLinkLabel_W154">Performance</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/releases/17.0.0.html"><span title="Releases" class="categoryLinkLabel_W154">Releases</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/17.0.0.html"><span title="17.0.0" class="linkLabel_WmDU">17.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/16.0.0.html"><span title="16.0.0" class="linkLabel_WmDU">16.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/15.0.0.html"><span title="15.0.0" class="linkLabel_WmDU">15.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/14.0.0.html"><span title="14.0.0" class="linkLabel_WmDU">14.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/13.0.0.html"><span title="13.0.0" class="linkLabel_WmDU">13.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/12.0.0.html"><span title="12.0.0" class="linkLabel_WmDU">12.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/11.0.0.html"><span title="11.0.0" class="linkLabel_WmDU">11.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/10.0.0.html"><span title="10.0.0" class="linkLabel_WmDU">10.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/releases/9.0.0.html"><span title="9.0.0" class="linkLabel_WmDU">9.0.0</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/releases/8.0.0.html"><span title="8.0.0" class="linkLabel_WmDU">8.0.0</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/articles/browser-database.html"><span title="Articles" class="categoryLinkLabel_W154">Articles</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contribution.html"><span title="Contribute" class="linkLabel_WmDU">Contribute</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/consulting/"><span title="Contact" class="categoryLinkLabel_W154">Contact</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_z5aJ"><div class="docItemContainer_c0TR"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>9.0.0</h1></header>
<p>So I was working hard the past month to prepare everything for the next major release of RxDB. The last major release was 1,5 years ago by the way.</p>
<p>When I started <a href="https://github.com/pubkey/rxdb/issues/1636" target="_blank" rel="noopener noreferrer" class="">listing up the planned changes</a> I had big ambitions about basically rewriting everything. But I found out this time has not come yet. There is some work to be done first. So version <code>9.0.0</code> was more about fixing all these small things that made improving the codebase difficult. Much has been refactored and moved. Some API-parts have been changed to have a more simple project with a cleaner codebase.</p>
<p>Notice that I use major releases to bundle stuff that breaks the RxDB usage in your project. By having only few major releases you can be sure that you can upgrade in one big block instead of changing stuff each few months. Big features are released in non-major releases because they mostly can be implemented without side effects.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="breaking-changes">Breaking changes<a href="#breaking-changes" class="hash-link" aria-label="Direct link to Breaking changes" title="Direct link to Breaking changes" translate="no">â€‹</a></h2>
<p>You have to apply these changes to your codebase when upgrading RxDB.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="all-default-exports-have-been-removed">All default exports have been removed<a href="#all-default-exports-have-been-removed" class="hash-link" aria-label="Direct link to All default exports have been removed" title="Direct link to All default exports have been removed" translate="no">â€‹</a></h3>
<p>Using default exports and imports can be helpful when you want to write code fast.
But using them also disabled the tree-shaking of your bundler which means you added much code to your bundle that was not even used. To prevent this common behavior, I removed all default exports and renamed functions so that they are more unlikely to clash with other non-RxDB function names.</p>
<p>Instead of doing</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> RxDB </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-constant)">RxDB</span><span style="color:var(--shiki-token-function)">.plugin</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-comment)">/* ... */</span><span style="color:var(--shiki-foreground)">);</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-constant)"> RxDB</span><span style="color:var(--shiki-token-function)">.create</span><span style="color:var(--shiki-foreground)">({</span><span style="color:var(--shiki-token-comment)">/* ... */</span><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<p>You now do</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { createRxDatabase</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-foreground)"> addRxPlugin } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">addRxPlugin</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-comment)">/* ... */</span><span style="color:var(--shiki-foreground)">);</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">await</span><span style="color:var(--shiki-token-function)"> createRxDatabase</span><span style="color:var(--shiki-foreground)">({</span><span style="color:var(--shiki-token-comment)">/* ... */</span><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<p>Also <code>removeDatabase()</code> is renamed to <code>removeRxDatabase()</code> and <code>plugin()</code> is now <code>addRxPlugin()</code>.</p>
<p>Same goes for all previous default exports of the plugins.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="indexes-are-specified-at-the-top-level-of-the-schema-definition">Indexes are specified at the top level of the schema definition<a href="#indexes-are-specified-at-the-top-level-of-the-schema-definition" class="hash-link" aria-label="Direct link to Indexes are specified at the top level of the schema definition" title="Direct link to Indexes are specified at the top level of the schema definition" translate="no">â€‹</a></h3>
<p><a href="https://github.com/pubkey/rxdb/issues/1655" target="_blank" rel="noopener noreferrer" class="">related issue</a></p>
<p>In the past the indexes of a collection had to be specified at the field level of the schema like</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="json" data-theme="css-variables"><code data-language="json" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-foreground)">{</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;firstName&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">        &quot;type&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-string-expression)"> &quot;string&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">        &quot;index&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-constant)"> true</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">}</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<p>This made it complex to list up the index fields which had a bad performance on startup.
To fix this the indexes are now specified at the top level of the schema like</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="json" data-theme="css-variables"><code data-language="json" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-foreground)">{</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;title&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-string-expression)"> &quot;my schema&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;version&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-constant)"> 0</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;type&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-string-expression)"> &quot;object&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;properties&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-foreground)"> {}</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;indexes&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-foreground)"> [</span></span>
<span data-line=""><span style="color:var(--shiki-token-string-expression)">        &quot;firstName&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        [</span><span style="color:var(--shiki-token-string-expression)">&quot;compound&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span><span style="color:var(--shiki-token-string-expression)"> &quot;index&quot;</span><span style="color:var(--shiki-foreground)">]</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ]</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">}</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="encrypted-fields-at-the-top-level-of-the-schema">Encrypted fields at the top level of the schema<a href="#encrypted-fields-at-the-top-level-of-the-schema" class="hash-link" aria-label="Direct link to Encrypted fields at the top level of the schema" title="Direct link to Encrypted fields at the top level of the schema" translate="no">â€‹</a></h3>
<p>Same as the indexes, encrypted fields are now also defined in the top level like</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="json" data-theme="css-variables"><code data-language="json" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-foreground)">{</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;title&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-string-expression)"> &quot;my schema&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;version&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-constant)"> 0</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;type&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-token-string-expression)"> &quot;object&quot;</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;properties&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-foreground)"> {}</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-token-keyword)">    &quot;encrypted&quot;</span><span style="color:var(--shiki-token-punctuation)">:</span><span style="color:var(--shiki-foreground)"> [</span></span>
<span data-line=""><span style="color:var(--shiki-token-string-expression)">        &quot;password&quot;</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    ]</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">}</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="new-dev-mode-plugin">New dev-mode plugin<a href="#new-dev-mode-plugin" class="hash-link" aria-label="Direct link to New dev-mode plugin" title="Direct link to New dev-mode plugin" translate="no">â€‹</a></h3>
<p>In the past we had stuff that is only wanted for development in the two plugins <code>error-messages</code> and <code>schema-check</code>.</p>
<p>Now we have a single plugin <code>dev-mode</code> that contains all these checks and development helper functions. I also moved many other checks out of the core-module into dev-mode.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { RxDBDevModePlugin } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb/plugins/dev-mode&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">addRxPlugin</span><span style="color:var(--shiki-foreground)">(RxDBDevModePlugin);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="new-migration-plugin">New migration plugin<a href="#new-migration-plugin" class="hash-link" aria-label="Direct link to New migration plugin" title="Direct link to New migration plugin" translate="no">â€‹</a></h3>
<p>The data migration was not used by all users of this project. Often it was easier to just wipe the local data store and let the client sync everything from the server. Because the migration has so much code, it is now in a separate plugin so that you do not have to ship this code to the clients if not necessary.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { RxDBMigrationPlugin } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb/plugins/migration&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">addRxPlugin</span><span style="color:var(--shiki-foreground)">(RxDBMigrationPlugin);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="rewritten-key-compression">Rewritten key-compression<a href="#rewritten-key-compression" class="hash-link" aria-label="Direct link to Rewritten key-compression" title="Direct link to Rewritten key-compression" translate="no">â€‹</a></h3>
<p>The key-compression logic was fully coded only for RxDB. This was a problem because it was not usable for other stuff and also badly tested. We had a known problem with nested arrays that caused much confusion because some queries did not find the correct documents.</p>
<p>I now created a npm-package <a href="https://github.com/pubkey/jsonschema-key-compression" target="_blank" rel="noopener noreferrer" class="">jsonschema-key-compression</a> that has cleaner code, better tests and can also be used for non-RxDB stuff.</p>
<p>If you used the key-compression in the past and have clients out there with old data, you have to find a way to migrate that data by using the json-import or other solutions depending on your project.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="rewritten-query-change-detection-to-event-reduce">Rewritten query-change-detection to event-reduce<a href="#rewritten-query-change-detection-to-event-reduce" class="hash-link" aria-label="Direct link to Rewritten query-change-detection to event-reduce" title="Direct link to Rewritten query-change-detection to event-reduce" translate="no">â€‹</a></h3>
<p>One big benefit of having a <a class="" href="/articles/realtime-database.html">realtime database</a> is that big performance optimizations can be done when the database knows a query is observed and the updated results are needed continuously. In the past this optimization was done by the internal <code>queryChangeDetection</code> which was a big tree of if-else-statements that hopefully worked. This was also the reason why queryChangeDetection was in beta mode and not enabled by default.</p>
<p>After months of research and testing I was able to create <a href="https://github.com/pubkey/event-reduce" target="_blank" rel="noopener noreferrer" class="">Event-Reduce: An algorithm to optimize database queries that run multiple times</a>. This JavaScript module contains an algorithm that is able to optimize realtime queries in a way that was not possible before. The algorithm is not RxDB specific and also heavily tested.</p>
<p>Instead of setting <code>queryChangeDetection</code> when creating a <code>RxDatabase</code>, you now set <code>eventReduce</code> which defaults to <code>true</code>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="find-and-findone-now-accepts-the-full-mango-query">find() and findOne() now accepts the full mango query<a href="#find-and-findone-now-accepts-the-full-mango-query" class="hash-link" aria-label="Direct link to find() and findOne() now accepts the full mango query" title="Direct link to find() and findOne() now accepts the full mango query" translate="no">â€‹</a></h3>
<p>In the past, only the selector of a query could be passed to <code>find()</code> and <code>findOne()</code> if you wanted to also do <code>sort</code>, <code>skip</code> or <code>limit</code>, you had to call additional functions like</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> query</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-token-constant)"> myRxCollection</span><span style="color:var(--shiki-token-function)">.find</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    age</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        $gt</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 10</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">})</span><span style="color:var(--shiki-token-function)">.sort</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-string-expression)">&#x27;name&#x27;</span><span style="color:var(--shiki-foreground)">)</span><span style="color:var(--shiki-token-function)">.skip</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-constant)">5</span><span style="color:var(--shiki-foreground)">)</span><span style="color:var(--shiki-token-function)">.limit</span><span style="color:var(--shiki-foreground)">(</span><span style="color:var(--shiki-token-constant)">10</span><span style="color:var(--shiki-foreground)">);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<p>Now you can pass the full query to the function call like</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">const</span><span style="color:var(--shiki-token-constant)"> query</span><span style="color:var(--shiki-token-keyword)"> =</span><span style="color:var(--shiki-token-constant)"> myRxCollection</span><span style="color:var(--shiki-token-function)">.find</span><span style="color:var(--shiki-foreground)">({</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    selector</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        age</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> {</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">            $gt</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 10</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">        }</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    }</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    sort</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-foreground)"> [{name</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-string-expression)"> &#x27;asc&#x27;</span><span style="color:var(--shiki-foreground)">}]</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    skip</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 5</span><span style="color:var(--shiki-token-punctuation)">,</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">    limit</span><span style="color:var(--shiki-token-keyword)">:</span><span style="color:var(--shiki-token-constant)"> 10</span></span>
<span data-line=""><span style="color:var(--shiki-foreground)">});</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="moved-query-builder-to-own-plugin">moved query builder to own plugin<a href="#moved-query-builder-to-own-plugin" class="hash-link" aria-label="Direct link to moved query builder to own plugin" title="Direct link to moved query builder to own plugin" translate="no">â€‹</a></h3>
<p>The query builder that allowed to create queries like <code>.where(&#x27;foo&#x27;).eq(&#x27;bar&#x27;)</code> etc. was not really used by many people. Most of the time it is better to just pass the full query as simple json object. Also the code for the query builder was big and increased the build size much more than its value added. Only some edge-cases where recursive query modification was needed made the query builder useful. If you still want to use the query builder, you have to import the plugin.</p>
<figure data-rehype-pretty-code-figure=""><div class="codeBlockContainer_Ckt0 theme-code-block" style="position:relative;--prism-background-color:var(--bg-color-code);--prism-color:var(--shiki-foreground)"><pre style="background-color:var(--shiki-background);color:var(--shiki-foreground)" tabindex="0" data-language="typescript" data-theme="css-variables"><code data-language="typescript" data-theme="css-variables" style="display:grid"><span data-line=""><span style="color:var(--shiki-token-keyword)">import</span><span style="color:var(--shiki-foreground)"> { RxDBQueryBuilderPlugin } </span><span style="color:var(--shiki-token-keyword)">from</span><span style="color:var(--shiki-token-string-expression)"> &#x27;rxdb/plugins/query-builder&#x27;</span><span style="color:var(--shiki-foreground)">;</span></span>
<span data-line=""><span style="color:var(--shiki-token-function)">addRxPlugin</span><span style="color:var(--shiki-foreground)">(RxDBQueryBuilderPlugin);</span></span></code></pre><div class="buttonGroup_M5ko"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_IEyt" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_TrPX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_cVMy"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></figure>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="refactored-rxchangeevent">Refactored RxChangeEvent<a href="#refactored-rxchangeevent" class="hash-link" aria-label="Direct link to Refactored RxChangeEvent" title="Direct link to Refactored RxChangeEvent" translate="no">â€‹</a></h3>
<p>The whole data structure of <code>RxChangeEvent</code> was way more complicated than it had to be. I refactored the whole class to be more simple. If you directly use <code>RxChangeEvent</code> in your project you have to adapt to these changes. Also the stream of <code>RxDatabase().$</code> will no longer emit the <code>COLLECTION</code> event when a new collection is created.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="internal-hash-is-now-using-a-salt">Internal hash() is now using a salt<a href="#internal-hash-is-now-using-a-salt" class="hash-link" aria-label="Direct link to Internal hash() is now using a salt" title="Direct link to Internal hash() is now using a salt" translate="no">â€‹</a></h3>
<p>The internal hash function was used to store hashes of database passwords to compare them and directly throw errors when the wrong password was used with an existing data set. This was dangerous because you could use rainbow tables or even <a href="https://www.google.com/search?q=e5e9fa1ba31ecd1ae84f75caaa474f3a663f05f4" target="_blank" rel="noopener noreferrer" class="">just google</a> the hash to find out the plain password. So now the internal hashing is using a salt to prevent these attacks. If you have used the encryption in the past, you have to migrate your internal schema storage.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="changed-default-of-rxdocumenttojson">Changed default of RxDocument.toJSON()<a href="#changed-default-of-rxdocumenttojson" class="hash-link" aria-label="Direct link to Changed default of RxDocument.toJSON()" title="Direct link to Changed default of RxDocument.toJSON()" translate="no">â€‹</a></h3>
<p>By default <code>RxDocument.toJSON()</code> always returned also the <code>_rev</code> field and the <code>_attachments</code>. This was confusing behavior which is why I changed the default to <code>RxDocument().toJSON(withRevAndAttachments = false)</code></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="typescript-380-or-newer-is-required">Typescript 3.8.0 or newer is required<a href="#typescript-380-or-newer-is-required" class="hash-link" aria-label="Direct link to Typescript 3.8.0 or newer is required" title="Direct link to Typescript 3.8.0 or newer is required" translate="no">â€‹</a></h3>
<p>Because RxDB and some subdependencies extensively use <code>export type ...</code> you now need typescript <code>3.8.0</code> or newer.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="graphql-replication-will-run-a-schema-validation-of-incoming-data">GraphQL replication will run a schema validation of incoming data<a href="#graphql-replication-will-run-a-schema-validation-of-incoming-data" class="hash-link" aria-label="Direct link to GraphQL replication will run a schema validation of incoming data" title="Direct link to GraphQL replication will run a schema validation of incoming data" translate="no">â€‹</a></h3>
<p>In dev-mode, the GraphQL-replication will run a schema validation of each document that comes from the server before it is saved to the database.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="internal-and-other-changes">Internal and other changes<a href="#internal-and-other-changes" class="hash-link" aria-label="Direct link to Internal and other changes" title="Direct link to Internal and other changes" translate="no">â€‹</a></h2>
<p>I refactored much internal stuff and moved much code out of the core into the specific plugins.</p>
<ul>
<li class="">Renamed <code>RxSchema.jsonID</code> to <code>RxSchema.jsonSchema</code></li>
<li class="">Moved remaining stuff of leader-election from core into the plugin</li>
<li class="">Merged multiple internal databases for metadata into one <code>internalStore</code></li>
<li class="">Removed many runtime type checks that now should be covered by typescript in buildtime</li>
<li class="">The GraphQL replication is now out of beta mode</li>
<li class="">Removed documentation examples for <code>require()</code> CommonJS loading</li>
<li class="">Removed <code>RxCollection.docChanges$()</code> because all events are from the docs</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="help-wanted">Help wanted<a href="#help-wanted" class="hash-link" aria-label="Direct link to Help wanted" title="Direct link to Help wanted" translate="no">â€‹</a></h2>
<p>RxDB is an open source project an heavily relies on the contribution of its users. There are some things that must be done, but I have no time for them.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="refactor-data-migrator">Refactor data-migrator<a href="#refactor-data-migrator" class="hash-link" aria-label="Direct link to Refactor data-migrator" title="Direct link to Refactor data-migrator" translate="no">â€‹</a></h3>
<p>The current implementation has some flaws and should be completely rewritten.</p>
<ul>
<li class="">It does not use pouchdb&#x27;s bulkDocs which is much faster</li>
<li class="">It could have been written without rxjs and with less code that is easier to understand</li>
<li class="">It does not migrate the revisions of documents which causes a problem when replication is used</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="add-e2e-tests-to-the-react-example">Add e2e tests to the react example<a href="#add-e2e-tests-to-the-react-example" class="hash-link" aria-label="Direct link to Add e2e tests to the react example" title="Direct link to Add e2e tests to the react example" translate="no">â€‹</a></h3>
<p>The <a href="https://github.com/pubkey/rxdb/tree/master/examples/react" target="_blank" rel="noopener noreferrer" class="">react example</a> has no end-to-end tests which is why the CI does not ensure that it works all the time. We should add some basic tests like we did for the other example projects.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="fix-pouchdb-bug-so-we-can-upgrade-pouchdb-find">Fix pouchdb bug so we can upgrade pouchdb-find<a href="#fix-pouchdb-bug-so-we-can-upgrade-pouchdb-find" class="hash-link" aria-label="Direct link to Fix pouchdb bug so we can upgrade pouchdb-find" title="Direct link to Fix pouchdb bug so we can upgrade pouchdb-find" translate="no">â€‹</a></h3>
<p>There is a <a href="https://github.com/pouchdb/pouchdb/issues/7810" target="_blank" rel="noopener noreferrer" class="">bug in pouchdb</a> that prevents the upgrade of <code>pouchdb-find</code>. This is why RxDB relies on an old version of <code>pouchdb-find</code> that also requires different sub-dependencies. This increases the build size a lot because for example we ship multiple version of <code>spark-md5</code> and others.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="about-the-future-of-rxdb">About the future of RxDB<a href="#about-the-future-of-rxdb" class="hash-link" aria-label="Direct link to About the future of RxDB" title="Direct link to About the future of RxDB" translate="no">â€‹</a></h2>
<p>At the moment RxDB is a realtime database based on pouchdb. In the future I want RxDB to be a wrapper around pull-based databases that also works with other source-dbs like mongoDB or PostgreSQL. As a start I defined the <code>RxStorage</code> interface and created a <code>RxStoragePouchdb</code> class that implements it and contains all pouchdb-specific logic. I want to move every direct storage usage into that interface so that later we can create other implementations of it for other source databases.</p></div></article><ul style="margin-top:25px;list-style-type:none"><li style="line-height:4;color:var(--expo-theme-text-secondary)">Was this page helpful?<div style="border-radius:3px;border-color:var(--fontColor-offwhite);border-style:solid;border-width:1px;vertical-align:middle;padding:5px;padding-left:8px;padding-right:8px;text-align:center;justify-content:center;display:inline-flex;margin-left:20px;cursor:pointer"><img src="/img/thumbs-up-white.svg" loading="lazy" height="14"></div><div style="border-radius:3px;border-color:var(--fontColor-offwhite);border-style:solid;border-width:1px;vertical-align:middle;padding:5px;padding-left:8px;padding-right:8px;text-align:center;justify-content:center;display:inline-flex;margin-left:20px;cursor:pointer;transform:scale(1, -1)"><img src="/img/thumbs-up-white.svg" loading="lazy" height="14"></div></li><li><a href="/chat/" target="_blank" style="color:var(--fontColor-offwhite)"><img src="/img/community-links/discord-logo.svg" style="padding-right:16px;height:18px;vertical-align:middle" loading="lazy">Ask a question on the forums about <!-- -->9.0.0</a></li></ul><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a href="/releases/10.0.0.html" class="padding-button" style="display:inline-flex;height:auto;flex-direction:row;justify-content:left;align-items:center;gap:10px;font-size:1rem;font-weight:500;cursor:pointer;text-align:left;transition:all 0.2s ease-in-out;line-height:initial;user-select:none;box-sizing:border-box;text-decoration:none;position:relative;overflow:hidden;background:transparent;color:#fff;border:2px solid #fff;padding-top:14px;padding-bottom:14px"><span style="font-size:80%;display:contents">Previous</span><br>Â« <!-- -->10.0.0</a><a href="/releases/8.0.0.html" class="padding-button" style="display:inline-flex;height:auto;flex-direction:row;justify-content:right;align-items:center;gap:10px;font-size:1rem;font-weight:500;cursor:pointer;text-align:right;transition:all 0.2s ease-in-out;line-height:initial;user-select:none;box-sizing:border-box;text-decoration:none;position:relative;overflow:hidden;background:transparent;color:#fff;border:2px solid #fff;padding-top:14px;padding-bottom:14px"><span style="font-size:80%;display:contents">Next</span><br>8.0.0<!-- --> Â»</a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#breaking-changes" class="table-of-contents__link toc-highlight">Breaking changes</a><ul><li><a href="#all-default-exports-have-been-removed" class="table-of-contents__link toc-highlight">All default exports have been removed</a></li><li><a href="#indexes-are-specified-at-the-top-level-of-the-schema-definition" class="table-of-contents__link toc-highlight">Indexes are specified at the top level of the schema definition</a></li><li><a href="#encrypted-fields-at-the-top-level-of-the-schema" class="table-of-contents__link toc-highlight">Encrypted fields at the top level of the schema</a></li><li><a href="#new-dev-mode-plugin" class="table-of-contents__link toc-highlight">New dev-mode plugin</a></li><li><a href="#new-migration-plugin" class="table-of-contents__link toc-highlight">New migration plugin</a></li><li><a href="#rewritten-key-compression" class="table-of-contents__link toc-highlight">Rewritten key-compression</a></li><li><a href="#rewritten-query-change-detection-to-event-reduce" class="table-of-contents__link toc-highlight">Rewritten query-change-detection to event-reduce</a></li><li><a href="#find-and-findone-now-accepts-the-full-mango-query" class="table-of-contents__link toc-highlight">find() and findOne() now accepts the full mango query</a></li><li><a href="#moved-query-builder-to-own-plugin" class="table-of-contents__link toc-highlight">moved query builder to own plugin</a></li><li><a href="#refactored-rxchangeevent" class="table-of-contents__link toc-highlight">Refactored RxChangeEvent</a></li><li><a href="#internal-hash-is-now-using-a-salt" class="table-of-contents__link toc-highlight">Internal hash() is now using a salt</a></li><li><a href="#changed-default-of-rxdocumenttojson" class="table-of-contents__link toc-highlight">Changed default of RxDocument.toJSON()</a></li><li><a href="#typescript-380-or-newer-is-required" class="table-of-contents__link toc-highlight">Typescript 3.8.0 or newer is required</a></li><li><a href="#graphql-replication-will-run-a-schema-validation-of-incoming-data" class="table-of-contents__link toc-highlight">GraphQL replication will run a schema validation of incoming data</a></li></ul></li><li><a href="#internal-and-other-changes" class="table-of-contents__link toc-highlight">Internal and other changes</a></li><li><a href="#help-wanted" class="table-of-contents__link toc-highlight">Help wanted</a><ul><li><a href="#refactor-data-migrator" class="table-of-contents__link toc-highlight">Refactor data-migrator</a></li><li><a href="#add-e2e-tests-to-the-react-example" class="table-of-contents__link toc-highlight">Add e2e tests to the react example</a></li><li><a href="#fix-pouchdb-bug-so-we-can-upgrade-pouchdb-find" class="table-of-contents__link toc-highlight">Fix pouchdb bug so we can upgrade pouchdb-find</a></li></ul></li><li><a href="#about-the-future-of-rxdb" class="table-of-contents__link toc-highlight">About the future of RxDB</a></li></ul></div></div></div></div></main></div></div></div><div class="block footer dark"><div style="display:flex;flex-wrap:wrap;gap:44px" class="content"><div class="half left"><span><a variant="text" href="/" class="footer-logo-button"><img src="/files/logo/logo_text_white.svg" alt="RxDB" loading="lazy" class="width-140-120"></a><div class="footer-community-links"><a variant="text" href="/newsletter/" target="_blank" aria-label="Newsletter"><svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="none"><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M22.5 13.5v-7a2 2 0 0 0-2-2h-16a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8"></path><path stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m22.5 7.5-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2.5 7.5M19.5 16.5v6M16.5 19.5h6"></path></svg></a><a variant="text" href="https://twitter.com/intent/user?screen_name=rxdbjs" target="_blank" aria-label="Twitter"><img src="/files/icons/twitter-blue.svg" alt="Twitter" loading="lazy"></a><a variant="text" href="https://www.linkedin.com/company/rxdb" target="_blank" aria-label="LinkedIn"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 21"><g clip-path="url(#a)"><path fill="#fff" d="M17.3 17.6h-3V13c0-1 0-2.5-1.6-2.5-1.5 0-1.8 1.2-1.8 2.5v4.7H8V8h2.9v1.3a3 3 0 0 1 2.9-1.6c3 0 3.6 2 3.6 4.6zM4.5 6.6a1.7 1.7 0 1 1 0-3.5 1.7 1.7 0 0 1 0 3.5m1.5 11H3V8h3zM18.8.4H1.5A1.5 1.5 0 0 0 0 1.8v17.4a1.5 1.5 0 0 0 1.5 1.4h17.3a1.5 1.5 0 0 0 1.5-1.4V1.8A1.5 1.5 0 0 0 18.8.4"></path></g><defs><clipPath id="a"><path fill="#fff" d="M0 .4h24v20.5H0z"></path></clipPath></defs></svg></a><a variant="text" href="/code/" target="_blank" aria-label="Github"><span class="navbar-icon-github" style="width:22px;height:22px;display:inline-block"></span></a><a variant="text" href="/chat/" target="_blank" aria-label="Discord"><span class="navbar-icon-discord" style="width:22px;height:22px;display:inline-block"></span></a></div></span></div><div class="half right" style="display:flex;flex:1"><div style="display:flex"><div class="footer-links min-width-180-135"><a variant="text" href="/overview.html" target="">Docs</a><a variant="text" href="/replication.html" target="">Sync</a><a variant="text" href="/rx-storage.html" target="">Storages</a><a variant="text" href="/premium/" target="_blank">Premium</a><a variant="text" href="/consulting/" target="_blank">Support</a></div><div class="footer-links min-width-180-135"><a variant="text" href="/#reviews" target="">Our Customers</a><a variant="text" href="/consulting#become-partner" target="">Become a Partner</a><a variant="text" href="/legal-notice/" target="_blank">Legal Notice</a></div></div></div></div></div><div class="navbar-line" style="display:block;z-index:10;height:1.5px;background-color:var(--color-top);border-top-right-radius:2px;border-bottom-right-radius:2px;width:100%"></div><div class="call-to-action-popup"><div class="close-popup"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20" fill="none" class="" style="transform:scale(1);transition:transform 0.2s ease-in-out;display:inline-block;cursor:pointer"><path d="M4 16H8L8 12H4L4 16Z" fill="white"></path><path d="M0 20H4L4 16H0L0 20Z" fill="white"></path><path d="M8 11.9999H12V7.99992H8L8 11.9999Z" fill="white"></path><path d="M4 8.00008H8L8 4.00008H4L4 8.00008Z" fill="white"></path><path d="M0 4.00004L4 4.00004L4 3.8147e-05L0 3.8147e-05L0 4.00004Z" fill="white"></path><path d="M16 11.9999H12V15.9999H16V11.9999Z" fill="white"></path><path d="M20 16H16V20H20V16Z" fill="white"></path><path d="M16 4.00004H12V8.00004H16V4.00004Z" fill="white"></path><path d="M20 0H16V4H20V0Z" fill="white"></path></svg></div></div></div>
</body>
</html>