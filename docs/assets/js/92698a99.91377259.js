"use strict";(self.webpackChunkrxdb=self.webpackChunkrxdb||[]).push([[4166],{6606:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>c,frontMatter:()=>d,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"rx-storage-indexeddb","title":"Instant Performance with IndexedDB RxStorage","description":"Choose IndexedDB RxStorage for unmatched speed and minimal build size. Perfect for fast-performing apps that demand reliable, lightweight data solutions.","source":"@site/docs/rx-storage-indexeddb.md","sourceDirName":".","slug":"/rx-storage-indexeddb.html","permalink":"/rx-storage-indexeddb.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Instant Performance with IndexedDB RxStorage","slug":"rx-storage-indexeddb.html","description":"Choose IndexedDB RxStorage for unmatched speed and minimal build size. Perfect for fast-performing apps that demand reliable, lightweight data solutions."},"sidebar":"tutorialSidebar","previous":{"title":"LocalStorage (Browser)","permalink":"/rx-storage-localstorage.html"},"next":{"title":"OPFS \ud83d\udc51 (Browser)","permalink":"/rx-storage-opfs.html"}}');var a=n(4848),s=n(8453);const d={title:"Instant Performance with IndexedDB RxStorage",slug:"rx-storage-indexeddb.html",description:"Choose IndexedDB RxStorage for unmatched speed and minimal build size. Perfect for fast-performing apps that demand reliable, lightweight data solutions."},o="IndexedDB RxStorage",i={},l=[{value:"IndexedDB performance comparison",id:"indexeddb-performance-comparison",level:2},{value:"Using the IndexedDB RxStorage",id:"using-the-indexeddb-rxstorage",level:2},{value:"Overwrite/Polyfill the native IndexedDB",id:"overwritepolyfill-the-native-indexeddb",level:2},{value:"Storage Buckets",id:"storage-buckets",level:2},{value:"Limitations of the IndexedDB RxStorage",id:"limitations-of-the-indexeddb-rxstorage",level:2}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"indexeddb-rxstorage",children:"IndexedDB RxStorage"})}),"\n",(0,a.jsxs)(t.p,{children:["The IndexedDB ",(0,a.jsx)(t.a,{href:"/rx-storage.html",children:"RxStorage"})," is based on plain IndexedDB and can be used in browsers, ",(0,a.jsx)(t.a,{href:"/electron-database.html",children:"electron"})," or hybrid apps.\nCompared to other browser based storages, the IndexedDB storage has the smallest write- and read latency, the fastest initial page load\nand the smallest build size. Only for big datasets (more than 10k documents), the ",(0,a.jsx)(t.a,{href:"/rx-storage-opfs.html",children:"OPFS storage"})," is better suited."]}),"\n",(0,a.jsxs)(t.p,{children:["While the IndexedDB API itself can be very slow, the IndexedDB storage uses many tricks and performance optimizations, some of which are described ",(0,a.jsx)(t.a,{href:"/slow-indexeddb.html",children:"here"}),". For example it uses custom index strings instead of the native IndexedDB indexes, batches cursor for faster bulk reads and many other improvements. The IndexedDB storage also operates on ",(0,a.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Write-ahead_logging",children:"Write-ahead logging"})," similar to SQLite, to improve write latency while still ensuring consistency on writes."]}),"\n",(0,a.jsx)(t.h2,{id:"indexeddb-performance-comparison",children:"IndexedDB performance comparison"}),"\n",(0,a.jsxs)(t.p,{children:["Here is some performance comparison with other storages. Compared to the non-memory storages like ",(0,a.jsx)(t.a,{href:"/rx-storage-opfs.html",children:"OPFS"})," and ",(0,a.jsx)(t.a,{href:"/rx-storage-sqlite.html",children:"WASM SQLite"}),". IndexedDB has the smallest build size and fastest write speed. Only OPFS is faster on queries over big datasets. See ",(0,a.jsx)(t.a,{href:"/rx-storage-performance.html",children:"performance comparison"})," page for a comparison with all storages."]}),"\n",(0,a.jsx)("p",{align:"center",children:(0,a.jsx)("img",{src:"./files/rx-storage-performance-browser.png",alt:"IndexedDB performance",width:"700"})}),"\n",(0,a.jsx)(t.h2,{id:"using-the-indexeddb-rxstorage",children:"Using the IndexedDB RxStorage"}),"\n",(0,a.jsxs)(t.p,{children:["To use the indexedDB storage you import it from the ",(0,a.jsx)(t.a,{href:"/premium/",children:"RxDB Premium \ud83d\udc51"})," npm module and use ",(0,a.jsx)(t.code,{children:"getRxStorageIndexedDB()"})," when creating the ",(0,a.jsx)(t.a,{href:"/rx-database.html",children:"RxDatabase"}),"."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"import {\n    createRxDatabase\n} from 'rxdb';\nimport {\n    getRxStorageIndexedDB\n} from 'rxdb-premium/plugins/storage-indexeddb';\n\nconst db = await createRxDatabase({\n    name: 'exampledb',\n    storage: getRxStorageIndexedDB({\n        /**\n         * For better performance, queries run with a batched cursor.\n         * You can change the batchSize to optimize the query time\n         * for specific queries.\n         * You should only change this value when you are also doing performance measurements.\n         * [default=300]\n         */\n        batchSize: 300\n    })\n});\n"})}),"\n",(0,a.jsx)(t.h2,{id:"overwritepolyfill-the-native-indexeddb",children:"Overwrite/Polyfill the native IndexedDB"}),"\n",(0,a.jsxs)(t.p,{children:["Node.js has no IndexedDB API. To still run the IndexedDB ",(0,a.jsx)(t.code,{children:"RxStorage"})," in Node.js, for example to run unit tests, you have to polyfill it.\nYou can do that by using the ",(0,a.jsx)(t.a,{href:"https://github.com/dumbmatter/fakeIndexedDB",children:"fake-indexeddb"})," module and pass it to the ",(0,a.jsx)(t.code,{children:"getRxStorageIndexedDB()"})," function."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"import { createRxDatabase } from 'rxdb';\nimport { getRxStorageIndexedDB } from 'rxdb-premium/plugins/storage-indexeddb';\n\n//> npm install fake-indexeddb --save\nconst fakeIndexedDB = require('fake-indexeddb');\nconst fakeIDBKeyRange = require('fake-indexeddb/lib/FDBKeyRange');\n\nconst db = await createRxDatabase({\n    name: 'exampledb',\n    storage: getRxStorageIndexedDB({\n        indexedDB: fakeIndexedDB,\n        IDBKeyRange: fakeIDBKeyRange\n    })\n});\n\n"})}),"\n",(0,a.jsx)(t.h2,{id:"storage-buckets",children:"Storage Buckets"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.a,{href:"https://wicg.github.io/storage-buckets/",children:"Storage Buckets API"}),' provides a way for sites to organize locally stored data into groupings called "storage buckets". This allows the user agent or sites to manage and delete buckets independently rather than applying the same treatment to all the data from a single origin. ',(0,a.jsx)(t.a,{href:"https://developer.chrome.com/docs/web-platform/storage-buckets?hl=en",children:"Read More"})]}),"\n",(0,a.jsxs)(t.p,{children:["To use different storage buckets with the RxDB IndexedDB Storage, you can use a function instead of a plain object when providing the  ",(0,a.jsx)(t.code,{children:"indexedDB"})," attribute:"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-ts",children:"import { createRxDatabase } from 'rxdb';\nimport { getRxStorageIndexedDB } from 'rxdb-premium/plugins/storage-indexeddb';\n\nconst db = await createRxDatabase({\n    name: 'exampledb',\n    storage: getRxStorageIndexedDB({\n        indexedDB: async(params) => {\n            const myStorageBucket = await navigator.storageBuckets.open('myApp-' + params.databaseName);\n            return myStorageBucket.indexedDB;\n        },\n        IDBKeyRange\n    })\n});\n"})}),"\n",(0,a.jsx)(t.h2,{id:"limitations-of-the-indexeddb-rxstorage",children:"Limitations of the IndexedDB RxStorage"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:["It is part of the ",(0,a.jsx)(t.a,{href:"/premium/",children:"RxDB Premium \ud83d\udc51"})," plugin that must be purchased. If you just need a storage that works in the browser and you do not have to care about performance, you can use the ",(0,a.jsx)(t.a,{href:"/rx-storage-localstorage.html",children:"LocalStorage storage"})," instead."]}),"\n",(0,a.jsxs)(t.li,{children:["The IndexedDB storage requires support for ",(0,a.jsx)(t.a,{href:"https://caniuse.com/indexeddb2",children:"IndexedDB v2"}),", it does not work on Internet Explorer."]}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>d,x:()=>o});var r=n(6540);const a={},s=r.createContext(a);function d(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:d(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);