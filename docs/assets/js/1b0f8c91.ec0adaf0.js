"use strict";(globalThis.webpackChunkrxdb=globalThis.webpackChunkrxdb||[]).push([[3129],{5787:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"backup","title":"Backup","description":"Easily back up your RxDB database to JSON files and attachments on the filesystem with the Backup Plugin - ensuring reliable Node.js data protection.","source":"@site/docs/backup.md","sourceDirName":".","slug":"/backup.html","permalink":"/backup.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Backup","slug":"backup.html","description":"Easily back up your RxDB database to JSON files and attachments on the filesystem with the Backup Plugin - ensuring reliable Node.js data protection."},"sidebar":"tutorialSidebar","previous":{"title":"Cleanup","permalink":"/cleanup.html"},"next":{"title":"Leader Election","permalink":"/leader-election.html"}}');var a=s(4848),r=s(8453);const t={title:"Backup",slug:"backup.html",description:"Easily back up your RxDB database to JSON files and attachments on the filesystem with the Backup Plugin - ensuring reliable Node.js data protection."},o="\ud83d\udce5 Backup Plugin",l={},c=[{value:"Installation",id:"installation",level:2},{value:"one-time backup",id:"one-time-backup",level:2},{value:"live backup",id:"live-backup",level:2},{value:"writeEvents$",id:"writeevents",level:2},{value:"Limitations",id:"limitations",level:2}];function d(e){const n={a:"a",code:"code",figure:"figure",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"-backup-plugin",children:"\ud83d\udce5 Backup Plugin"})}),"\n",(0,a.jsx)(n.p,{children:"With the backup plugin you can write the current database state and ongoing changes into folders on the filesystem.\nThe files are written in plain json together with their attachments so that you can read them out with any software or tools, without being bound to RxDB."}),"\n",(0,a.jsx)(n.p,{children:"This is useful to:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Consume the database content with other software that cannot replicate with RxDB"}),"\n",(0,a.jsx)(n.li,{children:"Write a backup of the database to a remote server by mounting the backup folder on the other server."}),"\n"]}),"\n",(0,a.jsxs)(n.p,{children:["The backup plugin works only in node.js, not in a browser. It is intended to have a backup strategy when using RxDB on the server side like with the ",(0,a.jsx)(n.a,{href:"/rx-server.html",children:"RxServer"}),". To run backups on the client side, you should use one of the ",(0,a.jsx)(n.a,{href:"/replication.html",children:"replication"})," plugins instead."]}),"\n",(0,a.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,a.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,a.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"javascript","data-theme":"css-variables",children:(0,a.jsxs)(n.code,{"data-language":"javascript","data-theme":"css-variables",style:{display:"grid"},children:[(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { addRxPlugin } "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb'"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { RxDBBackupPlugin } "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/backup'"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"addRxPlugin"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(RxDBBackupPlugin);"})]})]})})}),"\n",(0,a.jsx)(n.h2,{id:"one-time-backup",children:"one-time backup"}),"\n",(0,a.jsxs)(n.p,{children:["Write the whole database to the filesystem ",(0,a.jsx)(n.strong,{children:"once"}),".\nWhen called multiple times, it will continue from the last checkpoint and not start all over again."]}),"\n",(0,a.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,a.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"javascript","data-theme":"css-variables",children:(0,a.jsxs)(n.code,{"data-language":"javascript","data-theme":"css-variables",style:{display:"grid"},children:[(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupOptions"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // if false, a one-time backup will be written"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    live"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" false"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // the folder where the backup will be stored"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    directory"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '/my-backup-folder/'"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // if true, attachments will also be saved"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    attachments"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" myDatabase"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".backup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(backupOptions);"})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".awaitInitialBackup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"();"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// call again to run from the last checkpoint"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState2"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" myDatabase"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".backup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(backupOptions);"})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState2"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".awaitInitialBackup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"();"})]})]})})}),"\n",(0,a.jsx)(n.h2,{id:"live-backup",children:"live backup"}),"\n",(0,a.jsxs)(n.p,{children:["When ",(0,a.jsx)(n.code,{children:"live: true"})," is set, the backup will write all ongoing changes to the backup directory."]}),"\n",(0,a.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,a.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"javascript","data-theme":"css-variables",children:(0,a.jsxs)(n.code,{"data-language":"javascript","data-theme":"css-variables",style:{display:"grid"},children:[(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupOptions"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // set live: true to have an ongoing backup"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    live"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    directory"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '/my-backup-folder/'"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    attachments"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" myDatabase"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".backup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(backupOptions);"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// you can still await the initial backup write, but further changes will still be processed."})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".awaitInitialBackup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"();"})]})]})})}),"\n",(0,a.jsx)(n.h2,{id:"writeevents",children:"writeEvents$"}),"\n",(0,a.jsxs)(n.p,{children:["You can listen to the ",(0,a.jsx)(n.code,{children:"writeEvents$"})," Observable to get notified about written backup files."]}),"\n",(0,a.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,a.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"javascript","data-theme":"css-variables",children:(0,a.jsxs)(n.code,{"data-language":"javascript","data-theme":"css-variables",style:{display:"grid"},children:[(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupOptions"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    live"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" false"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    directory"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '/my-backup-folder/'"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    attachments"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"}"})}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" myDatabase"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".backup"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(backupOptions);"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,a.jsxs)(n.span,{"data-line":"",children:[(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" subscription"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" backupState"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"writeEvents$"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".subscribe"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(writeEvent "}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" console"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".dir"}),(0,a.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(writeEvent));"})]}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"/*"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"> {"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    collectionName: 'humans',"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    documentId: 'foobar',"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    files: ["})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        '/my-backup-folder/foobar/document.json'"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    ],"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    deleted: false"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"}"})}),"\n",(0,a.jsx)(n.span,{"data-line":"",children:(0,a.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"*/"})})]})})}),"\n",(0,a.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"It is currently not possible to import from a written backup. If you need this functionality, please make a pull request."}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(6540);const a={},r=i.createContext(a);function t(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);