"use strict";(self.webpackChunkrxdb=self.webpackChunkrxdb||[]).push([[1018],{574:(e,t,r)=>{r.d(t,{Tj:()=>Vr,C3:()=>Zr,IA:()=>Ur});var a=r(7329);function n(e,t){var r=e.get(t);if(void 0===r)throw new Error("missing value from map "+t);return r}function i(e,t,r,a){var n=e.get(t);return void 0===n?(n=r(),e.set(t,n)):a&&a(n),n}function s(e){return Object.assign({},e)}function o(e,t){if(void 0===t&&(t=!1),!e)return e;if(!t&&Array.isArray(e))return e.sort(((e,t)=>"string"==typeof e&&"string"==typeof t?e.localeCompare(t):"object"==typeof e?1:-1)).map((e=>o(e,t)));if("object"==typeof e&&!Array.isArray(e)){var r={};return Object.keys(e).sort(((e,t)=>e.localeCompare(t))).forEach((a=>{r[a]=o(e[a],t)})),r}return e}var c=function e(t){if(!t)return t;if(null===t||"object"!=typeof t)return t;if(Array.isArray(t)){for(var r=new Array(t.length),a=r.length;a--;)r[a]=e(t[a]);return r}var n={};for(var i in t)n[i]=e(t[i]);return n};function l(e,t,r){return Object.defineProperty(e,t,{get:function(){return r}}),r}var u=e=>{var t=typeof e;return null!==e&&("object"===t||"function"===t)},h=new Set(["__proto__","prototype","constructor"]),d=new Set("0123456789");function m(e){var t=[],r="",a="start",n=!1;for(var i of e)switch(i){case"\\":if("index"===a)throw new Error("Invalid character in an index");if("indexEnd"===a)throw new Error("Invalid character after an index");n&&(r+=i),a="property",n=!n;break;case".":if("index"===a)throw new Error("Invalid character in an index");if("indexEnd"===a){a="property";break}if(n){n=!1,r+=i;break}if(h.has(r))return[];t.push(r),r="",a="property";break;case"[":if("index"===a)throw new Error("Invalid character in an index");if("indexEnd"===a){a="index";break}if(n){n=!1,r+=i;break}if("property"===a){if(h.has(r))return[];t.push(r),r=""}a="index";break;case"]":if("index"===a){t.push(Number.parseInt(r,10)),r="",a="indexEnd";break}if("indexEnd"===a)throw new Error("Invalid character after an index");default:if("index"===a&&!d.has(i))throw new Error("Invalid character in an index");if("indexEnd"===a)throw new Error("Invalid character after an index");"start"===a&&(a="property"),n&&(n=!1,r+="\\"),r+=i}switch(n&&(r+="\\"),a){case"property":if(h.has(r))return[];t.push(r);break;case"index":throw new Error("Index was not closed");case"start":t.push("")}return t}function p(e,t){if("number"!=typeof t&&Array.isArray(e)){var r=Number.parseInt(t,10);return Number.isInteger(r)&&e[r]===e[t]}return!1}function f(e,t){if(p(e,t))throw new Error("Cannot use string index")}function v(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!t.includes(".")&&!t.includes("["))return e[t];if(!u(e)||"string"!=typeof t)return void 0===r?e:r;var a=m(t);if(0===a.length)return r;for(var n=0;n<a.length;n++){var i=a[n];if(null==(e=p(e,i)?n===a.length-1?void 0:null:e[i])){if(n!==a.length-1)return r;break}}return void 0===e?r:e}function g(e,t,r){if(Array.isArray(t)&&(t=t.join(".")),!u(e)||"string"!=typeof t)return e;for(var a=e,n=m(t),i=0;i<n.length;i++){var s=n[i];f(e,s),i===n.length-1?e[s]=r:u(e[s])||(e[s]="number"==typeof n[i+1]?[]:{}),e=e[s]}return a}var y=r(7810),b=r(3836),w=r(1449),x=r(6343),D={isDevMode:()=>!1,deepFreezeWhenDevMode:e=>e,tunnelErrorMessage:e=>"RxDB Error-Code "+e+".\n        Error messages are not included in RxDB core to reduce build size.\n        - To find out what this error means, either use the dev-mode-plugin https://rxdb.info/dev-mode.html\n        - or search for the error code here: https://github.com/pubkey/rxdb/search?q="+e+"\n        "};function k(e,t,r){return"RxError ("+t+"):\n"+e+"\n"+function(e){var t="";return 0===Object.keys(e).length?t:(t+="Given parameters: {\n",t+=Object.keys(e).map((t=>{var r="[object Object]";try{r="errors"===t?e[t].map((e=>JSON.stringify(e,Object.getOwnPropertyNames(e)))):JSON.stringify(e[t],(function(e,t){return void 0===t?null:t}),2)}catch(a){}return t+":"+r})).join("\n"),t+="}")}(r)}var j=function(e){function t(t,r,a){var n;void 0===a&&(a={});var i=k(r,t,a);return(n=e.call(this,i)||this).code=t,n.message=i,n.parameters=a,n.rxdb=!0,n}return(0,w.A)(t,e),t.prototype.toString=function(){return this.message},(0,b.A)(t,[{key:"name",get:function(){return"RxError ("+this.code+")"}},{key:"typeError",get:function(){return!1}}])}((0,x.A)(Error)),_=function(e){function t(t,r,a){var n;void 0===a&&(a={});var i=k(r,t,a);return(n=e.call(this,i)||this).code=t,n.message=i,n.parameters=a,n.rxdb=!0,n}return(0,w.A)(t,e),t.prototype.toString=function(){return this.message},(0,b.A)(t,[{key:"name",get:function(){return"RxTypeError ("+this.code+")"}},{key:"typeError",get:function(){return!0}}])}((0,x.A)(TypeError));function I(e,t){return new j(e,D.tunnelErrorMessage(e),t)}function R(e,t){return new _(e,D.tunnelErrorMessage(e),t)}function E(e){return!(!e||409!==e.status)&&e}var S={409:"document write conflict",422:"schema validation error",510:"attachment data missing"};var O=/\./g,C="abcdefghijklmnopqrstuvwxyz";function N(e){void 0===e&&(e=10);for(var t="",r=0;r<e;r++)t+=C.charAt(Math.floor(Math.random()*C.length));return t}function P(e){return(e+="").charAt(0).toUpperCase()+e.substr(1)}function $(e){for(;"."===e.charAt(0);)e=e.substr(1);for(;"."===e.slice(-1);)e=e.slice(0,-1);return e}var A=1;function T(){return{lwt:A}}function B(e,t){var r=t;return v(e,r=$(r="properties."+(r=r.replace(O,".properties."))))}function q(e){return"string"==typeof e?e:e.key}function M(e,t){if("string"==typeof e.primaryKey)return t[e.primaryKey];var r=e.primaryKey;return r.fields.map((e=>{var r=v(t,e);if(void 0===r)throw I("DOC18",{args:{field:e,documentData:t}});return r})).join(r.separator)}function W(e){var t=q((e=s(e)).primaryKey);e.properties=s(e.properties),e.additionalProperties=!1,Object.prototype.hasOwnProperty.call(e,"keyCompression")||(e.keyCompression=!1),e.indexes=e.indexes?e.indexes.slice(0):[],e.required=e.required?e.required.slice(0):[],e.encrypted=e.encrypted?e.encrypted.slice(0):[],e.properties._rev={type:"string",minLength:1},e.properties._attachments={type:"object"},e.properties._deleted={type:"boolean"},e.properties._meta=L,e.required=e.required?e.required.slice(0):[],e.required.push("_deleted"),e.required.push("_rev"),e.required.push("_meta"),e.required.push("_attachments");var r=F(e);(0,y.Hb)(e.required,r),e.required=e.required.filter((e=>!e.includes("."))).filter(((e,t,r)=>r.indexOf(e)===t)),e.version=e.version||0;var a=e.indexes.map((e=>{var r=(0,y.k_)(e)?e.slice(0):[e];return r.includes(t)||r.push(t),"_deleted"!==r[0]&&r.unshift("_deleted"),r}));0===a.length&&a.push(function(e){return["_deleted",e]}(t)),a.push(["_meta.lwt",t]),e.internalIndexes&&e.internalIndexes.map((e=>{a.push(e)}));var n=new Set;return a.filter((e=>{var t=e.join(",");return!n.has(t)&&(n.add(t),!0)})),e.indexes=a,e}var L={type:"object",properties:{lwt:{type:"number",minimum:A,maximum:1e15,multipleOf:.01}},additionalProperties:!0,required:["lwt"]};function F(e){var t=Object.keys(e.properties).filter((t=>e.properties[t].final)),r=q(e.primaryKey);return t.push(r),"string"!=typeof e.primaryKey&&e.primaryKey.fields.forEach((e=>t.push(e))),t}var Q="docs",H="changes",z="attachments",K="dexie",U=new Map,Z=new Map;var V="__";function J(e){var t=e.split(".");if(t.length>1)return t.map((e=>J(e))).join(".");if(e.startsWith("|")){var r=e.substring(1);return V+r}return e}function G(e){var t=e.split(".");return t.length>1?t.map((e=>G(e))).join("."):e.startsWith(V)?"|"+e.substring(V.length):e}function Y(e,t){return t?(t=ee(t=s(t)),e.forEach((e=>{var r=v(t,e);g(t,e,r?"1":"0")})),t):t}function X(e,t){return t?(t=te(t=s(t)),e.forEach((e=>{var r=v(t,e);g(t,e,"1"===r)})),t):t}function ee(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>ee(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((e=>{let[r,a]=e;"object"==typeof a&&(a=ee(a)),t[J(r)]=a})),t}}function te(e){if(!e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e))return e.map((e=>te(e)));if("object"==typeof e){var t={};return Object.entries(e).forEach((r=>{let[a,n]=r;("object"==typeof n||Array.isArray(e))&&(n=te(n)),t[G(a)]=n})),t}}function re(e){var t=[],r=q(e.primaryKey);t.push([r]),t.push(["_deleted",r]),e.indexes&&e.indexes.forEach((e=>{var r=(0,y.$r)(e);t.push(r)})),t.push(["_meta.lwt",r]),t.push(["_meta.lwt"]);var a=(t=t.map((e=>e.map((e=>J(e)))))).map((e=>1===e.length?e[0]:"["+e.join("+")+"]"));return(a=a.filter(((e,t,r)=>r.indexOf(e)===t))).join(", ")}async function ae(e,t){var r=await e;return(await r.dexieTable.bulkGet(t)).map((e=>X(r.booleanIndexes,e)))}function ne(e,t){return e+"||"+t}function ie(e){var t=new Set,r=[];return e.indexes?(e.indexes.forEach((a=>{(0,y.$r)(a).forEach((a=>{t.has(a)||(t.add(a),"boolean"===B(e,a).type&&r.push(a))}))})),r.push("_deleted"),(0,y.jw)(r)):r}var se=r(9092),oe=r(5734),ce={},le=r(1007);var ue="undefined"!=typeof crypto&&void 0!==crypto.subtle&&"function"==typeof crypto.subtle.digest?async function(e){var t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.prototype.map.call(new Uint8Array(r),(e=>("00"+e.toString(16)).slice(-2))).join("")}:function(e){return Promise.resolve((0,le.sc)(e))},he=r(3337),de=String.fromCharCode(65535),me=Number.MIN_SAFE_INTEGER;function pe(e,t){var r=t.selector,a=e.indexes?e.indexes.slice(0):[];t.index&&(a=[t.index]);var n=!!t.sort.find((e=>"desc"===Object.values(e)[0])),i=new Set;Object.keys(r).forEach((t=>{var a=B(e,t);a&&"boolean"===a.type&&Object.prototype.hasOwnProperty.call(r[t],"$eq")&&i.add(t)}));var s,o=t.sort.map((e=>Object.keys(e)[0])).filter((e=>!i.has(e))).join(","),c=-1;if(a.forEach((e=>{var a=!0,l=!0,u=e.map((e=>{var t=r[e],n=t?Object.keys(t):[],i={};t&&n.length?n.forEach((e=>{if(fe.has(e)){var r=function(e,t){switch(e){case"$eq":return{startKey:t,endKey:t,inclusiveEnd:!0,inclusiveStart:!0};case"$lte":return{endKey:t,inclusiveEnd:!0};case"$gte":return{startKey:t,inclusiveStart:!0};case"$lt":return{endKey:t,inclusiveEnd:!1};case"$gt":return{startKey:t,inclusiveStart:!1};default:throw new Error("SNH")}}(e,t[e]);i=Object.assign(i,r)}})):i={startKey:l?me:de,endKey:a?de:me,inclusiveStart:!0,inclusiveEnd:!0};return void 0===i.startKey&&(i.startKey=me),void 0===i.endKey&&(i.endKey=de),void 0===i.inclusiveStart&&(i.inclusiveStart=!0),void 0===i.inclusiveEnd&&(i.inclusiveEnd=!0),l&&!i.inclusiveStart&&(l=!1),a&&!i.inclusiveEnd&&(a=!1),i})),h=u.map((e=>e.startKey)),d=u.map((e=>e.endKey)),m={index:e,startKeys:h,endKeys:d,inclusiveEnd:a,inclusiveStart:l,sortSatisfiedByIndex:!n&&o===e.filter((e=>!i.has(e))).join(","),selectorSatisfiedByIndex:ye(e,t.selector,h,d)},p=function(e,t,r){var a=0,n=e=>{e>0&&(a+=e)},i=10,s=(0,y.Sd)(r.startKeys,(e=>e!==me&&e!==de));n(s*i);var o=(0,y.Sd)(r.startKeys,(e=>e!==de&&e!==me));n(o*i);var c=(0,y.Sd)(r.startKeys,((e,t)=>e===r.endKeys[t]));n(c*i*1.5);var l=r.sortSatisfiedByIndex?5:0;return n(l),a}(0,0,m);(p>=c||t.index)&&(c=p,s=m)})),!s)throw I("SNH",{query:t});return s}var fe=new Set(["$eq","$gt","$gte","$lt","$lte"]),ve=new Set(["$eq","$gt","$gte"]),ge=new Set(["$eq","$lt","$lte"]);function ye(e,t,r,a){var n=Object.entries(t).find((t=>{let[r,a]=t;return!e.includes(r)||Object.entries(a).find((e=>{let[t,r]=e;return!fe.has(t)}))}));if(n)return!1;if(t.$and||t.$or)return!1;var i=[],s=new Set;for(var[o,c]of Object.entries(t)){if(!e.includes(o))return!1;var l=Object.keys(c).filter((e=>ve.has(e)));if(l.length>1)return!1;var u=l[0];if(u&&s.add(o),"$eq"!==u){if(i.length>0)return!1;i.push(u)}}var h=[],d=new Set;for(var[m,p]of Object.entries(t)){if(!e.includes(m))return!1;var f=Object.keys(p).filter((e=>ge.has(e)));if(f.length>1)return!1;var v=f[0];if(v&&d.add(m),"$eq"!==v){if(h.length>0)return!1;h.push(v)}}var g=0;for(var y of e){for(var b of[s,d]){if(!b.has(y)&&b.size>0)return!1;b.delete(y)}if(r[g]!==a[g]&&s.size>0&&d.size>0)return!1;g++}return!0}var be=r(744),we=r(2779),xe=r(1692),De=r(4903),ke=r(7705),je=r(2403),_e=r(6776),Ie=r(6950),Re=r(6823),Ee=!1;function Se(e){return Ee||((0,we.DZ)(we.hu.PIPELINE,{$sort:De.xF,$project:De.C2}),(0,we.DZ)(we.hu.QUERY,{$and:ke.a6,$eq:je.XV,$elemMatch:Ie.Jy,$exists:Re.P,$gt:je.MR,$gte:je.fy,$in:je.oZ,$lt:je.NV,$lte:je.Q_,$ne:je.C5,$nin:je.GU,$mod:_e.Pp,$nor:ke.q3,$not:ke.En,$or:ke.sU,$regex:_e.WP,$size:Ie.Ig,$type:Re.T}),Ee=!0),new xe.X(e)}function Oe(e,t){var r=q(e.primaryKey);t=s(t);var a=c(t);if("number"!=typeof a.skip&&(a.skip=0),a.selector?(a.selector=a.selector,Object.entries(a.selector).forEach((e=>{let[t,r]=e;"object"==typeof r&&null!==r||(a.selector[t]={$eq:r})}))):a.selector={},a.index){var n=(0,y.$r)(a.index);n.includes(r)||n.push(r),a.index=n}if(a.sort)a.sort.find((e=>{return t=e,Object.keys(t)[0]===r;var t}))||(a.sort=a.sort.slice(0),a.sort.push({[r]:"asc"}));else if(a.index)a.sort=a.index.map((e=>({[e]:"asc"})));else{if(e.indexes){var i=new Set;Object.entries(a.selector).forEach((e=>{let[t,r]=e;("object"!=typeof r||null===r||!!Object.keys(r).find((e=>fe.has(e))))&&i.add(t)}));var o,l=-1;e.indexes.forEach((e=>{var t=(0,y.k_)(e)?e:[e],r=t.findIndex((e=>!i.has(e)));r>0&&r>l&&(l=r,o=t)})),o&&(a.sort=o.map((e=>({[e]:"asc"}))))}a.sort||(a.sort=[{[r]:"asc"}])}return a}function Ce(e,t){if(!t.sort)throw I("SNH",{query:t});var r=[];t.sort.forEach((e=>{var t,a,n,i=Object.keys(e)[0],s=Object.values(e)[0];r.push({key:i,direction:s,getValueFn:(t=i,a=t.split("."),n=a.length,1===n?e=>e[t]:e=>{for(var t=e,r=0;r<n;++r)if(void 0===(t=t[a[r]]))return t;return t})})}));return(e,t)=>{for(var a=0;a<r.length;++a){var n=r[a],i=n.getValueFn(e),s=n.getValueFn(t);if(i!==s)return"asc"===n.direction?(0,be.UD)(i,s):(0,be.UD)(s,i)}}}function Ne(e,t){if(!t.sort)throw I("SNH",{query:t});var r=Se(t.selector);return e=>r.test(e)}async function Pe(e,t){var r=await e.exec();return r?Array.isArray(r)?Promise.all(r.map((e=>t(e)))):await t(r):null}function $e(e){return e===me?-1/0:e}function Ae(e,t,r){return e.includes(t)?r===de||!0===r?"1":"0":r}function Te(e,t,r){if(!r){if("undefined"==typeof window)throw new Error("IDBKeyRange missing");r=window.IDBKeyRange}var a=t.startKeys.map(((r,a)=>{var n=t.index[a];return Ae(e,n,r)})).map($e),n=t.endKeys.map(((r,a)=>{var n=t.index[a];return Ae(e,n,r)})).map($e);return r.bound(a,n,!t.inclusiveStart,!t.inclusiveEnd)}async function Be(e,t){var r=await e.internals,a=t.query,n=a.skip?a.skip:0,i=n+(a.limit?a.limit:1/0),s=t.queryPlan,o=!1;s.selectorSatisfiedByIndex||(o=Ne(e.schema,t.query));var c=Te(r.booleanIndexes,s,r.dexieDb._options.IDBKeyRange),l=s.index,u=[];if(await r.dexieDb.transaction("r",r.dexieTable,(async e=>{var t,a=e.idbtrans.objectStore(Q);t="["+l.map((e=>J(e))).join("+")+"]";var n=a.index(t).openCursor(c);await new Promise((e=>{n.onsuccess=function(t){var a=t.target.result;if(a){var n=X(r.booleanIndexes,a.value);o&&!o(n)||u.push(n),s.sortSatisfiedByIndex&&u.length===i?e():a.continue()}else e()}}))})),!s.sortSatisfiedByIndex){var h=Ce(e.schema,t.query);u=u.sort(h)}return{documents:u=u.slice(n,i)}}function qe(e){for(var t="",r=0;r<e.length;r++){var a=e[r];if("-"===a)return parseInt(t,10);t+=a}throw new Error("malformatted revision: "+e)}function Me(e,t){return(t?qe(t._rev)+1:1)+"-"+e}var We={preAddRxPlugin:[],preCreateRxDatabase:[],createRxDatabase:[],preCreateRxCollection:[],createRxCollection:[],createRxState:[],postDestroyRxCollection:[],postRemoveRxCollection:[],preCreateRxSchema:[],createRxSchema:[],preCreateRxQuery:[],prePrepareQuery:[],createRxDocument:[],postCreateRxDocument:[],preCreateRxStorageInstance:[],preStorageWrite:[],preMigrateDocument:[],postMigrateDocument:[],preDestroyRxDatabase:[],postRemoveRxDatabase:[],preReplicationMasterWrite:[],preReplicationMasterWriteDocumentsHandle:[]};function Le(e,t){We[e].length>0&&We[e].forEach((e=>e(t)))}function Fe(e,t){return Promise.all(We[e].map((e=>e(t))))}var Qe="_rxdb_internal";async function He(e,t){var r=(await e.findDocumentsById([t],!1))[0];return r||void 0}async function ze(e,t,r){var a=await e.bulkWrite([t],r);if(a.error.length>0)throw a.error[0];return a.success[0]}function Ke(e,t,r,a){if(a)throw 409===a.status?I("CONFLICT",{collection:e.name,id:t,writeError:a,data:r}):422===a.status?I("VD2",{collection:e.name,id:t,writeError:a,data:r}):a}function Ue(e){return{previous:e.previous,document:Ze(e.document)}}function Ze(e){if(!e._attachments||0===Object.keys(e._attachments).length)return e;var t=s(e);return t._attachments={},Object.entries(e._attachments).forEach((e=>{let[r,a]=e;var n,i,s;t._attachments[r]=(s=(n=a).data)?{length:(i=s,atob(i).length),digest:n.digest,type:n.type}:n})),t}function Ve(e){return Object.assign({},e,{_meta:s(e._meta)})}function Je(e,t,r){D.deepFreezeWhenDevMode(r);var a={originalStorageInstance:t,schema:t.schema,internals:t.internals,collectionName:t.collectionName,databaseName:t.databaseName,options:t.options,bulkWrite(r,a){for(var n=e.token,i=new Array(r.length),s=(0,oe.t)(),o=0;o<r.length;o++){var c=r[o],l=Ve(c.document);l._meta.lwt=s;var u=c.previous;l._rev=Me(n,u),i[o]={document:l,previous:u}}return Le("preStorageWrite",{storageInstance:this.originalStorageInstance,rows:i}),e.lockedRun((()=>t.bulkWrite(i,a))).then((r=>{var n={error:[],success:r.success.slice(0)},i=0===r.error.length?[]:r.error.filter((e=>!(409!==e.status||e.writeRow.previous||e.writeRow.document._deleted||!(0,he.ZN)(e.documentInDb)._deleted)||(n.error.push(e),!1)));if(i.length>0){var s=i.map((t=>({previous:t.documentInDb,document:Object.assign({},t.writeRow.document,{_rev:Me(e.token,t.documentInDb)})})));return e.lockedRun((()=>t.bulkWrite(s,a))).then((e=>((0,y.Hb)(n.error,e.error),(0,y.Hb)(n.success,e.success),n)))}return r}))},query:r=>e.lockedRun((()=>t.query(r))),count:r=>e.lockedRun((()=>t.count(r))),findDocumentsById:(r,a)=>e.lockedRun((()=>t.findDocumentsById(r,a))),getAttachmentData:(r,a,n)=>e.lockedRun((()=>t.getAttachmentData(r,a,n))),getChangedDocumentsSince:t.getChangedDocumentsSince?(r,a)=>e.lockedRun((()=>t.getChangedDocumentsSince((0,he.ZN)(r),a))):void 0,cleanup:r=>e.lockedRun((()=>t.cleanup(r))),remove:()=>(e.storageInstances.delete(a),e.lockedRun((()=>t.remove()))),close:()=>(e.storageInstances.delete(a),e.lockedRun((()=>t.close()))),changeStream:()=>t.changeStream(),conflictResultionTasks:()=>t.conflictResultionTasks(),resolveConflictResultionTask(e){if(e.output.isEqual)return t.resolveConflictResultionTask(e);var r=s(Object.assign({},e.output.documentData,{_meta:T(),_rev:"",_attachments:{}}));return delete r._meta,delete r._rev,delete r._attachments,t.resolveConflictResultionTask({id:e.id,output:{isEqual:!1,documentData:r}})}};return e.storageInstances.add(a),a}var Ge=r(3561),Ye=r(703),Xe=new Map;function et(e,t){var r=Xe.get(e);if(r)return r.refs.delete(t),0===r.refs.size?(Xe.delete(e),r.bc.close()):void 0}function tt(e,t,r,a){if(t.multiInstance){var n=a||function(e,t,r,a){var n=Xe.get(t);return n||(n={bc:new Ye.X2(["RxDB:",e,r].join("|")),refs:new Set},Xe.set(t,n)),n.refs.add(a),n.bc}(e,t.databaseInstanceToken,r.databaseName,r),i=new se.B,s=r=>{r.storageName===e&&r.databaseName===t.databaseName&&r.collectionName===t.collectionName&&r.version===t.schema.version&&i.next(r.eventBulk)};n.addEventListener("message",s);var o=r.changeStream(),c=!1,l=o.subscribe((r=>{c||n.postMessage({storageName:e,databaseName:t.databaseName,collectionName:t.collectionName,version:t.schema.version,eventBulk:r})}));r.changeStream=function(){return i.asObservable().pipe((0,Ge.X)(o))};var u=r.close.bind(r);r.close=async function(){return c=!0,l.unsubscribe(),n.removeEventListener("message",s),a||await et(t.databaseInstanceToken,r),u()};var h=r.remove.bind(r);r.remove=async function(){return c=!0,l.unsubscribe(),n.removeEventListener("message",s),a||await et(t.databaseInstanceToken,r),h()}}}var rt=(0,oe.t)(),at="dexieTestMetaField",nt=!1,it=function(){function e(e,t,r,a,n,i,s,o){this.changes$=new se.B,this.instanceId=rt++,this.storage=e,this.databaseName=t,this.collectionName=r,this.schema=a,this.internals=n,this.options=i,this.settings=s,this.devMode=o,this.primaryPath=q(this.schema.primaryKey)}var t=e.prototype;return t.bulkWrite=async function(e,t){ot(this),nt||ce.premium&&"string"==typeof ce.premium&&"6da4936d1425ff3a5c44c02342c6daf791d266be3ae8479b8ec59e261df41b93"===await ue(ce.premium)||console.warn(["-------------- RxDB Open Core RxStorage -------------------------------","You are using the free Dexie.js based RxStorage implementation from RxDB https://rxdb.info/rx-storage-dexie.html ","While this is a great option, we want to let you know that there are faster storage solutions available in our premium plugins.","For professional users and production environments, we highly recommend considering these premium options to enhance performance and reliability."," https://rxdb.info/premium ","If you already purchased premium access you can disable this log by calling the setPremiumFlag() function from rxdb-premium/plugins/shared.","---------------------------------------------------------------------"].join("\n")),nt=!0,e.forEach((e=>{if(!e.document._rev||e.previous&&!e.previous._rev)throw I("SNH",{args:{row:e}});if(this.devMode&&e.previous&&(!e.previous._meta[at]||e.previous._meta[at]!==e.previous._rev))throw console.dir(e),new Error("missing or wrong _meta."+at)}));var r=await this.internals,a={success:[],error:[]};this.devMode&&(e=e.map((e=>{var t=Ve(e.document);return t._meta[at]=t._rev,{previous:e.previous,document:t}})));var n,i=e.map((e=>e.document[this.primaryPath]));if(await r.dexieDb.transaction("rw",r.dexieTable,r.dexieAttachmentsTable,(async()=>{var s=new Map;(await ae(this.internals,i)).forEach((e=>{var t=e;return t&&s.set(t[this.primaryPath],t),t})),n=function(e,t,r,a,n,i,s){for(var o,c=!!e.schema.attachments,l=[],u=[],h=[],d={id:N(10),events:[],checkpoint:null,context:n,startTime:(0,oe.t)(),endTime:0},m=d.events,p=[],f=[],v=[],g=r.size>0,y=a.length,b=function(){var e,n=a[w],d=n.document,y=n.previous,b=d[t],x=d._deleted,D=y&&y._deleted,k=void 0;if(g&&(k=r.get(b)),k){var j=k._rev;if(!y||y&&j!==y._rev){var _={isError:!0,status:409,documentId:b,writeRow:n,documentInDb:k};return h.push(_),1}var R=c?Ue(n):n;c&&(x?y&&Object.keys(y._attachments).forEach((e=>{f.push({documentId:b,attachmentId:e,digest:(0,he.ZN)(y)._attachments[e].digest})})):(Object.entries(d._attachments).find((t=>{let[r,a]=t;return(y?y._attachments[r]:void 0)||a.data||(e={documentId:b,documentInDb:k,isError:!0,status:510,writeRow:n,attachmentId:r}),!0})),e||Object.entries(d._attachments).forEach((e=>{let[t,r]=e;var a=y?y._attachments[t]:void 0;if(a){var n=R.document._attachments[t].digest;r.data&&a.digest!==n&&v.push({documentId:b,attachmentId:t,attachmentData:r,digest:r.digest})}else p.push({documentId:b,attachmentId:t,attachmentData:r,digest:r.digest})})))),e?h.push(e):(c?(u.push(Ue(R)),s&&s(d)):(u.push(R),s&&s(d)),o=R);var E=null,S=null,O=null;if(D&&!x)O="INSERT",E=c?Ze(d):d;else if(!y||D||x){if(!x)throw I("SNH",{args:{writeRow:n}});O="DELETE",E=(0,he.ZN)(d),S=y}else O="UPDATE",E=c?Ze(d):d,S=y;var C={documentId:b,documentData:E,previousDocumentData:S,operation:O};m.push(C)}else{var N=!!x;if(c&&Object.entries(d._attachments).forEach((t=>{let[r,a]=t;a.data?p.push({documentId:b,attachmentId:r,attachmentData:a,digest:a.digest}):(e={documentId:b,isError:!0,status:510,writeRow:n,attachmentId:r},h.push(e))})),e||(c?(l.push(Ue(n)),i&&i(d)):(l.push(n),i&&i(d)),o=n),!N){var P={documentId:b,operation:"INSERT",documentData:c?Ze(d):d,previousDocumentData:c&&y?Ze(y):y};m.push(P)}}},w=0;w<y;w++)b();return{bulkInsertDocs:l,bulkUpdateDocs:u,newestRow:o,errors:h,eventBulk:d,attachmentsAdd:p,attachmentsRemove:f,attachmentsUpdate:v}}(this,this.primaryPath,s,e,t),a.error=n.errors;var o=[];n.bulkInsertDocs.forEach((e=>{a.success.push(e.document),o.push(e.document)})),n.bulkUpdateDocs.forEach((e=>{a.success.push(e.document),o.push(e.document)})),(o=o.map((e=>Y(r.booleanIndexes,e)))).length>0&&await r.dexieTable.bulkPut(o);var c=[];n.attachmentsAdd.forEach((e=>{c.push({id:ne(e.documentId,e.attachmentId),data:e.attachmentData.data})})),n.attachmentsUpdate.forEach((e=>{c.push({id:ne(e.documentId,e.attachmentId),data:e.attachmentData.data})})),await r.dexieAttachmentsTable.bulkPut(c),await r.dexieAttachmentsTable.bulkDelete(n.attachmentsRemove.map((e=>ne(e.documentId,e.attachmentId))))})),(n=(0,he.ZN)(n)).eventBulk.events.length>0){var s=(0,he.ZN)(n.newestRow).document;n.eventBulk.checkpoint={id:s[this.primaryPath],lwt:s._meta.lwt},n.eventBulk.endTime=(0,oe.t)(),this.changes$.next(n.eventBulk)}return a},t.findDocumentsById=async function(e,t){ot(this);var r=await this.internals,a=[];return await r.dexieDb.transaction("r",r.dexieTable,(async()=>{(await ae(this.internals,e)).forEach((e=>{!e||e._deleted&&!t||a.push(e)}))})),a},t.query=function(e){return ot(this),Be(this,e)},t.count=async function(e){if(e.queryPlan.selectorSatisfiedByIndex){var t=await async function(e,t){var r=await e.internals,a=t.queryPlan,n=a.index,i=Te(r.booleanIndexes,a,r.dexieDb._options.IDBKeyRange),s=-1;return await r.dexieDb.transaction("r",r.dexieTable,(async e=>{var t,r=e.idbtrans.objectStore(Q);t="["+n.map((e=>J(e))).join("+")+"]";var a=r.index(t).count(i);s=await new Promise(((e,t)=>{a.onsuccess=function(){e(a.result)},a.onerror=e=>t(e)}))})),s}(this,e);return{count:t,mode:"fast"}}return{count:(await Be(this,e)).documents.length,mode:"slow"}},t.changeStream=function(){return ot(this),this.changes$.asObservable()},t.cleanup=async function(e){ot(this);var t=await this.internals;return await t.dexieDb.transaction("rw",t.dexieTable,(async()=>{var r=(0,oe.t)()-e,a=await t.dexieTable.where("_meta.lwt").below(r).toArray(),n=[];a.forEach((e=>{"1"===e._deleted&&n.push(e[this.primaryPath])})),await t.dexieTable.bulkDelete(n)})),!0},t.getAttachmentData=async function(e,t,r){ot(this);var a=await this.internals,n=ne(e,t);return await a.dexieDb.transaction("r",a.dexieAttachmentsTable,(async()=>{var r=await a.dexieAttachmentsTable.get(n);if(r)return r.data;throw new Error("attachment missing documentId: "+e+" attachmentId: "+t)}))},t.remove=async function(){ot(this);var e=await this.internals;return await e.dexieTable.clear(),this.close()},t.close=function(){return this.closed||(this.closed=(async()=>{this.changes$.complete(),await async function(e){var t=await e,r=Z.get(e)-1;0===r?(t.dexieDb.close(),Z.delete(e)):Z.set(e,r)}(this.internals)})()),this.closed},t.conflictResultionTasks=function(){return new se.B},t.resolveConflictResultionTask=async function(e){},e}();async function st(e,t,r){var n=function(e,t,r,n){var o="rxdb-dexie-"+e+"--"+n.version+"--"+t,c=i(U,o,(()=>{var e=(async()=>{var e=s(r);e.autoOpen=!1;var t=new a.cf(o,e),i={[Q]:re(n),[H]:"++sequence, id",[z]:"id"};return t.version(1).stores(i),await t.open(),{dexieDb:t,dexieTable:t[Q],dexieAttachmentsTable:t[z],booleanIndexes:ie(n)}})();return U.set(o,c),Z.set(c,0),e}));return c}(t.databaseName,t.collectionName,r,t.schema),o=new it(e,t.databaseName,t.collectionName,t.schema,n,t.options,r,t.devMode);return await tt(K,t,o),Promise.resolve(o)}function ot(e){if(e.closed)throw new Error("RxStorageInstanceDexie is closed "+e.databaseName+"-"+e.collectionName)}var ct="15.21.0",lt=function(){function e(e){this.name=K,this.rxdbVersion=ct,this.settings=e}return e.prototype.createStorageInstance=function(e){return function(e){if(e.schema.keyCompression)throw I("UT5",{args:{params:e}});if((t=e.schema).encrypted&&t.encrypted.length>0||t.attachments&&t.attachments.encrypted)throw I("UT6",{args:{params:e}});var t;if(e.schema.attachments&&e.schema.attachments.compression)throw I("UT7",{args:{params:e}})}(e),st(this,e,this.settings)},e}();function ut(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var r,a;if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(a=r;0!=a--;)if(!ut(e[a],t[a]))return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();var n=Object.keys(e);if((r=n.length)!==Object.keys(t).length)return!1;for(a=r;0!=a--;)if(!Object.prototype.hasOwnProperty.call(t,n[a]))return!1;for(a=r;0!=a--;){var i=n[a];if(!ut(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}var ht=function(){function e(e,t){this.jsonSchema=e,this.hashFunction=t,this.indexes=function(e){return(e.indexes||[]).map((e=>(0,y.k_)(e)?e:[e]))}(this.jsonSchema),this.primaryPath=q(this.jsonSchema.primaryKey),this.finalFields=F(this.jsonSchema)}var t=e.prototype;return t.validateChange=function(e,t){this.finalFields.forEach((r=>{if(!ut(e[r],t[r]))throw I("DOC9",{dataBefore:e,dataAfter:t,fieldName:r,schema:this.jsonSchema})}))},t.getDocumentPrototype=function(){var e={},t=B(this.jsonSchema,"");return Object.keys(t).forEach((t=>{var r=t;e.__defineGetter__(t,(function(){if(this.get&&"function"==typeof this.get)return this.get(r)})),Object.defineProperty(e,t+"$",{get:function(){return this.get$(r)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"$$",{get:function(){return this.get$$(r)},enumerable:!1,configurable:!1}),Object.defineProperty(e,t+"_",{get:function(){return this.populate(r)},enumerable:!1,configurable:!1})})),l(this,"getDocumentPrototype",(()=>e)),e},t.getPrimaryOfDocumentData=function(e){return M(this.jsonSchema,e)},(0,b.A)(e,[{key:"version",get:function(){return this.jsonSchema.version}},{key:"defaultValues",get:function(){var e={};return Object.entries(this.jsonSchema.properties).filter((e=>{let[,t]=e;return Object.prototype.hasOwnProperty.call(t,"default")})).forEach((t=>{let[r,a]=t;return e[r]=a.default})),l(this,"defaultValues",e)}},{key:"hash",get:function(){return l(this,"hash",this.hashFunction(JSON.stringify(this.jsonSchema)))}}])}();function dt(e,t,r){void 0===r&&(r=!0),r&&Le("preCreateRxSchema",e);var a=W(e);a=function(e){return o(e,!0)}(a),D.deepFreezeWhenDevMode(a);var n=new ht(a,t);return Le("createRxSchema",n),n}var mt=r(7708),pt=r(8146),ft=r(3356),vt=r(5520),gt=r(8609),yt=r(1753);function bt(e){var t=e.split("-"),r="RxDB";return t.forEach((e=>{r+=P(e)})),r+="Plugin",new Error("You are using a function which must be overwritten by a plugin.\n        You should either prevent the usage of this function or add the plugin via:\n            import { "+r+" } from 'rxdb/plugins/"+e+"';\n            addRxPlugin("+r+");\n        ")}function wt(e){return e.documentData?e.documentData:e.previousDocumentData}var xt=function(){function e(e,t,r,a){this.queueByDocId=new Map,this.isRunning=!1,this.storageInstance=e,this.primaryPath=t,this.preWrite=r,this.postWrite=a}var t=e.prototype;return t.addWrite=function(e,t){var r=e[this.primaryPath],a=i(this.queueByDocId,r,(()=>[]));return new Promise(((r,n)=>{var i={lastKnownDocumentState:e,modifier:t,resolve:r,reject:n};(0,he.ZN)(a).push(i),this.triggerRun()}))},t.triggerRun=async function(){if(!0!==this.isRunning&&0!==this.queueByDocId.size){this.isRunning=!0;var e=[],t=this.queueByDocId;this.queueByDocId=new Map,await Promise.all(Array.from(t.entries()).map((async t=>{let[r,a]=t;var n,i,s,o=(n=a.map((e=>e.lastKnownDocumentState)),i=n[0],s=qe(i._rev),n.forEach((e=>{var t=qe(e._rev);t>s&&(i=e,s=t)})),i),l=o;for(var u of a)try{l=await u.modifier(c(l))}catch(h){u.reject(h),u.reject=()=>{},u.resolve=()=>{}}try{await this.preWrite(l,o)}catch(h){return void a.forEach((e=>e.reject(h)))}e.push({previous:o,document:l})})));var r=e.length>0?await this.storageInstance.bulkWrite(e,"incremental-write"):{error:[],success:[]};return await Promise.all(r.success.map((e=>{var r=e[this.primaryPath];this.postWrite(e),n(t,r).forEach((t=>t.resolve(e)))}))),r.error.forEach((e=>{var r,a=e.documentId,s=n(t,a),o=E(e);if(o){var c=i(this.queueByDocId,a,(()=>[]));s.reverse().forEach((e=>{e.lastKnownDocumentState=(0,he.ZN)(o.documentInDb),(0,he.ZN)(c).unshift(e)}))}else{var l=I("COL20",{name:S[(r=e).status],document:r.documentId,writeError:r});s.forEach((e=>e.reject(l)))}})),this.isRunning=!1,this.triggerRun()}},e}();function Dt(e){return async t=>{var r=function(e){return Object.assign({},e,{_meta:void 0,_deleted:void 0,_rev:void 0})}(t);r._deleted=t._deleted;var a=await e(r),n=Object.assign({},a,{_meta:t._meta,_attachments:t._attachments,_rev:t._rev,_deleted:void 0!==a._deleted?a._deleted:t._deleted});return void 0===n._deleted&&(n._deleted=!1),n}}var kt={get primaryPath(){if(this.isInstanceOfRxDocument)return this.collection.schema.primaryPath},get primary(){var e=this;if(e.isInstanceOfRxDocument)return e._data[e.primaryPath]},get revision(){if(this.isInstanceOfRxDocument)return this._data._rev},get deleted$(){if(this.isInstanceOfRxDocument)return this.$.pipe((0,mt.T)((e=>e._data._deleted)))},get deleted$$(){var e=this;return e.collection.database.getReactivityFactory().fromObservable(e.deleted$,e.getLatest().deleted,e.collection.database)},get deleted(){if(this.isInstanceOfRxDocument)return this._data._deleted},getLatest(){var e=this.collection._docCache.getLatestDocumentData(this.primary);return this.collection._docCache.getCachedRxDocument(e)},get $(){return this.collection.$.pipe((0,pt.p)((e=>!e.isLocal)),(0,pt.p)((e=>e.documentId===this.primary)),(0,mt.T)((e=>wt(e))),(0,ft.Z)(this.collection._docCache.getLatestDocumentData(this.primary)),(0,vt.F)(((e,t)=>e._rev===t._rev)),(0,mt.T)((e=>this.collection._docCache.getCachedRxDocument(e))),(0,gt.t)(he.bz))},get $$(){var e=this;return e.collection.database.getReactivityFactory().fromObservable(e.$,e.getLatest()._data,e.collection.database)},get$(e){if(D.isDevMode()){if(e.includes(".item."))throw I("DOC1",{path:e});if(e===this.primaryPath)throw I("DOC2");if(this.collection.schema.finalFields.includes(e))throw I("DOC3",{path:e});if(!B(this.collection.schema.jsonSchema,e))throw I("DOC4",{path:e})}return this.$.pipe((0,mt.T)((t=>v(t,e))),(0,vt.F)())},get$$(e){var t=this.get$(e);return this.collection.database.getReactivityFactory().fromObservable(t,this.getLatest().get(e),this.collection.database)},populate(e){var t=B(this.collection.schema.jsonSchema,e),r=this.get(e);if(!r)return yt.$A;if(!t)throw I("DOC5",{path:e});if(!t.ref)throw I("DOC6",{path:e,schemaObj:t});var a=this.collection.database.collections[t.ref];if(!a)throw I("DOC7",{ref:t.ref,path:e,schemaObj:t});return"array"===t.type?a.findByIds(r).exec().then((e=>{var t=e.values();return Array.from(t)})):a.findOne(r).exec()},get(e){return i(this._propertyCache,e,(()=>{var t=v(this._data,e);if("object"!=typeof t||null===t||Array.isArray(t))return D.deepFreezeWhenDevMode(t);var r=this;return new Proxy(s(t),{get(t,a){if("string"!=typeof a)return t[a];var n=a.charAt(a.length-1);if(a.endsWith("$$")){var i=a.slice(0,-2);return r.get$$($(e+"."+i))}if("$"===n){var s=a.slice(0,-1);return r.get$($(e+"."+s))}if("_"===n){var o=a.slice(0,-1);return r.populate($(e+"."+o))}return r.get($(e+"."+a))}})}))},toJSON(e){if(void 0===e&&(e=!1),e)return D.deepFreezeWhenDevMode(this._data);var t=s(this._data);return delete t._rev,delete t._attachments,delete t._deleted,delete t._meta,D.deepFreezeWhenDevMode(t)},toMutableJSON(e){return void 0===e&&(e=!1),c(this.toJSON(e))},update(e){throw bt("update")},incrementalUpdate(e){throw bt("update")},updateCRDT(e){throw bt("crdt")},putAttachment(){throw bt("attachments")},getAttachment(){throw bt("attachments")},allAttachments(){throw bt("attachments")},get allAttachments$(){throw bt("attachments")},async modify(e,t){var r=this._data,a=await Dt(e)(r);return this._saveData(a,r)},incrementalModify(e,t){return this.collection.incrementalWriteQueue.addWrite(this._data,Dt(e)).then((e=>this.collection._docCache.getCachedRxDocument(e)))},patch(e){var t=this._data,r=c(t);return Object.entries(e).forEach((e=>{let[t,a]=e;r[t]=a})),this._saveData(r,t)},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((e=>{let[r,a]=e;t[r]=a})),t)))},async _saveData(e,t){if(e=s(e),this._data._deleted)throw I("DOC11",{id:this.primary,document:this});await _t(this.collection,e,t);var r=await this.collection.storageInstance.bulkWrite([{previous:t,document:e}],"rx-document-save-data"),a=r.error[0];return Ke(this.collection,this.primary,e,a),await this.collection._runHooks("post","save",e,this),this.collection._docCache.getCachedRxDocument(r.success[0])},remove(){var e=this.collection;if(this.deleted)return Promise.reject(I("DOC13",{document:this,id:this.primary}));var t,r=s(this._data);return e._runHooks("pre","remove",r,this).then((async()=>{r._deleted=!0;var t=await e.storageInstance.bulkWrite([{previous:this._data,document:r}],"rx-document-remove"),a=t.error[0];return Ke(e,this.primary,r,a),t.success[0]})).then((e=>(t=e,this.collection._runHooks("post","remove",r,this)))).then((()=>this.collection._docCache.getCachedRxDocument(t)))},incrementalRemove(){return this.incrementalModify((async e=>(await this.collection._runHooks("pre","remove",e,this),e._deleted=!0,e))).then((async e=>(await this.collection._runHooks("post","remove",e._data,e),e)))},destroy(){throw I("DOC14")}};function jt(e){void 0===e&&(e=kt);var t=function(e,t){this.collection=e,this._data=t,this._propertyCache=new Map,this.isInstanceOfRxDocument=!0};return t.prototype=e,t}function _t(e,t,r){return t._meta=Object.assign({},r._meta,t._meta),D.isDevMode()&&e.schema.validateChange(r,t),e._runHooks("pre","save",t,r)}var It=r(2198),Rt=r(511),Et=r(4157),St=r(2442),Ot=r(6114);function Ct(e,t){return t.sort&&0!==t.sort.length?t.sort.map((e=>Object.keys(e)[0])):[e]}var Nt=new WeakMap;function Pt(e,t){if(!e.collection.database.eventReduce)return{runFullQueryAgain:!0};var r=function(e){return i(Nt,e,(()=>{var t=e.collection,r=Oe(t.storageInstance.schema,c(e.mangoQuery)),a=t.schema.primaryPath,n=Ce(t.schema.jsonSchema,r),i=Ne(t.schema.jsonSchema,r);return{primaryKey:e.collection.schema.primaryPath,skip:r.skip,limit:r.limit,sortFields:Ct(a,r),sortComparator:(t,r)=>{var a={docA:t,docB:r,rxQuery:e};return n(a.docA,a.docB)},queryMatcher:t=>i({doc:t,rxQuery:e}.doc)}}))}(e),a=(0,he.ZN)(e._result).docsData.slice(0),n=(0,he.ZN)(e._result).docsDataMap,s=!1;return t.map((e=>function(e){switch(e.operation){case"INSERT":return{operation:e.operation,id:e.documentId,doc:e.documentData,previous:null};case"UPDATE":return{operation:e.operation,id:e.documentId,doc:D.deepFreezeWhenDevMode(e.documentData),previous:e.previousDocumentData?e.previousDocumentData:"UNKNOWN"};case"DELETE":return{operation:e.operation,id:e.documentId,doc:null,previous:e.previousDocumentData}}}(e))).filter(y.S7).find((e=>{var t={queryParams:r,changeEvent:e,previousResults:a,keyDocumentMap:n},i=(0,Ot.kC)(t);return"runFullQueryAgain"===i||("doNothing"!==i?(s=!0,(0,Ot.Cs)(i,r,e,a,n),!1):void 0)}))?{runFullQueryAgain:!0}:{runFullQueryAgain:!1,changed:s,newResults:a}}var $t=function(){function e(){this._map=new Map}return e.prototype.getByQuery=function(e){var t=e.toString();return i(this._map,t,(()=>e))},e}();function At(e,t){t.uncached=!0;var r=t.toString();e._map.delete(r)}function Tt(e){return e.refCount$.observers.length}var Bt,qt,Mt=(Bt=100,qt=3e4,(e,t)=>{if(!(t._map.size<Bt)){var r=(0,oe.t)()-qt,a=[],n=Array.from(t._map.values());for(var i of n)Tt(i)>0||(0===i._lastEnsureEqual&&i._creationTime<r?At(t,i):a.push(i));var s=a.length-Bt;s<=0||a.sort(((e,t)=>e._lastEnsureEqual-t._lastEnsureEqual)).slice(0,s).forEach((e=>At(t,e)))}}),Wt=new WeakSet;var Lt=function(){function e(e,t,r){this.cacheItemByDocId=new Map,this.registry="function"==typeof FinalizationRegistry?new FinalizationRegistry((e=>{var t=e.docId,r=this.cacheItemByDocId.get(t);r&&(r[0].delete(e.revisionHeight),0===r[0].size&&this.cacheItemByDocId.delete(t))})):void 0,this.primaryPath=e,this.changes$=t,this.documentCreator=r,t.subscribe((e=>{var t=e.documentId,r=this.cacheItemByDocId.get(t);if(r){var a=wt(e);r[1]=a}}))}var t=e.prototype;return t.getLatestDocumentData=function(e){return n(this.cacheItemByDocId,e)[1]},t.getLatestDocumentDataIfExists=function(e){var t=this.cacheItemByDocId.get(e);if(t)return t[1]},(0,b.A)(e,[{key:"getCachedRxDocuments",get:function(){return l(this,"getCachedRxDocuments",Ft(this))}},{key:"getCachedRxDocument",get:function(){var e=Ft(this);return l(this,"getCachedRxDocument",(t=>e([t])[0]))}}])}();function Ft(e){var t=e.primaryPath,r=e.cacheItemByDocId,a=e.registry,n=D.deepFreezeWhenDevMode,i=e.documentCreator;return e=>{for(var s=new Array(e.length),o=[],c=0;c<e.length;c++){var l=e[c],u=l[t],h=qe(l._rev),d=void 0,m=void 0,p=r.get(u);p?m=(d=p[0]).get(h):(p=[d=new Map,l],r.set(u,p));var f=m?m.deref():void 0;f||(l=n(l),f=i(l),d.set(h,Ht(f)),a&&o.push(f)),s[c]=f}return o.length>0&&a&&(0,yt.vN)().then((()=>{for(var e=0;e<o.length;e++){var t=o[e];a.register(t,{docId:t.primary,revisionHeight:qe(t.revision)})}})),s}}function Qt(e,t){return(0,e.getCachedRxDocuments)(t)}var Ht="function"==typeof WeakRef?function(e){return new WeakRef(e)}:function(e){return{deref:()=>e}};var zt=function(){return(0,b.A)((function(e,t,r){this.time=(0,oe.t)(),this.collection=e,this.count=r,this.documents=Qt(this.collection._docCache,t)}),[{key:"docsData",get:function(){return l(this,"docsData",this.documents.map((e=>e._data)))}},{key:"docsDataMap",get:function(){var e=new Map;return this.documents.forEach((t=>{e.set(t.primary,t._data)})),l(this,"docsDataMap",e)}},{key:"docsMap",get:function(){for(var e=new Map,t=this.documents,r=0;r<t.length;r++){var a=t[r];e.set(a.primary,a)}return l(this,"docsMap",e)}}])}(),Kt=0,Ut=function(){function e(e,t,r,a){void 0===a&&(a={}),this.id=++Kt,this._execOverDatabaseCount=0,this._creationTime=(0,oe.t)(),this._lastEnsureEqual=0,this.uncached=!1,this.refCount$=new It.t(null),this._result=null,this._latestChangeEvent=-1,this._lastExecStart=0,this._lastExecEnd=0,this._ensureEqualQueue=yt.Dr,this.op=e,this.mangoQuery=t,this.collection=r,this.other=a,t||(this.mangoQuery={selector:{}}),this.isFindOneByIdQuery=function(e,t){if(!t.skip&&t.selector&&1===Object.keys(t.selector).length&&t.selector[e]){var r=t.selector[e];if("string"==typeof r)return r;if(1===Object.keys(r).length&&"string"==typeof r.$eq)return r.$eq;if(1===Object.keys(r).length&&Array.isArray(r.$eq)&&!r.$eq.find((e=>"string"!=typeof e)))return r.$eq}return!1}(this.collection.schema.primaryPath,t)}var t=e.prototype;return t._setResultData=function(e){if("number"!=typeof e){e instanceof Map&&(e=Array.from(e.values()));var t=new zt(this.collection,e,e.length);this._result=t}else this._result=new zt(this.collection,[],e)},t._execOverDatabase=async function(){if(this._execOverDatabaseCount=this._execOverDatabaseCount+1,this._lastExecStart=(0,oe.t)(),"count"===this.op){var e=this.getPreparedQuery(),t=await this.collection.storageInstance.count(e);if("slow"!==t.mode||this.collection.database.allowSlowCount)return t.count;throw I("QU14",{collection:this.collection,queryObj:this.mangoQuery})}if("findByIds"===this.op){var r=(0,he.ZN)(this.mangoQuery.selector)[this.collection.schema.primaryPath].$in,a=new Map,n=[];if(r.forEach((e=>{var t=this.collection._docCache.getLatestDocumentDataIfExists(e);if(t){if(!t._deleted){var r=this.collection._docCache.getCachedRxDocument(t);a.set(e,r)}}else n.push(e)})),n.length>0)(await this.collection.storageInstance.findDocumentsById(n,!1)).forEach((e=>{var t=this.collection._docCache.getCachedRxDocument(e);a.set(t.primary,t)}));return a}var i=async function(e){var t=[],r=e.collection;if(e.isFindOneByIdQuery)if(Array.isArray(e.isFindOneByIdQuery)){var a=e.isFindOneByIdQuery;if(a=a.filter((r=>{var a=e.collection._docCache.getLatestDocumentDataIfExists(r);return!a||(a._deleted||t.push(a),!1)})),a.length>0){var n=await r.storageInstance.findDocumentsById(a,!1);(0,y.Hb)(t,n)}}else{var i=e.isFindOneByIdQuery,s=e.collection._docCache.getLatestDocumentDataIfExists(i);if(!s){var o=await r.storageInstance.findDocumentsById([i],!1);o[0]&&(s=o[0])}s&&!s._deleted&&t.push(s)}else{var c=e.getPreparedQuery(),l=await r.storageInstance.query(c);t=l.documents}return t}(this);return i.then((e=>(this._lastExecEnd=(0,oe.t)(),e)))},t.exec=function(e){if(e&&"findOne"!==this.op)throw I("QU9",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return Jt(this).then((()=>(0,Rt._)(this.$))).then((t=>{if(!t&&e)throw I("QU10",{collection:this.collection.name,query:this.mangoQuery,op:this.op});return t}))},t.toString=function(){var e=o({op:this.op,query:this.mangoQuery,other:this.other},!0),t=JSON.stringify(e);return this.toString=()=>t,t},t.getPreparedQuery=function(){var e={rxQuery:this,mangoQuery:Oe(this.collection.schema.jsonSchema,this.mangoQuery)};e.mangoQuery.selector._deleted={$eq:!1},e.mangoQuery.index&&e.mangoQuery.index.unshift("_deleted"),Le("prePrepareQuery",e);var t=Gt(this.collection.schema.jsonSchema,e.mangoQuery);return this.getPreparedQuery=()=>t,t},t.doesDocumentDataMatch=function(e){return!e._deleted&&this.queryMatcher(e)},t.remove=function(){return this.exec().then((e=>Array.isArray(e)?Promise.all(e.map((e=>e.remove()))):e.remove()))},t.incrementalRemove=function(){return Pe(this.asRxQuery,(e=>e.incrementalRemove()))},t.update=function(e){throw bt("update")},t.patch=function(e){return Pe(this.asRxQuery,(t=>t.patch(e)))},t.incrementalPatch=function(e){return Pe(this.asRxQuery,(t=>t.incrementalPatch(e)))},t.modify=function(e){return Pe(this.asRxQuery,(t=>t.modify(e)))},t.incrementalModify=function(e){return Pe(this.asRxQuery,(t=>t.incrementalModify(e)))},t.where=function(e){throw bt("query-builder")},t.sort=function(e){throw bt("query-builder")},t.skip=function(e){throw bt("query-builder")},t.limit=function(e){throw bt("query-builder")},(0,b.A)(e,[{key:"$",get:function(){if(!this._$){var e=this.collection.$.pipe((0,pt.p)((e=>!e.isLocal)),(0,ft.Z)(null),(0,St.Z)((()=>Jt(this))),(0,mt.T)((()=>this._result)),(0,gt.t)(he.bz),(0,vt.F)(((e,t)=>!(!e||e.time!==(0,he.ZN)(t).time))),(0,pt.p)((e=>!!e)),(0,mt.T)((e=>{var t=(0,he.ZN)(e);return"count"===this.op?t.count:"findOne"===this.op?0===t.documents.length?null:t.documents[0]:"findByIds"===this.op?t.docsMap:t.documents.slice(0)})));this._$=(0,Et.h)(e,this.refCount$.pipe((0,pt.p)((()=>!1))))}return this._$}},{key:"$$",get:function(){return this.collection.database.getReactivityFactory().fromObservable(this.$,void 0,this.collection.database)}},{key:"queryMatcher",get:function(){this.collection.schema.jsonSchema;return l(this,"queryMatcher",Ne(0,Oe(this.collection.schema.jsonSchema,this.mangoQuery)))}},{key:"asRxQuery",get:function(){return this}}])}();function Zt(e,t,r,a){Le("preCreateRxQuery",{op:e,queryObj:t,collection:r,other:a});var n,i,s=new Ut(e,t,r,a);return s=(n=s).collection._queryCache.getByQuery(n),i=r,Wt.has(i)||(Wt.add(i),(0,yt.dY)().then((()=>(0,yt.Ve)(200))).then((()=>{i.destroyed||i.cacheReplacementPolicy(i,i._queryCache),Wt.delete(i)}))),s}function Vt(e){var t=e.asRxQuery.collection._changeEventBuffer.counter;return e._latestChangeEvent>=t}function Jt(e){return e.collection.database.destroyed||Vt(e)?yt.Dr:(e._ensureEqualQueue=e._ensureEqualQueue.then((()=>function(e){if(e._lastEnsureEqual=(0,oe.t)(),e.collection.database.destroyed||Vt(e))return yt.Dr;var t=!1,r=!1;-1===e._latestChangeEvent&&(r=!0);if(!r){var a=e.asRxQuery.collection._changeEventBuffer.getFrom(e._latestChangeEvent+1);if(null===a)r=!0;else{e._latestChangeEvent=e.asRxQuery.collection._changeEventBuffer.counter;var n=e.asRxQuery.collection._changeEventBuffer.reduceByLastOfDoc(a);if("count"===e.op){var i=(0,he.ZN)(e._result).count,s=i;n.forEach((t=>{var r=t.previousDocumentData&&e.doesDocumentDataMatch(t.previousDocumentData),a=e.doesDocumentDataMatch(t.documentData);!r&&a&&s++,r&&!a&&s--})),s!==i&&(t=!0,e._setResultData(s))}else{var o=Pt(e,n);o.runFullQueryAgain?r=!0:o.changed&&(t=!0,e._setResultData(o.newResults))}}}if(r)return e._execOverDatabase().then((r=>(e._latestChangeEvent=e.collection._changeEventBuffer.counter,"number"==typeof r?(e._result&&r===e._result.count||(t=!0,e._setResultData(r)),t):(e._result&&function(e,t,r){if(t.length!==r.length)return!1;for(var a=0,n=t.length;a<n;){var i=t[a],s=r[a];if(a++,i._rev!==s._rev||i[e]!==s[e])return!1}return!0}(e.collection.schema.primaryPath,r,e._result.docsData)||(t=!0,e._setResultData(r)),t))));return Promise.resolve(t)}(e))),e._ensureEqualQueue)}function Gt(e,t){if(!t.sort)throw I("SNH",{query:t});return{query:t,queryPlan:pe(e,t)}}var Yt="collection",Xt="storage-token",er=W({version:0,title:"RxInternalDocument",primaryKey:{key:"id",fields:["context","key"],separator:"|"},type:"object",properties:{id:{type:"string",maxLength:200},key:{type:"string"},context:{type:"string",enum:[Yt,Xt,"rx-migration-status","OTHER"]},data:{type:"object",additionalProperties:!0}},indexes:[],required:["key","context","data"],additionalProperties:!1,sharding:{shards:1,mode:"collection"}});function tr(e,t){return M(er,{key:e,context:t})}async function rr(e){var t=Gt(e.schema,{selector:{context:Yt,_deleted:{$eq:!1}},sort:[{id:"asc"}],skip:0});return(await e.query(t)).documents}var ar="storageToken",nr=tr(ar,Xt);function ir(e,t){return e+"-"+t.version}function sr(e,t){return t=function(e,t){for(var r=Object.keys(e.defaultValues),a=0;a<r.length;++a){var n=r[a];Object.prototype.hasOwnProperty.call(t,n)&&void 0!==t[n]||(t[n]=e.defaultValues[n])}return t}(e,t=s(t)),(t=function(e,t,r){if("string"==typeof t.primaryKey)return r;var a=M(t,r),n=r[e];if(n&&n!==a)throw I("DOC19",{args:{documentData:r,existingPrimary:n,newPrimary:a},schema:t});return r[e]=a,r}(e.primaryPath,e.jsonSchema,t))._meta=T(),Object.prototype.hasOwnProperty.call(t,"_deleted")||(t._deleted=!1),Object.prototype.hasOwnProperty.call(t,"_attachments")||(t._attachments={}),Object.prototype.hasOwnProperty.call(t,"_rev")||(t._rev=""),t}async function or(e,t,r,a,n,i,s){var o=(await rr(t)).filter((e=>e.data.name===n)),c=[];o.forEach((e=>{c.push({collectionName:e.data.name,schema:e.data.schema,isCollection:!0}),e.data.connectedStorages.forEach((e=>c.push({collectionName:e.collectionName,isCollection:!1,schema:e.schema})))}));var l=new Set;if(c=c.filter((e=>{var t=e.collectionName+"||"+e.schema.version;return!l.has(t)&&(l.add(t),!0)})),await Promise.all(c.map((async t=>{var s=await e.createStorageInstance({collectionName:t.collectionName,databaseInstanceToken:r,databaseName:a,multiInstance:!1,options:{},schema:t.schema,password:i,devMode:D.isDevMode()});await s.remove(),t.isCollection&&await Fe("postRemoveRxCollection",{storage:e,databaseName:a,collectionName:n})}))),s){var u=o.map((e=>{var t=Ve(e);return t._deleted=!0,t._meta.lwt=(0,oe.t)(),t._rev=Me(r,e),{previous:e,document:t}}));await t.bulkWrite(u,"rx-database-remove-collection-all")}}function cr(e){if(e.destroyed)throw I("COL21",{collection:e.name,version:e.schema.version})}var lr=function(){function e(e){this.subs=[],this.limit=100,this.counter=0,this.eventCounterMap=new WeakMap,this.buffer=[],this.collection=e,this.subs.push(this.collection.$.pipe((0,pt.p)((e=>!e.isLocal))).subscribe((e=>this._handleChangeEvent(e))))}var t=e.prototype;return t._handleChangeEvent=function(e){for(this.counter++,this.buffer.push(e),this.eventCounterMap.set(e,this.counter);this.buffer.length>this.limit;)this.buffer.shift()},t.getArrayIndexByPointer=function(e){var t=this.buffer[0],r=this.eventCounterMap.get(t);return e<r?null:e-r},t.getFrom=function(e){var t=[],r=this.getArrayIndexByPointer(e);if(null===r)return null;for(;;){var a=this.buffer[r];if(r++,!a)return t;t.push(a)}},t.runFrom=function(e,t){var r=this.getFrom(e);if(null===r)throw new Error("out of bounds");r.forEach((e=>t(e)))},t.reduceByLastOfDoc=function(e){return e.slice(0)},t.destroy=function(){this.subs.forEach((e=>e.unsubscribe()))},e}();var ur=new WeakMap;function hr(e){var t=e.schema.getDocumentPrototype(),r=function(e){var t={};return Object.entries(e.methods).forEach((e=>{let[r,a]=e;t[r]=a})),t}(e),a={};return[t,r,kt].forEach((e=>{Object.getOwnPropertyNames(e).forEach((t=>{var r=Object.getOwnPropertyDescriptor(e,t),n=!0;(t.startsWith("_")||t.endsWith("_")||t.startsWith("$")||t.endsWith("$"))&&(n=!1),"function"==typeof r.value?Object.defineProperty(a,t,{get(){return r.value.bind(this)},enumerable:n,configurable:!1}):(r.enumerable=n,r.configurable=!1,r.writable&&(r.writable=!1),Object.defineProperty(a,t,r))}))})),a}function dr(e,t,r){var a=function(e,t,r){var a=new e(t,r);return Le("createRxDocument",a),a}(t,e,D.deepFreezeWhenDevMode(r));return e._runHooksSync("post","create",r,a),Le("postCreateRxDocument",a),a}var mr=function(e,t){return ut(Ze(e.newDocumentState),Ze(e.realMasterState))?Promise.resolve({isEqual:!0}):Promise.resolve({isEqual:!1,documentData:e.realMasterState})};var pr=["pre","post"],fr=["insert","save","remove","create"],vr=!1,gr=function(){function e(e,t,r,a,n,i,s,o,c,l,u,h){void 0===n&&(n={}),void 0===i&&(i={}),void 0===s&&(s={}),void 0===o&&(o={}),void 0===c&&(c={}),void 0===l&&(l=Mt),void 0===u&&(u={}),void 0===h&&(h=mr),this.storageInstance={},this.timeouts=new Set,this.incrementalWriteQueue={},this._incrementalUpsertQueues=new Map,this.synced=!1,this.hooks={},this._subs=[],this._docCache={},this._queryCache=new $t,this.$={},this.checkpoint$={},this._changeEventBuffer={},this.onDestroy=[],this.destroyed=!1,this.onRemove=[],this.database=e,this.name=t,this.schema=r,this.internalStorageInstance=a,this.instanceCreationOptions=n,this.migrationStrategies=i,this.methods=s,this.attachments=o,this.options=c,this.cacheReplacementPolicy=l,this.statics=u,this.conflictHandler=h,function(e){if(vr)return;vr=!0;var t=Object.getPrototypeOf(e);fr.forEach((e=>{pr.map((r=>{var a=r+P(e);t[a]=function(t,a){return this.addHook(r,e,t,a)}}))}))}(this.asRxCollection)}var t=e.prototype;return t.prepare=async function(){this.storageInstance=Je(this.database,this.internalStorageInstance,this.schema.jsonSchema),this.incrementalWriteQueue=new xt(this.storageInstance,this.schema.primaryPath,((e,t)=>_t(this,e,t)),(e=>this._runHooks("post","save",e)));var e,t,r=this.database.eventBulks$.pipe((0,pt.p)((e=>e.collectionName===this.name)));this.$=r.pipe((0,St.Z)((e=>e.events))),this.checkpoint$=r.pipe((0,mt.T)((e=>e.checkpoint))),this._changeEventBuffer=(e=this.asRxCollection,new lr(e)),this._docCache=new Lt(this.schema.primaryPath,this.$.pipe((0,pt.p)((e=>!e.isLocal))),(e=>{var r;return t||(r=this.asRxCollection,t=i(ur,r,(()=>jt(hr(r))))),dr(this.asRxCollection,t,e)}));var a=this.database.internalStore.changeStream().pipe((0,pt.p)((e=>{var t=this.name+"-"+this.schema.version;return!!e.events.find((e=>"collection"===e.documentData.context&&e.documentData.key===t&&"DELETE"===e.operation))}))).subscribe((async()=>{await this.destroy(),await Promise.all(this.onRemove.map((e=>e())))}));this._subs.push(a);var n=await this.database.storageToken,s=this.storageInstance.changeStream().subscribe((e=>{for(var t=new Array(e.events.length),r=e.events,a=this.name,i=D.deepFreezeWhenDevMode,s=0;s<r.length;s++){var o=r[s];t[s]={documentId:o.documentId,collectionName:a,isLocal:!1,operation:o.operation,documentData:i(o.documentData),previousDocumentData:i(o.previousDocumentData)}}var c={id:e.id,internal:!1,collectionName:this.name,storageToken:n,events:t,databaseToken:this.database.token,checkpoint:e.checkpoint,context:e.context,endTime:e.endTime,startTime:e.startTime};this.database.$emit(c)}));return this._subs.push(s),this._subs.push(this.storageInstance.conflictResultionTasks().subscribe((e=>{this.conflictHandler(e.input,e.context).then((t=>{this.storageInstance.resolveConflictResultionTask({id:e.id,output:t})}))}))),yt.em},t.cleanup=function(e){throw cr(this),bt("cleanup")},t.migrationNeeded=function(){throw bt("migration-schema")},t.getMigrationState=function(){throw bt("migration-schema")},t.startMigration=function(e){return void 0===e&&(e=10),cr(this),this.getMigrationState().startMigration(e)},t.migratePromise=function(e){return void 0===e&&(e=10),this.getMigrationState().migratePromise(e)},t.insert=async function(e){cr(this);var t=await this.bulkInsert([e]),r=t.error[0];return Ke(this,e[this.schema.primaryPath],e,r),(0,he.ZN)(t.success[0])},t.bulkInsert=async function(e){if(cr(this),0===e.length)return{success:[],error:[]};var t,r=this.schema.primaryPath;if(this.hasHooks("pre","insert"))t=await Promise.all(e.map((e=>{var t=sr(this.schema,e);return this._runHooks("pre","insert",t).then((()=>({document:t})))})));else{t=[];for(var a=0;a<e.length;a++){var n=e[a],i=sr(this.schema,n);t[a]={document:i}}}var s=await this.storageInstance.bulkWrite(t,"rx-collection-bulk-insert"),o=Qt(this._docCache,s.success);if(this.hasHooks("post","insert")){var c=new Map;t.forEach((e=>{var t=e.document;c.set(t[r],t)})),await Promise.all(o.map((e=>this._runHooks("post","insert",c.get(e.primary),e))))}return{success:o,error:s.error}},t.bulkRemove=async function(e){cr(this);var t=this.schema.primaryPath;if(0===e.length)return{success:[],error:[]};var r=await this.findByIds(e).exec(),a=[],i=new Map;Array.from(r.values()).forEach((e=>{var t=e.toMutableJSON(!0);a.push(t),i.set(e.primary,t)})),await Promise.all(a.map((e=>{var t=e[this.schema.primaryPath];return this._runHooks("pre","remove",e,r.get(t))})));var o=a.map((e=>{var t=s(e);return t._deleted=!0,{previous:e,document:t}})),c=await this.storageInstance.bulkWrite(o,"rx-collection-bulk-remove"),l=c.success.map((e=>e[t]));return await Promise.all(l.map((e=>this._runHooks("post","remove",i.get(e),r.get(e))))),{success:l.map((e=>n(r,e))),error:c.error}},t.bulkUpsert=async function(e){cr(this);var t=[],r=new Map;e.forEach((e=>{var a=sr(this.schema,e),n=a[this.schema.primaryPath];if(!n)throw I("COL3",{primaryPath:this.schema.primaryPath,data:a,schema:this.schema.jsonSchema});r.set(n,a),t.push(a)}));var a=await this.bulkInsert(t),i=a.success.slice(0),s=[];return await Promise.all(a.error.map((async e=>{if(409!==e.status)s.push(e);else{var t=e.documentId,a=n(r,t),o=(0,he.ZN)(e.documentInDb),c=this._docCache.getCachedRxDocuments([o])[0],l=await c.incrementalModify((()=>a));i.push(l)}}))),{error:s,success:i}},t.upsert=async function(e){cr(this);var t=await this.bulkUpsert([e]);return Ke(this.asRxCollection,e[this.schema.primaryPath],e,t.error[0]),t.success[0]},t.incrementalUpsert=function(e){cr(this);var t=sr(this.schema,e),r=t[this.schema.primaryPath];if(!r)throw I("COL4",{data:e});var a=this._incrementalUpsertQueues.get(r);return a||(a=yt.em),a=a.then((()=>function(e,t,r){var a=e._docCache.getLatestDocumentDataIfExists(t);if(a)return Promise.resolve({doc:e._docCache.getCachedRxDocuments([a])[0],inserted:!1});return e.findOne(t).exec().then((t=>t?{doc:t,inserted:!1}:e.insert(r).then((e=>({doc:e,inserted:!0})))))}(this,r,t))).then((e=>e.inserted?e.doc:function(e,t){return e.incrementalModify((e=>t))}(e.doc,t))),this._incrementalUpsertQueues.set(r,a),a},t.find=function(e){if(cr(this),"string"==typeof e)throw I("COL5",{queryObj:e});return e||(e={selector:{}}),Zt("find",e,this)},t.findOne=function(e){if(cr(this),"number"==typeof e||Array.isArray(e))throw R("COL6",{queryObj:e});var t;if("string"==typeof e)t=Zt("findOne",{selector:{[this.schema.primaryPath]:e},limit:1},this);else{if(e||(e={selector:{}}),e.limit)throw I("QU6");(e=s(e)).limit=1,t=Zt("findOne",e,this)}return t},t.count=function(e){return cr(this),e||(e={selector:{}}),Zt("count",e,this)},t.findByIds=function(e){return cr(this),Zt("findByIds",{selector:{[this.schema.primaryPath]:{$in:e.slice(0)}}},this)},t.exportJSON=function(){throw bt("json-dump")},t.importJSON=function(e){throw bt("json-dump")},t.insertCRDT=function(e){throw bt("crdt")},t.addHook=function(e,t,r,a){if(void 0===a&&(a=!1),"function"!=typeof r)throw R("COL7",{key:t,when:e});if(!pr.includes(e))throw R("COL8",{key:t,when:e});if(!fr.includes(t))throw I("COL9",{key:t});if("post"===e&&"create"===t&&!0===a)throw I("COL10",{when:e,key:t,parallel:a});var n=r.bind(this),i=a?"parallel":"series";this.hooks[t]=this.hooks[t]||{},this.hooks[t][e]=this.hooks[t][e]||{series:[],parallel:[]},this.hooks[t][e][i].push(n)},t.getHooks=function(e,t){return this.hooks[t]&&this.hooks[t][e]?this.hooks[t][e]:{series:[],parallel:[]}},t.hasHooks=function(e,t){if(!this.hooks[t]||!this.hooks[t][e])return!1;var r=this.getHooks(e,t);return!!r&&(r.series.length>0||r.parallel.length>0)},t._runHooks=function(e,t,r,a){var n=this.getHooks(e,t);if(!n)return yt.em;var i=n.series.map((e=>()=>e(r,a)));return(0,yt.h$)(i).then((()=>Promise.all(n.parallel.map((e=>e(r,a))))))},t._runHooksSync=function(e,t,r,a){if(this.hasHooks(e,t)){var n=this.getHooks(e,t);n&&n.series.forEach((e=>e(r,a)))}},t.promiseWait=function(e){return new Promise((t=>{var r=setTimeout((()=>{this.timeouts.delete(r),t()}),e);this.timeouts.add(r)}))},t.destroy=async function(){return this.destroyed?yt.Dr:(await Promise.all(this.onDestroy.map((e=>e()))),this.destroyed=!0,Array.from(this.timeouts).forEach((e=>clearTimeout(e))),this._changeEventBuffer&&this._changeEventBuffer.destroy(),this.database.requestIdlePromise().then((()=>this.storageInstance.close())).then((()=>(this._subs.forEach((e=>e.unsubscribe())),delete this.database.collections[this.name],Fe("postDestroyRxCollection",this).then((()=>!0))))))},t.remove=async function(){await this.destroy(),await Promise.all(this.onRemove.map((e=>e()))),await or(this.database.storage,this.database.internalStore,this.database.token,this.database.name,this.name,this.database.password,this.database.hashFunction)},(0,b.A)(e,[{key:"insert$",get:function(){return this.$.pipe((0,pt.p)((e=>"INSERT"===e.operation)))}},{key:"update$",get:function(){return this.$.pipe((0,pt.p)((e=>"UPDATE"===e.operation)))}},{key:"remove$",get:function(){return this.$.pipe((0,pt.p)((e=>"DELETE"===e.operation)))}},{key:"asRxCollection",get:function(){return this}}])}();var yr=r(7635),br=r(5525),wr=new Set,xr=function(){function e(e,t,r,a,n,i,s,o,c,l,u,h,d){void 0===s&&(s=!1),void 0===o&&(o={}),this.idleQueue=new yr.G,this.rxdbVersion=ct,this.storageInstances=new Set,this._subs=[],this.startupErrors=[],this.onDestroy=[],this.destroyed=!1,this.collections={},this.states={},this.eventBulks$=new se.B,this.observable$=this.eventBulks$.pipe((0,St.Z)((e=>e.events))),this.storageToken=yt.Dr,this.storageTokenDocument=yt.Dr,this.emittedEventBulkIds=new br.p4(6e4),this.name=e,this.token=t,this.storage=r,this.instanceCreationOptions=a,this.password=n,this.multiInstance=i,this.eventReduce=s,this.options=o,this.internalStore=c,this.hashFunction=l,this.cleanupPolicy=u,this.allowSlowCount=h,this.reactivity=d,"pseudoInstance"!==this.name&&(this.internalStore=Je(this.asRxDatabase,c,er),this.storageTokenDocument=async function(e){var t=N(10),r=e.password?await e.hashFunction(JSON.stringify(e.password)):void 0,a={id:nr,context:Xt,key:ar,data:{rxdbVersion:e.rxdbVersion,token:t,instanceToken:e.token,passwordHash:r},_deleted:!1,_meta:T(),_rev:"",_attachments:{}},n=await e.internalStore.bulkWrite([{document:a}],"internal-add-storage-token");if(n.success[0])return n.success[0];var i=(0,he.ZN)(n.error[0]);if(i.isError&&E(i)){var s=i;if(c=s.documentInDb.data.rxdbVersion,l=e.rxdbVersion,!c||l.includes("beta")&&l!==c||c.split(".")[0]!==l.split(".")[0])throw I("DM5",{args:{database:e.name,databaseStateVersion:s.documentInDb.data.rxdbVersion,codeVersion:e.rxdbVersion}});if(r&&r!==s.documentInDb.data.passwordHash)throw I("DB1",{passwordHash:r,existingPasswordHash:s.documentInDb.data.passwordHash});var o=s.documentInDb;return(0,he.ZN)(o)}var c,l;throw i}(this.asRxDatabase).catch((e=>this.startupErrors.push(e))),this.storageToken=this.storageTokenDocument.then((e=>e.data.token)).catch((e=>this.startupErrors.push(e))))}var t=e.prototype;return t.getReactivityFactory=function(){if(!this.reactivity)throw I("DB14",{database:this.name});return this.reactivity},t.$emit=function(e){this.emittedEventBulkIds.has(e.id)||(this.emittedEventBulkIds.add(e.id),this.eventBulks$.next(e))},t.removeCollectionDoc=async function(e,t){var r=await He(this.internalStore,tr(ir(e,t),Yt));if(!r)throw I("SNH",{name:e,schema:t});var a=Ve(r);a._deleted=!0,await this.internalStore.bulkWrite([{document:a,previous:r}],"rx-database-remove-collection")},t.addCollections=async function(e){var t={},r={},a=[],n={};await Promise.all(Object.entries(e).map((async e=>{let[i,o]=e;var c=i,l=o.schema;t[c]=l;var u=dt(l,this.hashFunction);if(r[c]=u,this.collections[i])throw I("DB3",{name:i});var h=ir(i,l),d={id:tr(h,Yt),key:h,context:Yt,data:{name:c,schemaHash:await u.hash,schema:u.jsonSchema,version:u.version,connectedStorages:[]},_deleted:!1,_meta:T(),_rev:"",_attachments:{}};a.push({document:d});var m=Object.assign({},o,{name:c,schema:u,database:this}),p=s(o);p.database=this,p.name=i,Le("preCreateRxCollection",p),m.conflictHandler=p.conflictHandler,n[c]=m})));var i=await this.internalStore.bulkWrite(a,"rx-database-add-collection");await async function(e){if(await e.storageToken,e.startupErrors[0])throw e.startupErrors[0]}(this),await Promise.all(i.error.map((async e=>{if(409!==e.status)throw I("DB12",{database:this.name,writeError:e});var a=(0,he.ZN)(e.documentInDb),n=a.data.name,i=r[n];if(a.data.schemaHash!==await i.hash)throw I("DB6",{database:this.name,collection:n,previousSchemaHash:a.data.schemaHash,schemaHash:await i.hash,previousSchema:a.data.schema,schema:(0,he.ZN)(t[n])})})));var o={};return await Promise.all(Object.keys(e).map((async e=>{var t=n[e],r=await function(e){let{database:t,name:r,schema:a,instanceCreationOptions:n={},migrationStrategies:i={},autoMigrate:s=!0,statics:o={},methods:c={},attachments:l={},options:u={},localDocuments:h=!1,cacheReplacementPolicy:d=Mt,conflictHandler:m=mr}=e;var p={databaseInstanceToken:t.token,databaseName:t.name,collectionName:r,schema:a.jsonSchema,options:n,multiInstance:t.multiInstance,password:t.password,devMode:D.isDevMode()};return Le("preCreateRxStorageInstance",p),async function(e,t){return t.multiInstance=e.multiInstance,await e.storage.createStorageInstance(t)}(t,p).then((e=>{var p=new gr(t,r,a,e,n,i,c,l,u,d,o,m);return p.prepare().then((()=>{Object.entries(o).forEach((e=>{let[t,r]=e;Object.defineProperty(p,t,{get:()=>r.bind(p)})}));var e=yt.em;return s&&0!==p.schema.version&&(e=p.migratePromise()),e})).then((()=>(Le("createRxCollection",{collection:p,creator:{name:r,schema:a,storageInstance:e,instanceCreationOptions:n,migrationStrategies:i,methods:c,attachments:l,options:u,cacheReplacementPolicy:d,localDocuments:h,statics:o}}),p))).catch((t=>e.close().then((()=>Promise.reject(t)))))}))}(t);o[e]=r,this.collections[e]=r,this[e]||Object.defineProperty(this,e,{get:()=>this.collections[e]})}))),o},t.lockedRun=function(e){return this.idleQueue.wrapCall(e)},t.requestIdlePromise=function(){return this.idleQueue.requestIdlePromise()},t.exportJSON=function(e){throw bt("json-dump")},t.addState=function(e){throw bt("state")},t.importJSON=function(e){throw bt("json-dump")},t.backup=function(e){throw bt("backup")},t.leaderElector=function(){throw bt("leader-election")},t.isLeader=function(){throw bt("leader-election")},t.waitForLeadership=function(){throw bt("leader-election")},t.migrationStates=function(){throw bt("migration-schema")},t.destroy=async function(){return this.destroyed?yt.Dr:(this.destroyed=!0,await Fe("preDestroyRxDatabase",this),this.eventBulks$.complete(),this._subs.map((e=>e.unsubscribe())),"pseudoInstance"===this.name?yt.Dr:this.requestIdlePromise().then((()=>Promise.all(this.onDestroy.map((e=>e()))))).then((()=>Promise.all(Object.keys(this.collections).map((e=>this.collections[e])).map((e=>e.destroy()))))).then((()=>this.internalStore.close())).then((()=>wr.delete(this.storage.name+"|"+this.name))).then((()=>!0)))},t.remove=function(){return this.destroy().then((()=>async function(e,t,r){var a=N(10),n=await Dr(a,t,e,{},!1,r),i=await rr(n),s=new Set;i.forEach((e=>s.add(e.data.name)));var o=Array.from(s);return await Promise.all(o.map((i=>or(t,n,a,e,i,r)))),await Fe("postRemoveRxDatabase",{databaseName:e,storage:t}),await n.remove(),o}(this.name,this.storage,this.password)))},(0,b.A)(e,[{key:"$",get:function(){return this.observable$}},{key:"asRxDatabase",get:function(){return this}}])}();async function Dr(e,t,r,a,n,i){return await t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:Qe,schema:er,options:a,multiInstance:n,password:i,devMode:D.isDevMode()})}function kr(e){let{storage:t,instanceCreationOptions:r,name:a,password:n,multiInstance:i=!0,eventReduce:s=!0,ignoreDuplicate:o=!1,options:c={},cleanupPolicy:l,allowSlowCount:u=!1,localDocuments:h=!1,hashFunction:d=ue,reactivity:m}=e;Le("preCreateRxDatabase",{storage:t,instanceCreationOptions:r,name:a,password:n,multiInstance:i,eventReduce:s,ignoreDuplicate:o,options:c,localDocuments:h}),o||function(e,t){var r=t.name+"|"+e;if(wr.has(r))throw I("DB8",{name:e,storage:t.name,link:"https://rxdb.info/rx-database.html#ignoreduplicate"})}(a,t),wr.add(t.name+"|"+a);var p=N(10);return Dr(p,t,a,r,i,n).catch((e=>{throw wr.delete(t.name+"|"+a),e})).then((e=>{var f=new xr(a,p,t,r,n,i,s,c,e,d,l,u,m);return Fe("createRxDatabase",{database:f,creator:{storage:t,instanceCreationOptions:r,name:a,password:n,multiInstance:i,eventReduce:s,ignoreDuplicate:o,options:c,localDocuments:h}}).then((()=>f))}))}var jr={RxSchema:ht.prototype,RxDocument:kt,RxQuery:Ut.prototype,RxCollection:gr.prototype,RxDatabase:xr.prototype},_r=new Set,Ir=new Set;var Rr=function(e){function t(t,r,a){var n;return(n=e.call(this,null,r)||this).id=t,n.parent=a,n}return(0,w.A)(t,e),t}(jt()),Er={get isLocal(){return!0},get allAttachments$(){throw I("LD1",{document:this})},get primaryPath(){return"id"},get primary(){return this.id},get $(){var e=n(Pr,this.parent);return this.parent.$.pipe((0,pt.p)((e=>e.documentId===this.primary)),(0,pt.p)((e=>e.isLocal)),(0,mt.T)((e=>wt(e))),(0,ft.Z)(e.docCache.getLatestDocumentData(this.primary)),(0,vt.F)(((e,t)=>e._rev===t._rev)),(0,mt.T)((t=>e.docCache.getCachedRxDocument(t))),(0,gt.t)(he.bz))},get $$(){var e=this,t=Cr(e);return t.getReactivityFactory().fromObservable(e.$,e.getLatest()._data,t)},get deleted$$(){var e=this,t=Cr(e);return t.getReactivityFactory().fromObservable(e.deleted$,e.getLatest().deleted,t)},getLatest(){var e=n(Pr,this.parent),t=e.docCache.getLatestDocumentData(this.primary);return e.docCache.getCachedRxDocument(t)},get(e){if(e="data."+e,this._data){if("string"!=typeof e)throw R("LD2",{objPath:e});var t=v(this._data,e);return t=D.deepFreezeWhenDevMode(t)}},get$(e){if(e="data."+e,D.isDevMode()){if(e.includes(".item."))throw I("LD3",{objPath:e});if(e===this.primaryPath)throw I("LD4")}return this.$.pipe((0,mt.T)((e=>e._data)),(0,mt.T)((t=>v(t,e))),(0,vt.F)())},get$$(e){var t=Cr(this);return t.getReactivityFactory().fromObservable(this.get$(e),this.getLatest().get(e),t)},async incrementalModify(e){var t=await Ar(this.parent);return t.incrementalWriteQueue.addWrite(this._data,(async t=>(t.data=await e(t.data,this),t))).then((e=>t.docCache.getCachedRxDocument(e)))},incrementalPatch(e){return this.incrementalModify((t=>(Object.entries(e).forEach((e=>{let[r,a]=e;t[r]=a})),t)))},async _saveData(e){var t=await Ar(this.parent),r=this._data;return e.id=this.id,t.storageInstance.bulkWrite([{previous:r,document:e}],"local-document-save-data").then((t=>{var r=t.success[0];if(!r)throw t.error[0];(e=s(e))._rev=r._rev}))},async remove(){var e=await Ar(this.parent),t=s(this._data);return t._deleted=!0,ze(e.storageInstance,{previous:this._data,document:t},"local-document-remove").then((t=>e.docCache.getCachedRxDocument(t)))}},Sr=!1,Or=()=>{if(!Sr){Sr=!0;var e=kt;Object.getOwnPropertyNames(e).forEach((t=>{if(!Object.getOwnPropertyDescriptor(Er,t)){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(Er,t,r)}}));["populate","update","putAttachment","getAttachment","allAttachments"].forEach((e=>Er[e]=(e=>()=>{throw I("LD6",{functionName:e})})(e)))}};function Cr(e){var t=e.parent;return t instanceof xr?t:t.database}var Nr=new WeakMap,Pr=new WeakMap;function $r(e){var t=e.database?e.database:e,r=e.database?e.name:"",a=(async()=>{var a=await Tr(t.token,t.storage,t.name,r,t.instanceCreationOptions,t.multiInstance);a=Je(t,a,Wr);var n=new Lt("id",e.$.pipe((0,pt.p)((e=>e.isLocal))),(t=>function(e,t){Or();var r=new Rr(e.id,e,t);return Object.setPrototypeOf(r,Er),r.prototype=Er,r}(t,e))),i=new xt(a,"id",(()=>{}),(()=>{})),s=await t.storageToken,o=a.changeStream().subscribe((r=>{for(var a=new Array(r.events.length),n=r.events,i=e.database?e.name:void 0,o=0;o<n.length;o++){var c=n[o];a[o]={documentId:c.documentId,collectionName:i,isLocal:!0,operation:c.operation,documentData:D.deepFreezeWhenDevMode(c.documentData),previousDocumentData:D.deepFreezeWhenDevMode(c.previousDocumentData)}}var l={id:r.id,internal:!1,collectionName:e.database?e.name:void 0,storageToken:s,events:a,databaseToken:t.token,checkpoint:r.checkpoint,context:r.context,endTime:r.endTime,startTime:r.startTime};t.$emit(l)}));e._subs.push(o);var c={database:t,parent:e,storageInstance:a,docCache:n,incrementalWriteQueue:i};return Pr.set(e,c),c})();Nr.set(e,a)}function Ar(e){var t=Nr.get(e);if(!t){var r=e.database?e.database:e,a=e.database?e.name:"";throw I("LD8",{database:r.name,collection:a})}return t}function Tr(e,t,r,a,n,i){return t.createStorageInstance({databaseInstanceToken:e,databaseName:r,collectionName:Mr(a),schema:Wr,options:n,multiInstance:i,devMode:D.isDevMode()})}function Br(e){var t=Nr.get(e);if(t)return Nr.delete(e),t.then((e=>e.storageInstance.close()))}async function qr(e,t,r){var a=N(10),n=await Tr(a,e,t,r,{},!1);await n.remove()}function Mr(e){return"plugin-local-documents-"+e}var Wr=W({title:"RxLocalDocument",version:0,primaryKey:"id",type:"object",properties:{id:{type:"string",maxLength:128},data:{type:"object",additionalProperties:!0}},required:["id","data"]});async function Lr(e,t){var r=await Ar(this),a={id:e,data:t,_deleted:!1,_meta:T(),_rev:"",_attachments:{}};return ze(r.storageInstance,{document:a},"local-document-insert").then((e=>r.docCache.getCachedRxDocument(e)))}function Fr(e,t){return this.getLocal(e).then((r=>r?r.incrementalModify((()=>t)):this.insertLocal(e,t)))}async function Qr(e){var t=await Ar(this),r=t.docCache,a=r.getLatestDocumentDataIfExists(e);return a?Promise.resolve(r.getCachedRxDocument(a)):He(t.storageInstance,e).then((e=>e?t.docCache.getCachedRxDocument(e):null))}function Hr(e){return this.$.pipe((0,ft.Z)(null),(0,St.Z)((async t=>t?{changeEvent:t}:{doc:await this.getLocal(e)})),(0,St.Z)((async t=>{if(t.changeEvent){var r=t.changeEvent;return r.isLocal&&r.documentId===e?{use:!0,doc:await this.getLocal(e)}:{use:!1}}return{use:!0,doc:t.doc}})),(0,pt.p)((e=>e.use)),(0,mt.T)((e=>e.doc)))}var zr={name:"local-documents",rxdb:!0,prototypes:{RxCollection:e=>{e.insertLocal=Lr,e.upsertLocal=Fr,e.getLocal=Qr,e.getLocal$=Hr},RxDatabase:e=>{e.insertLocal=Lr,e.upsertLocal=Fr,e.getLocal=Qr,e.getLocal$=Hr}},hooks:{createRxDatabase:{before:e=>{e.creator.localDocuments&&$r(e.database)}},createRxCollection:{before:e=>{e.creator.localDocuments&&$r(e.collection)}},preDestroyRxDatabase:{after:e=>Br(e)},postDestroyRxCollection:{after:e=>Br(e)},postRemoveRxDatabase:{after:e=>qr(e.storage,e.databaseName,"")},postRemoveRxCollection:{after:e=>qr(e.storage,e.databaseName,e.collectionName)}},overwritable:{}};let Kr;function Ur(){return"undefined"!=typeof window&&window.indexedDB}function Zr(){return Kr||(Kr=(async()=>{!function(e){if(Le("preAddRxPlugin",{plugin:e,plugins:_r}),!_r.has(e)){if(Ir.has(e.name))throw I("PL3",{name:e.name,plugin:e});if(_r.add(e),Ir.add(e.name),!e.rxdb)throw R("PL1",{plugin:e});e.init&&e.init(),e.prototypes&&Object.entries(e.prototypes).forEach((e=>{let[t,r]=e;return r(jr[t])})),e.overwritable&&Object.assign(D,e.overwritable),e.hooks&&Object.entries(e.hooks).forEach((e=>{let[t,r]=e;r.after&&We[t].push(r.after),r.before&&We[t].unshift(r.before)}))}}(zr);var e;return await kr({name:"rxdb-landing-v3",localDocuments:!0,storage:(void 0===e&&(e={}),new lt(e))})})()),Kr}const Vr=["#e6008d","#8d2089","#5f2688"]},6492:(e,t,r)=>{r.d(t,{d:()=>i});var a=r(4589),n=r(4848);function i(){const e=[{label:"Readwise, USA",description:"We use RxDB because it works across multiple platforms and we need to store of a great deal of data, some users have tens of thousands of documents! RxDB was the only cross-platform, offline-first solution with good enough performance to meet our needs.",href:"https://readwise.io/",target:"_blank",logo:"/files/companies/readwise.svg",logoStyle:"slider-logo-black lazyload"},{label:"myAgro, Africa",description:"Transitioning to RxDB was a breath of fresh air due to its comprehensive features, including schema migration, real-time replication, conflict resolution, and reactive programming.",href:"https://www.myagro.org/",target:"_blank",logo:"/files/companies/myagro.svg",logoStyle:"slider-logo-black lazyload"},{label:"MoreApp, Germany",description:"We provide a mobile app that is used by people in the\n            field to fill in valuable information like inspections,\n            surveys and audits. Our users don't always have access to the internet, building from an Offline-first approach with RxDB allows us to have the data integrity we need without being online.",href:"https://moreapp.com/",target:"_blank",logo:"/files/companies/moreapp.png",logoStyle:"slider-logo-black lazyload"},{label:"ALTGRAS, Africa",description:"We use RxDB to create applications capable of being\n            used in the most remote areas where Internet access is\n            really a challenge.",href:"https://altgras.com/",target:"_blank",logo:"/files/companies/altgras.png",logoStyle:"slider-logo-white lazyload"},{label:"WooCommerce POS, Australia",description:"We use RxDB to provide an offline first, cross platform\n            point of sale system. With RxDB we could create a web-, desktop- and mobile app using the same code base.",href:"https://wcpos.com/",target:"_blank",logo:"/files/companies/woopos.png",logoStyle:"slider-logo-black lazyload"},{label:"atroo GmbH, Germany",description:"RxDB is a main component in building offline-ready\n            multichannel apps. It has become our default stack for\n            this kind of apps.",href:"https://atroo.de/",target:"_blank",logo:"/files/companies/atroo.png",logoStyle:"slider-logo-black lazyload"},{label:"Nutrien, Canada",description:"With RxDB we have built an offline capable Progressive Web Application that is used by our borer operators to report on conditions at the mineface.",href:"https://www.nutrien.com/",target:"_blank",logo:"/files/companies/nutrien.svg",logoStyle:"slider-logo-black lazyload"}];return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(a.A,{dots:!0,centerMode:!0,centerPadding:"180px",infinite:!0,arrows:!1,adaptiveHeight:!0,speed:500,slidesToShow:3,slidesToScroll:1,initialSlide:0,responsive:[{breakpoint:1460,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0,dots:!0,centerPadding:"180px"}},{breakpoint:1124,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0,dots:!0,centerPadding:"100px"}},{breakpoint:900,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0,dots:!0,centerPadding:"40px"}},{breakpoint:690,settings:{slidesToShow:1,slidesToScroll:1,infinite:!0,dots:!0,centerMode:!1,centerPadding:"0px"}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1,infinite:!1,dots:!0,swipeToSlide:!0,centerMode:!1,centerPadding:"0px"}}],children:e.map((e=>(0,n.jsxs)("div",{className:"slider-content",children:[(0,n.jsx)("img",{src:"/img/quote.svg",className:"review-img",alt:"quote"}),(0,n.jsx)("h3",{children:e.description}),(0,n.jsxs)("div",{className:"slider-profile",children:[(0,n.jsx)("img",{className:e.logoStyle,"data-src":e.logo,alt:"logo"}),(0,n.jsxs)("div",{className:"slider-info",children:[(0,n.jsx)("p",{className:"developer",children:e.label}),(0,n.jsx)("a",{href:e.href,target:e.target?"_blank":"_self",className:"company-link",children:e.href})]})]})]},e.label)))})})}},4324:(e,t,r)=>{r.r(t),r.d(t,{default:()=>v});var a=r(4586),n=r(2303),i=r(8478),s=r(4043),o=r(5260),c=(r(6879),r(6540)),l=r(7849),u=r(5487),h=r(7680),d=r(574),m=r(6492),p=r(4848);const f="consulting-link-clicked";function v(){const{siteConfig:e}=(0,a.A)(),t=(0,n.A)();(0,c.useEffect)((()=>{t&&(0,d.IA)()&&(async()=>{const e=await(0,d.C3)();await e.getLocal(f)?console.log("# already tracked "+f):(window.trigger(f,100),await e.upsertLocal(f,{}))})()}));const[r,i]=c.useState(!1),l=()=>{i(!0)};return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(o.A,{children:(0,p.jsx)("body",{className:"homepage consulting-page"})}),(0,p.jsx)(s.A,{title:`${e.title}`,description:"RxDB is a fast, local-first NoSQL-database for JavaScript Applications like Websites, hybrid Apps, Electron-Apps, Progressive Web Apps and Node.js",children:(0,p.jsxs)("main",{children:[(0,p.jsx)("div",{className:"block first centered dark",children:(0,p.jsx)(g,{onOpenDialog:l})}),(0,p.jsx)("div",{className:"block packages centered",id:"packages",children:(0,p.jsx)(y,{onOpenDialog:l})}),(0,p.jsx)("div",{className:"block benefits centered",id:"benefits",children:(0,p.jsx)(b,{})}),(0,p.jsx)("div",{className:"block steps centered",id:"steps",children:(0,p.jsx)(w,{onOpenDialog:l})}),(0,p.jsxs)("div",{className:"block review",id:"reviews",children:[(0,p.jsx)("div",{className:"content",children:(0,p.jsxs)("div",{className:"inner centered",children:[(0,p.jsx)("h2",{children:"Our success stories"}),(0,p.jsx)("h3",{children:"Hear what our clients have to say about their experiences working with RxDB. Get to know real-world examples of how we've helped businesses like yours achieve their goals and exceed expectations."})]})}),(0,p.jsx)(m.d,{})]}),(0,p.jsx)("div",{className:"block faq centered",id:"faq",children:(0,p.jsx)(x,{})}),(0,p.jsx)("div",{className:"block next centered",id:"next",children:(0,p.jsx)(D,{onOpenDialog:l})}),(0,p.jsx)("div",{className:"block contact centered",id:"contact",children:(0,p.jsx)(k,{})}),(0,p.jsx)(j,{open:r,onClose:()=>{i(!1)}})]})})]})}function g(e){let{onOpenDialog:t}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{className:"content flex-row",children:[(0,p.jsxs)("div",{className:"half",children:[(0,p.jsx)("h1",{children:"Expert support for local database applications"}),(0,p.jsx)("h3",{children:"We offer custom solutions to streamline your data\n    management or revolutionize your local first project.\n    Our team is here to guide you at every step."}),(0,p.jsxs)("div",{className:"flex-row hero-buttons",style:{alignItems:"center",gap:"16px",marginTop:"40px",marginBottom:"10px"},children:[(0,p.jsx)("a",{className:"button",onClick:t,children:"Get started"}),(0,p.jsx)("a",{className:"button-empty",href:"/consulting#steps",children:"See how it works"})]})]}),(0,p.jsx)("div",{className:"half",style:{paddingTop:"42px",paddingBottom:"42px"},children:(0,p.jsx)("img",{src:"/img/hero.svg",className:"hero-img",alt:"rxdb-image"})})]}),(0,p.jsxs)("div",{className:"hero-bottom-group",children:[(0,p.jsx)("img",{src:"/img/hero-group.svg",alt:"columns"}),(0,p.jsx)("img",{src:"/img/hero-group.svg",alt:"columns"})]}),(0,p.jsx)("div",{className:"hero-bottom-group-mobile",children:(0,p.jsx)("img",{src:"/img/hero-group-mobile.svg",alt:"columns"})})]})}function y(e){let{onOpenDialog:t}=e;const r=[{index:"1",label:"Quick Consulting Session",price:"180\u20ac",description:"Schedule a quick consultancy session where the RxDB core maintainer answers all your questions and gives suggestions on how you should use RxDB or related technologies.",cta:"Schedule a call",href:"https://buy.stripe.com/14kdU1dN05SAfMA4gg",target:"_blank",rel:"",iframe:!1},{index:"2",label:"We build it for you",price:"",description:"Let our expert team handle the heavy lifting.\n            With Package 2, we take full responsibility for\n            building and implementing your local JavaScript\n            database solution. Sit back, relax, and watch as\n            we transform your vision into reality.",cta:"Get started",href:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",target:"_blank",rel:"nofollow",iframe:!0},{index:"3",label:"We build it with you",price:"",description:"Prefer a more hands-on approach? Package 3 allows you to collaborate closely with our team throughout the development process. Together, we'll fine-tune every aspect of your solution to ensure it aligns perfectly with your goals and requirements.",cta:"Get started",href:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",target:"_blank",rel:"nofollow",iframe:!0}];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"content centered",children:[(0,p.jsxs)("div",{className:"inner",children:[(0,p.jsx)("h2",{children:"Our Service Packages"}),(0,p.jsx)("h3",{children:"We offer tailored solutions to meet your needs. Whether\n    you're looking to streamline your data management\n    process or revolutionize your project's backend, our\n    team is here to guide you every step of the way."})]}),(0,p.jsx)("div",{className:"flex-row",style:{flexWrap:"wrap",alignItems:"stretch"},children:r.map(((e,r)=>(0,p.jsxs)("div",{className:r<1?"item-package flex-row":"item-package flex-column",style:{height:"auto",border:r<1?"solid 1px #E6008D":"none"},children:[(0,p.jsxs)("div",{className:"flex-column",style:{maxWidth:r<1?"70%":"unset"},children:[(0,p.jsxs)("h6",{children:["Package ",e.index]}),(0,p.jsxs)("div",{className:"flex-row",style:{alignItems:"center",gap:"16px"},children:[(0,p.jsx)("h4",{children:e.label}),e.price?(0,p.jsxs)("span",{className:"item-label",children:["Fixed ",e.price," fee"]}):null]}),(0,p.jsx)("p",{children:e.description})]}),(0,p.jsx)("div",{className:"flex-row",style:{alignItems:"center",gap:"8px",width:"auto"},children:(0,p.jsxs)("a",{onClick:()=>e.iframe?t():null,href:e.iframe?null:e.href,target:e.target&&!e.iframe?"_blank":"_self",children:[e.cta,(0,p.jsx)("svg",{width:"17",height:"17",viewBox:"0 0 17 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)("path",{d:"M9.25 16.0781L7.64063 14.4844L12.4609 9.66406H0.75V7.33594H12.4609L7.64063 2.52344L9.25 0.921875L16.8281 8.5L9.25 16.0781Z",fill:"#E6008D"})})]})})]},e.label+r)))})]})})}function b(){const e=[{label:"Expert Guidance",text:"We have years of experience with local first\n            projects and can provide expert guidance. We\n            can provide an optimal concept for the best\n            solution for your specific use case.",name:"quidance"},{label:"Development support",text:"Either you have your own team of developers\n            or we can provide expert developers or we\n            can have a mix where we provide some of the\n            developers and the customer provides the\n            others.",name:"support"},{label:"Project review",text:"We can review your code and project and\n            ensure that it uses best practices and has\n            optimal performance. This can be done once\n            before your big release or as an ongoing\n            support.",name:"review"},{label:"Tailored features",text:"We can developer tailored features for RxDB\n            that are optimized for your specific use\n            case.",name:"feature"}],t=[{key:"0",label:e[0].label,children:(0,p.jsx)(I,{item:e[0]})},{key:"1",label:e[1].label,children:(0,p.jsx)(I,{item:e[1]})},{key:"2",label:e[2].label,children:(0,p.jsx)(I,{item:e[2]})},{key:"3",label:e[3].label,children:(0,p.jsx)(I,{item:e[3]})}];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"content centered",children:[(0,p.jsxs)("div",{className:"inner",children:[(0,p.jsx)("h2",{children:"How we help you"}),(0,p.jsx)("h3",{children:"Any type of support is possible: from full development to only helping support or code review. We can do Custom RxDB features."})]}),(0,p.jsx)(u.A,{defaultActiveKey:"1",items:t})]})})}function w(e){let{onOpenDialog:t}=e;const r=[{label:"Initial contact",text:"We talk about your needs and give suggestions\n            for an optimal collaboration with us."},{label:"Specification Design",text:"We specify the collaboration between you and RxDB and define a roadmap."},{label:"Development",text:"Realization of the roadmap."},{label:"Ongoing support",text:"Regular project reviews and guidance when adding new features."}];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"content",children:[(0,p.jsxs)("div",{className:"inner",children:[(0,p.jsx)("h2",{children:"How it works"}),(0,p.jsx)("h3",{children:"Here you\u2019ll find an overview of the steps involved, offering insight into how we make the complex simple, from consultation to implementation."}),(0,p.jsx)("a",{className:"button desktop-img",onClick:t,children:"Get started"})]}),(0,p.jsx)("div",{className:"steps-container",children:r.map(((e,t)=>(0,p.jsxs)("div",{className:"step-item",children:[(0,p.jsxs)("div",{className:"step-line",children:[(0,p.jsx)("span",{className:"step-number",children:t+1}),t<r.length-1?(0,p.jsx)("span",{className:"step-number-line"}):null]}),(0,p.jsxs)("div",{className:"step-content",children:[(0,p.jsx)("h5",{children:e.label}),(0,p.jsx)("p",{children:e.text})]})]},e.label)))}),(0,p.jsx)("a",{className:"button mobile-button",onClick:t,children:"Get started"}),(0,p.jsx)("img",{className:"mobile-button",src:"/img/steps-column.svg",alt:"columns"})]})})}function x(){const e=[{key:"1",label:"Which frameworks can you support ?",children:"Everything from react to Vue to Angular to Svelte. We know all frameworks and how to use them efficiently with RxDB."},{key:"2",label:"Which platforms are supported?",children:"We can build web-apps for browsers, hybrid apps and progressive web apps. Even server-side RxDB projects can be realized."},{key:"3",label:"How much does it cost?",children:"This depends on:\n            - How much of the work is provided by us\n            - Which type of development support do you need\n            - How much of the development will be done by yourside\n\n            We can offer in-house developers, near-shore and off-shore developers."},{key:"4",label:"Do you provide 24/7 emergency support?",children:"No, sorry. This is not provided by default but we can figure out a way with you that fits your problems."}];return(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("div",{className:"content",children:[(0,p.jsxs)("div",{className:"inner",children:[(0,p.jsx)("h2",{children:"FAQs"}),(0,p.jsx)("h3",{children:"Have questions? We've got answers. Explore our FAQs to\n    learn more about our services, pricing, and approach to\n    local JavaScript database solutions."})]}),(0,p.jsx)("div",{className:"faq-container",children:(0,p.jsx)(h.A,{className:"faq-collapse",items:e,bordered:!1,expandIcon:e=>{let{isActive:t}=e;return(0,p.jsx)(_,{rotate:t?90:0})}})})]})})}function D(e){let{onOpenDialog:t}=e;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"content",children:(0,p.jsxs)("div",{className:"inner centered",children:[(0,p.jsx)("h2",{children:"Ready to take the next step?"}),(0,p.jsx)("h3",{children:"Transform your project with RxDB. Schedule your\n    consultancy session today and discover the power of\n    local JavaScript database solutions."}),(0,p.jsx)("a",{className:"button ",onClick:t,children:"Get started"})]})}),(0,p.jsx)("img",{src:"/img/next-column.svg",alt:"columns"})]})}function k(){return(0,p.jsx)(p.Fragment,{children:(0,p.jsx)("div",{className:"content",children:(0,p.jsxs)("div",{className:"iframe-form",children:[(0,p.jsxs)("div",{className:"inner centered",children:[(0,p.jsx)("h2",{children:"Still have questions?"}),(0,p.jsx)("h3",{children:"Get in touch with us today to schedule your\n    consultancy session or discuss your project\n    requirements. Fill out the form below, and a\n    member of our team will be in contact with\n    you shortly."})]}),(0,p.jsx)(i.A,{children:()=>(0,p.jsxs)("iframe",{style:{width:"100%",margin:"0 auto",maxWidth:"708px",borderRadius:"32px"},src:"https://webforms.pipedrive.com/f/6q8inTHyEUIvXxoWQGwymSc8VfEj3cUgikIf9IibvPWkJJYGI8gYEzXP89VJTwhdZx",children:["Your browser doesn't support iframes,"," ",(0,p.jsx)("a",{href:"https://webforms.pipedrive.com/f/6q8inTHyEUIvXxoWQGwymSc8VfEj3cUgikIf9IibvPWkJJYGI8gYEzXP89VJTwhdZx",target:"_blank",rel:"nofollow",children:"go here"})]})})]})})})}function j(e){let{onClose:t,open:r}=e;return(0,p.jsx)(l.A,{className:"modal-consulting-page",open:r,width:"auto",onCancel:()=>{t()},closeIcon:null,footer:null,children:(0,p.jsxs)("iframe",{style:{width:"100%",height:"70vh",borderRadius:"32px"},id:"request-project-form",src:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",children:["Your browser doesn't support iframes,"," ",(0,p.jsx)("a",{href:"https://webforms.pipedrive.com/f/6UUQvwSg3cy0wizvNdC3pmT378WEHYcwv6tdTlPNRl2HtVm0JjBbj5MQjqVj7ePW3F",target:"_blank",rel:"nofollow",children:"Click here"})]})})}function _(e){let{rotate:t}=e;const r={transform:t?"rotate(180deg)":"",transition:"transform 150ms ease"};return(0,p.jsx)("div",{style:r,children:(0,p.jsx)("svg",{width:"18",height:"11",viewBox:"0 0 18 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,p.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M9.52831 9.88389C9.23541 10.1768 8.76061 10.1768 8.46771 9.88389L0.82123 2.23739C0.52834 1.94449 0.52834 1.46969 0.82123 1.17679L1.17479 0.823191C1.46768 0.530291 1.94255 0.530291 2.23545 0.823191L8.99801 7.58579L15.7606 0.823191C16.0535 0.530291 16.5283 0.530291 16.8212 0.823191L17.1748 1.17679C17.4677 1.46969 17.4677 1.94449 17.1748 2.23739L9.52831 9.88389Z",fill:"#F6F6F7"})})})}function I(e){let{item:t}=e;return(0,p.jsxs)("div",{className:"panel",children:[(0,p.jsx)("img",{src:"/img/benefits-column.svg",className:"desktop-img",alt:"columns"}),(0,p.jsx)("div",{className:"mobile-img",children:(0,p.jsx)("img",{src:"/img/benefits-column-mobile.svg",alt:"columns"})}),(0,p.jsxs)("div",{className:"panel-content",children:[(0,p.jsx)("h3",{children:t.label}),(0,p.jsx)("h6",{children:t.text})]})]})}},7810:(e,t,r)=>{function a(e){return e[e.length-1]}function n(e){return Array.isArray(e)?e.slice(0):[e]}function i(e){return Array.isArray(e)}function s(e){return null!=e}function o(e,t){var r=0,a=-1;for(var n of e){if(!t(n,a+=1))break;r+=1}return r}function c(e,t){for(var r=t.length,a=0;a<r;++a){var n=t[a];e.push(n)}}function l(e){return e.filter((function(e,t,r){return r.indexOf(e)===t}))}r.d(t,{$r:()=>n,Hb:()=>c,S7:()=>s,Sd:()=>o,dG:()=>a,jw:()=>l,k_:()=>i})},3337:(e,t,r)=>{function a(e,t){if(!e)throw t||(t=""),new Error("ensureNotFalsy() is falsy: "+t);return e}r.d(t,{ZN:()=>a,bz:()=>n});var n={bufferSize:1,refCount:!0}},1753:(e,t,r)=>{function a(){return new Promise((e=>setTimeout(e,0)))}function n(e){return void 0===e&&(e=0),new Promise((t=>setTimeout(t,e)))}r.d(t,{$A:()=>s,Dr:()=>i,ND:()=>n,Ve:()=>u,dY:()=>a,em:()=>o,h$:()=>h,vN:()=>c});Promise.resolve(!0);var i=Promise.resolve(!1),s=Promise.resolve(null),o=Promise.resolve();function c(e){return void 0===e&&(e=1e4),"function"==typeof requestIdleCallback?new Promise((t=>{requestIdleCallback((()=>t()),{timeout:e})})):n(0)}var l=o;function u(e){return void 0===e&&(e=void 0),l=l.then((()=>c(e)))}function h(e,t){return e.reduce(((e,t)=>e.then(t)),Promise.resolve(t))}},5734:(e,t,r)=>{r.d(t,{t:()=>n});var a=0;function n(){var e=Date.now();(e+=.01)<=a&&(e=a+.01);var t=parseFloat(e.toFixed(2));return a=t,t}}}]);