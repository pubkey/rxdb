"use strict";(globalThis.webpackChunkrxdb=globalThis.webpackChunkrxdb||[]).push([[9594],{3247(e,s,n){n.d(s,{g:()=>i});var r=n(4848);function i(e){const s=[];let n=null;return e.children.forEach(e=>{e.props.id?(n&&s.push(n),n={headline:e,paragraphs:[]}):n&&n.paragraphs.push(e)}),n&&s.push(n),(0,r.jsx)("div",{style:o.stepsContainer,children:s.map((e,s)=>(0,r.jsxs)("div",{style:o.stepWrapper,children:[(0,r.jsxs)("div",{style:o.stepIndicator,children:[(0,r.jsx)("div",{style:o.stepNumber,children:s+1}),(0,r.jsx)("div",{style:o.verticalLine})]}),(0,r.jsxs)("div",{style:o.stepContent,children:[(0,r.jsx)("div",{children:e.headline}),e.paragraphs.map((e,s)=>(0,r.jsx)("div",{style:o.item,children:e},s))]})]},s))})}const o={stepsContainer:{display:"flex",flexDirection:"column"},stepWrapper:{display:"flex",alignItems:"stretch",marginBottom:"1.5rem",position:"relative",minWidth:0},stepIndicator:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",width:"33px",marginRight:"1rem",minWidth:0},stepNumber:{width:"33px",height:"33px",borderRadius:"50%",backgroundColor:"var(--color-top)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",marginTop:-4},verticalLine:{position:"absolute",top:29,bottom:"0",left:"50%",width:"1px",background:"linear-gradient(to bottom, var(--color-top) 0%, var(--color-top) 80%, rgba(0,0,0,0) 100%)",transform:"translateX(-50%)"},stepContent:{flex:1,minWidth:0,overflowWrap:"break-word"},item:{marginTop:"0.5rem"}}},6375(e,s,n){n.r(s),n.d(s,{assets:()=>p,contentTitle:()=>h,default:()=>j,frontMatter:()=>d,metadata:()=>r,toc:()=>x});const r=JSON.parse('{"id":"replication-supabase","title":"Supabase Replication Plugin for RxDB - Real-Time, Offline-First Sync","description":"Build real-time, offline-capable apps with RxDB + Supabase. Push/pull changes via PostgREST, stream updates with Realtime, and keep data in sync across devices.","source":"@site/docs/replication-supabase.md","sourceDirName":".","slug":"/replication-supabase.html","permalink":"/replication-supabase.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Supabase Replication Plugin for RxDB - Real-Time, Offline-First Sync","slug":"replication-supabase.html","description":"Build real-time, offline-capable apps with RxDB + Supabase. Push/pull changes via PostgREST, stream updates with Realtime, and keep data in sync across devices."},"sidebar":"tutorialSidebar","previous":{"title":"MongoDB Replication","permalink":"/replication-mongodb.html"},"next":{"title":"NATS Replication","permalink":"/replication-nats.html"}}');var i=n(4848),o=n(8453),a=n(2636),l=n(3247),t=n(2271),c=n(7482);const d={title:"Supabase Replication Plugin for RxDB - Real-Time, Offline-First Sync",slug:"replication-supabase.html",description:"Build real-time, offline-capable apps with RxDB + Supabase. Push/pull changes via PostgREST, stream updates with Realtime, and keep data in sync across devices."},h="Supabase Replication Plugin for RxDB - Real-Time, Offline-First Sync",p={},x=[{value:"Key Features of the RxDB-Supabase Plugin",id:"key-features-of-the-rxdb-supabase-plugin",level:2},{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"Setting up RxDB \u2194 Supabase Sync",id:"setting-up-rxdb--supabase-sync",level:2},{value:"Install Dependencies",id:"install-dependencies",level:3},{value:"Create a Supabase Project &amp; Table",id:"create-a-supabase-project--table",level:3},{value:"Create an RxDB Database &amp; Collection",id:"create-an-rxdb-database--collection",level:3},{value:"Create the Supabase Client",id:"create-the-supabase-client",level:3},{value:"Production",id:"production",level:4},{value:"Vite",id:"vite",level:4},{value:"Local Development",id:"local-development",level:4},{value:"Start Replication",id:"start-replication",level:3},{value:"Do other things with the replication state",id:"do-other-things-with-the-replication-state",level:3},{value:"Follow Up",id:"follow-up",level:2}];function k(e){const s={a:"a",admonition:"admonition",code:"code",figure:"figure",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"supabase-replication-plugin-for-rxdb---real-time-offline-first-sync",children:"Supabase Replication Plugin for RxDB - Real-Time, Offline-First Sync"})}),"\n",(0,i.jsx)("p",{align:"center",children:(0,i.jsx)("img",{src:"./files/icons/supabase.svg",alt:"Supabase",height:"60",className:"img-padding img-in-text-right"})}),"\n",(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.strong,{children:"Supabase Replication Plugin"})," for RxDB delivers seamless, two-way synchronization between your RxDB collections and a Supabase (Postgres) table. It uses ",(0,i.jsx)(s.strong,{children:"PostgREST"})," for pull/push and ",(0,i.jsx)(s.strong,{children:"Supabase Realtime"})," (logical replication) to stream live updates, so your data stays consistent across devices with first-class ",(0,i.jsx)(s.a,{href:"/articles/local-first-future.html",children:"local-first"}),", offline-ready support."]}),"\n",(0,i.jsxs)(s.p,{children:["Under the hood, the plugin is powered by the RxDB ",(0,i.jsx)(s.a,{href:"/replication.html",children:"Sync Engine"}),". It handles checkpointed incremental pulls, robust retry logic, and ",(0,i.jsx)(s.a,{href:"/transactions-conflicts-revisions.html",children:"conflict detection/resolution"})," for you. You focus on features\u2014RxDB takes care of sync."]}),"\n",(0,i.jsx)("center",{children:(0,i.jsx)(t.N,{videoId:"zBZgdTb-dns",title:"Supabase in 100 Seconds",duration:"2:36"})}),"\n",(0,i.jsx)(s.h2,{id:"key-features-of-the-rxdb-supabase-plugin",children:"Key Features of the RxDB-Supabase Plugin"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Cloud Only Backend"}),": No self-hosted server required. Client devices directly sync with the Supabase Servers."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Two-way replication"})," between Supabase tables and RxDB ",(0,i.jsx)(s.a,{href:"/rx-collection.html",children:"collections"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Offline-first"})," with resumable, incremental sync"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Live updates"})," via Supabase Realtime channels"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Conflict resolution"})," handled by the ",(0,i.jsx)(s.a,{href:"/replication.html",children:"RxDB Sync Engine"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Works in browsers and Node.js"})," with ",(0,i.jsx)(s.code,{children:"@supabase/supabase-js"})]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,i.jsx)(c.u,{showServer:!1,dbIcon:"/files/icons/supabase.svg",dbLabel:"Supabase"}),"\n",(0,i.jsx)("br",{}),"\n",(0,i.jsxs)(s.p,{children:["Clients connect ",(0,i.jsx)(s.strong,{children:"directly to Supabase"})," using the official JS client. The plugin:"]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Pulls"})," documents over PostgREST using a checkpoint ",(0,i.jsx)(s.code,{children:"(modified, id)"})," and deterministic ordering."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Pushes"})," inserts/updates using optimistic concurrency guards."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Streams"})," new changes using Supabase Realtime so live replication stays up to date."]}),"\n"]}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsxs)(s.p,{children:["Because Supabase exposes Postgres over ",(0,i.jsx)(s.strong,{children:"HTTP/WebSocket"}),", you can safely replicate from browsers and mobile apps. Protect your data with ",(0,i.jsx)(s.strong,{children:"Row Level Security (RLS)"})," policies; use the ",(0,i.jsx)(s.strong,{children:"anon"})," key on clients and the ",(0,i.jsx)(s.strong,{children:"service role"})," key only on trusted servers."]})}),"\n",(0,i.jsx)(s.h2,{id:"setting-up-rxdb--supabase-sync",children:"Setting up RxDB \u2194 Supabase Sync"}),"\n",(0,i.jsxs)(l.g,{children:[(0,i.jsx)(s.h3,{id:"install-dependencies",children:"Install Dependencies"}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"bash","data-theme":"css-variables",children:(0,i.jsx)(s.code,{"data-language":"bash","data-theme":"css-variables",style:{display:"grid"},children:(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" install"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" rxdb"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:" @supabase/supabase-js"})]})})})}),(0,i.jsx)(s.h3,{id:"create-a-supabase-project--table",children:"Create a Supabase Project & Table"}),(0,i.jsx)(s.p,{children:"In your supabase project, create a new table. Ensure that:"}),(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"The primary key must have the type text (Primary keys must always be strings in RxDB)"}),"\n",(0,i.jsxs)(s.li,{children:["You have an modified field which stores the last modification timestamp of a row (default is ",(0,i.jsx)(s.code,{children:"_modified"}),")"]}),"\n",(0,i.jsxs)(s.li,{children:['You have a boolean field which stores if a row should is "deleted". You should not hard-delete rows in Supabase, because clients would miss the deletion if they haven\'t been online at the deletion time. Instead, use a deleted ',(0,i.jsx)(s.code,{children:"boolean"})," to mark rows as deleted. This way all clients can still pull the deletion, and RxDB will hide the complexity on the client side."]}),"\n",(0,i.jsx)(s.li,{children:"Enable the realtime observation of writes to the table."}),"\n"]}),(0,i.jsx)(s.p,{children:'Here is an example for a "human" table:'}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"sql","data-theme":"css-variables",children:(0,i.jsxs)(s.code,{"data-language":"sql","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"create"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" extension "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"if"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" not"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" exists"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" moddatetime "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"schema"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" extensions;"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"create"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" table"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:' "'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"public"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:'".'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"humans"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "passportId"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" primary key"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "firstName"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" not null"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "lastName"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" text"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" not null"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "age"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" integer"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:","})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "_deleted"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" boolean"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" DEFAULT"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" false "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT NULL"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'    "_modified"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" timestamp with time zone"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" DEFAULT"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" now"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"() "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"NOT NULL"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- auto-update the _modified timestamp"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"CREATE"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" TRIGGER"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" update_modified_datetime"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" BEFORE"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" UPDATE"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ON"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" public.humans "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"FOR"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" EACH "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"ROW"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"EXECUTE"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" FUNCTION"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" extensions.moddatetime("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'_modified'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"-- add a table to the publication so we can subscribe to changes"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"alter"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" publication supabase_realtime "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"add"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" table"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "public"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"humans"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]})]})})}),(0,i.jsx)(s.h3,{id:"create-an-rxdb-database--collection",children:"Create an RxDB Database & Collection"}),(0,i.jsxs)(s.p,{children:["Create a normal RxDB database, then add a collection whose ",(0,i.jsx)(s.strong,{children:"schema mirrors your Supabase table"}),". The ",(0,i.jsx)(s.strong,{children:"primary key must match"})," (same column name and type), and fields should be ",(0,i.jsx)(s.strong,{children:"top-level simple types"})," (string/number/boolean). You don\u2019t need to model server internals: the plugin maps the server\u2019s _deleted flag to doc._deleted automatically, and _modified is optional in your schema (the plugin strips it on push and will include it on pull only if you define it). For browsers use a persistent storage like Localstorage or IndexedDB. For tests you can use the ",(0,i.jsx)(s.a,{href:"/rx-storage-memory.html",children:"in-memory storage"}),"."]}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,i.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// client"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { createRxDatabase } "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/core'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { getRxStorageLocalstorage } "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/storage-localstorage'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" const"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" db"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" createRxDatabase"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  name"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'mydb'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  storage"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" getRxStorageLocalstorage"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"});"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" db"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addCollections"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  humans"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    schema"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      version"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 0"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      primaryKey"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'passportId'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'object'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      properties"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        passportId"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'string'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" maxLength"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 100"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        firstName"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"   { type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'string'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        lastName"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    { type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'string'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        age"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { type"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'number'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" }"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      required"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ["}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'passportId'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'firstName'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'lastName'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"]"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),(0,i.jsx)(s.h3,{id:"create-the-supabase-client",children:"Create the Supabase Client"}),(0,i.jsx)(s.p,{children:"Make a single Supabase client and reuse it across your app. In the browser, use the anon key (RLS-protected). On trusted servers you may use the service role key\u2014but never ship that to clients."}),(0,i.jsxs)(a.t,{children:[(0,i.jsx)(s.h4,{id:"production",children:"Production"}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,i.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//> client"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { createClient } "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@supabase/supabase-js'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" const"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" supabase"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" createClient"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"  'https://xyzcompany.supabase.co'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"  'eyJhbGciOi...'"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})})]})})}),(0,i.jsx)(s.h4,{id:"vite",children:"Vite"}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,i.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//> client"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { createClient } "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@supabase/supabase-js'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" const"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" supabase"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" createClient"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"  import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"meta"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"env"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"VITE_SUPABASE_URL"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"       // e.g. https://xyzcompany.supabase.co"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"  import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"meta"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"env"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"VITE_SUPABASE_ANON_KEY"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"   // anon key for browsers"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"  // optional options object here"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})})]})})}),(0,i.jsx)(s.h4,{id:"local-development",children:"Local Development"}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,i.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//> client"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { createClient } "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '@supabase/supabase-js'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"export"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" const"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" supabase"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" createClient"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"  'http://127.0.0.1:54321'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"  'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...'"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})})]})})})]}),(0,i.jsx)(s.h3,{id:"start-replication",children:"Start Replication"}),(0,i.jsx)(s.p,{children:"Connect your RxDB collection to the Supabase table to start the replication."}),(0,i.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,i.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"//> client"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { replicateSupabase } "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/replication-supabase'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" replication"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" replicateSupabase"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  tableName"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'humans'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  client"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" supabase"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  collection"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" db"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".humans"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  replicationIdentifier"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'humans-supabase'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  live"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  pull"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    batchSize"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 50"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    // optional: shape incoming docs"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"    modifier"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" (doc) "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"      // map nullable age-field"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"      if"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" ("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"!"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"doc"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".age) "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"delete"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" doc"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:".age;"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"      return"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" doc;"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"    // optional: customize the pull query before fetching"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    queryBuilder: ({ query }) "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"      // Add filters, joins, or other PostgREST query modifiers"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"      // This runs before checkpoint filtering and ordering"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"      return"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" query"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".eq"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"status"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:' "active"'}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:");"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  push"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    batchSize"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 50"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"  // optional overrides if your column names differ:"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"  // modifiedField: '_modified',"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"  // deletedField: '_deleted'"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"});"})}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,i.jsx)(s.span,{"data-line":"",children:(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"// (optional) observe errors and wait for the first sync barrier"})}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"replication"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"error$"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".subscribe"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"(err "}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" console"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".error"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'[replication]'"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" err));"})]}),"\n",(0,i.jsxs)(s.span,{"data-line":"",children:[(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" replication"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".awaitInitialReplication"}),(0,i.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"();"})]})]})})}),(0,i.jsx)(s.admonition,{title:"Nullable values must be mapped",type:"note",children:(0,i.jsxs)(s.p,{children:["Supabase returns ",(0,i.jsx)(s.code,{children:"null"})," for nullable columns, but in RxDB you often model those fields as optional (i.e., they can be undefined/missing). To avoid schema errors, map ",(0,i.jsx)(s.code,{children:"null"})," \u2192 ",(0,i.jsx)(s.code,{children:"undefined"})," in the ",(0,i.jsx)(s.code,{children:"pull.modifier"})," (usually by deleting the key)."]})}),(0,i.jsx)(s.h3,{id:"do-other-things-with-the-replication-state",children:"Do other things with the replication state"}),(0,i.jsxs)(s.p,{children:["The ",(0,i.jsx)(s.code,{children:"RxSupabaseReplicationState"})," which is returned from ",(0,i.jsx)(s.code,{children:"replicateSupabase()"})," allows you to run all functionality of the normal ",(0,i.jsx)(s.a,{href:"/replication.html",children:"RxReplicationState"}),"."]})]}),"\n",(0,i.jsx)(s.h2,{id:"follow-up",children:"Follow Up"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Replication API Reference:"})," Learn the core concepts and lifecycle hooks \u2014 ",(0,i.jsx)(s.a,{href:"/replication.html",children:"Replication"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Offline-First Guide:"})," Caching, retries, and conflict strategies \u2014 ",(0,i.jsx)(s.a,{href:"/articles/local-first-future.html",children:"Local-First"})]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Supabase Essentials:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Row Level Security (RLS) \u2014 ",(0,i.jsx)(s.a,{href:"https://supabase.com/docs/guides/auth/row-level-security",children:"https://supabase.com/docs/guides/auth/row-level-security"})]}),"\n",(0,i.jsxs)(s.li,{children:["Realtime \u2014 ",(0,i.jsx)(s.a,{href:"https://supabase.com/docs/guides/realtime",children:"https://supabase.com/docs/guides/realtime"})]}),"\n",(0,i.jsxs)(s.li,{children:["Local dev with the Supabase CLI \u2014 ",(0,i.jsx)(s.a,{href:"https://supabase.com/docs/guides/cli",children:"https://supabase.com/docs/guides/cli"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Community:"})," Questions or feedback? Join our Discord \u2014 ",(0,i.jsx)(s.a,{href:"./chat",children:"Chat"})]}),"\n"]})]})}function j(e={}){const{wrapper:s}={...(0,o.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(k,{...e})}):k(e)}},7482(e,s,n){n.d(s,{u:()=>i});n(6540);var r=n(4848);function i({className:e="",style:s,clientLabels:n=["Client A","Client B","Client C"],serverLabel:i="RxServer",dbLabel:o="Backend",dbIcon:a="",showServer:l=!0}){const t="/files/logo/logo.svg",c=l?{}:{gridColumn:"2 / 5",width:"90%",marginLeft:"5%",marginRight:0};return(0,r.jsxs)("div",{className:`rxdb-diagram ${e}`,style:s,children:[(0,r.jsx)("style",{children:'\n    .rxdb-diagram {\n      padding-top: 20px;\n      padding-bottom: 20px;\n      box-sizing: border-box;\n      color: inherit;\n      width: 100%;\n      max-width: 100%;\n      overflow: hidden;\n      margin: 0 auto;\n      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI",\n                   Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";\n    }\n\n    /* Stage keeps fixed aspect ratio and scales */\n    .rxdb-diagram .stage {\n      width: 100%;\n      aspect-ratio: 816 / 336;\n      position: relative;\n    }\n\n    /* Grid fills the stage completely */\n    .rxdb-diagram .grid {\n      position: absolute;\n      inset: 0;\n      display: grid;\n      grid-template-columns:\n        26.960784% 5.882353% 31.862745% 5.882353% 29.411765%;\n      grid-template-rows:\n        23.809524% 14.285714% 23.809524% 14.285714% 23.809524%;\n      align-items: center;\n      justify-items: stretch;\n    }\n\n    .rxdb-diagram {\n      --stroke: clamp(1px, 0.35vmin, 2px);\n      --radius: clamp(8px, 1.2vmin, 14px);\n      --pad: clamp(8px, 1.2vmin, 18px);\n      --line: currentColor;\n    }\n\n    .rxdb-diagram .logo {\n      height: 1.2em;\n      width: auto;\n      display: inline-block;\n      object-fit: contain;\n      margin-right: 10px;\n    }\n\n    .rxdb-diagram .box {\n      border: var(--stroke) dashed var(--line);\n      border-radius: var(--radius);\n      background: transparent;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      text-align: center;\n      font-weight: 600;\n      padding: var(--pad);\n      line-height: 1.2;\n      user-select: none;\n    }\n\n    /* Server and DB take full height of stage */\n    .rxdb-diagram .server,\n    .rxdb-diagram .db {\n      grid-row: 1 / -1;\n      height: 100%;\n    }\n\n    /* Horizontal arrows */\n    .rxdb-diagram .arrow {\n      position: relative;\n      height: 0;\n      border-top: var(--stroke) solid var(--line);\n      width: calc(100% - 20%);\n      margin-left: 10%;\n      margin-right: -1.5%;\n    }\n\n    .rxdb-diagram .arrow::before,\n    .rxdb-diagram .arrow::after {\n      content: "";\n      position: absolute;\n      top: 50%;\n      width: clamp(6px, 1.2vmin, 10px);\n      height: clamp(6px, 1.2vmin, 10px);\n      border-top: var(--stroke) solid var(--line);\n      border-right: var(--stroke) solid var(--line);\n      transform-origin: center;\n    }\n    .rxdb-diagram .arrow::before {\n      left: 0;\n      transform: translate(-0%, -60%) rotate(-135deg);\n    }\n    .rxdb-diagram .arrow::after {\n      right: 0;\n      transform: translate(0%, -60%) rotate(45deg);\n    }\n  '}),(0,r.jsx)("div",{className:"stage","aria-label":l?"Clients to RxServer to MongoDB diagram":"Clients to MongoDB diagram",children:(0,r.jsxs)("div",{className:"grid",children:[(0,r.jsxs)("div",{className:"box",style:{gridColumn:1,gridRow:1},children:[(0,r.jsx)("img",{src:t,alt:"",className:"logo","aria-hidden":!0}),n[0]||"Client A"]}),(0,r.jsx)("div",{className:"arrow",style:{gridColumn:l?2:c.gridColumn,gridRow:1,...l?{}:{width:"90%",marginLeft:"5%",marginRight:0}},"aria-hidden":!0}),l&&(0,r.jsxs)("div",{className:"box server",style:{gridColumn:3},children:[(0,r.jsx)("img",{src:t,alt:"",className:"logo","aria-hidden":!0}),i]}),l&&(0,r.jsx)("div",{className:"arrow",style:{gridColumn:4,gridRow:3},"aria-hidden":!0}),(0,r.jsxs)("div",{className:"box db",style:{gridColumn:5},children:[(0,r.jsx)("img",{src:a,alt:"",className:"logo","aria-hidden":!0}),o]}),(0,r.jsxs)("div",{className:"box",style:{gridColumn:1,gridRow:3},children:[(0,r.jsx)("img",{src:t,alt:"",className:"logo","aria-hidden":!0}),n[1]||"Client B"]}),(0,r.jsx)("div",{className:"arrow",style:{gridColumn:l?2:c.gridColumn,gridRow:3,...l?{}:{width:"90%",marginLeft:"5%",marginRight:0}},"aria-hidden":!0}),(0,r.jsxs)("div",{className:"box",style:{gridColumn:1,gridRow:5},children:[(0,r.jsx)("img",{src:t,alt:"",className:"logo","aria-hidden":!0}),n[2]||"Client C"]}),(0,r.jsx)("div",{className:"arrow",style:{gridColumn:l?2:c.gridColumn,gridRow:5,...l?{}:{width:"90%",marginLeft:"5%",marginRight:0}},"aria-hidden":!0})]})})]})}},8453(e,s,n){n.d(s,{R:()=>a,x:()=>l});var r=n(6540);const i={},o=r.createContext(i);function a(e){const s=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),r.createElement(o.Provider,{value:s},e.children)}}}]);