"use strict";(globalThis.webpackChunkrxdb=globalThis.webpackChunkrxdb||[]).push([[4618],{5989:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"rx-storage-foundationdb","title":"RxDB on FoundationDB - Performance at Scale","description":"Combine FoundationDB\'s reliability with RxDB\'s indexing and schema validation. Build scalable apps with faster queries and real-time data.","source":"@site/docs/rx-storage-foundationdb.md","sourceDirName":".","slug":"/rx-storage-foundationdb.html","permalink":"/rx-storage-foundationdb.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"RxDB on FoundationDB - Performance at Scale","slug":"rx-storage-foundationdb.html","description":"Combine FoundationDB\'s reliability with RxDB\'s indexing and schema validation. Build scalable apps with faster queries and real-time data."},"sidebar":"tutorialSidebar","previous":{"title":"DenoKV","permalink":"/rx-storage-denokv.html"},"next":{"title":"Schema Validation","permalink":"/schema-validation.html"}}');var i=s(4848),o=s(8453);const t={title:"RxDB on FoundationDB - Performance at Scale",slug:"rx-storage-foundationdb.html",description:"Combine FoundationDB's reliability with RxDB's indexing and schema validation. Build scalable apps with faster queries and real-time data."},r="RxDB Database on top of FoundationDB",l={},d=[{value:"Features of RxDB+FoundationDB",id:"features-of-rxdbfoundationdb",level:2},{value:"Installation",id:"installation",level:2},{value:"Usage",id:"usage",level:2},{value:"Multi Instance",id:"multi-instance",level:2}];function c(e){const n={a:"a",code:"code",figure:"figure",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"rxdb-database-on-top-of-foundationdb",children:"RxDB Database on top of FoundationDB"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://www.foundationdb.org/",children:"FoundationDB"})," is a distributed key-value store designed to handle large volumes of structured data across clusters of computers while maintaining high levels of performance, scalability, and fault tolerance. While FoundationDB itself only can store and query key-value pairs, it lacks more advanced features like complex queries, encryption and replication."]}),"\n",(0,i.jsxs)(n.p,{children:["With the FoundationDB based ",(0,i.jsx)(n.a,{href:"/rx-storage.html",children:"RxStorage"})," of ",(0,i.jsx)(n.a,{href:"https://rxdb.info/",children:"RxDB"})," you can combine the benefits of FoundationDB while having a fully featured, high performance NoSQL database."]}),"\n",(0,i.jsx)(n.h2,{id:"features-of-rxdbfoundationdb",children:"Features of RxDB+FoundationDB"}),"\n",(0,i.jsx)(n.p,{children:"Using RxDB on top of FoundationDB, gives you many benefits compare to using the plain FoundationDB API:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Indexes"}),": In RxDB with a FoundationDB storage layer, indexes are used to optimize query performance, allowing for fast and efficient data retrieval even in large datasets. You can define single and compound indexes with the ",(0,i.jsx)(n.a,{href:"/rx-schema.html",children:"RxDB schema"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Schema Based Data Model"}),": Utilizing a ",(0,i.jsx)(n.a,{href:"/rx-schema.html",children:"jsonschema"})," based data model, the system offers a highly structured and versatile approach to organizing and ",(0,i.jsx)(n.a,{href:"/schema-validation.html",children:"validating data"}),", ensuring consistency and clarity in database interactions."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Complex Queries"}),": The system supports complex ",(0,i.jsx)(n.a,{href:"/rx-query.html",children:"NoSQL queries"}),", allowing for advanced data manipulation and retrieval, tailored to specific needs and intricate data relationships. For example you can do ",(0,i.jsx)(n.code,{children:"$regex"})," or ",(0,i.jsx)(n.code,{children:"$or"})," queries which is hardy possible with the plain key-value access of FoundationDB."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Observable Queries & Documents"}),": RxDB's observable queries and documents feature ensures real-time updates and synchronization, providing dynamic and responsive data interactions in applications."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Compression"}),": RxDB employs data ",(0,i.jsx)(n.a,{href:"/key-compression.html",children:"compression techniques"})," to reduce storage requirements and enhance transmission efficiency, making it more cost-effective and faster, especially for large volumes of data. You can compress the ",(0,i.jsx)(n.a,{href:"/key-compression.html",children:"NoSQL document"})," data, but also the ",(0,i.jsx)(n.a,{href:"/rx-attachment.html#attachment-compression",children:"binary attachments"})," data."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Attachments"}),": RxDB supports the storage and management of ",(0,i.jsx)(n.a,{href:"/rx-attachment.html",children:"attachments"})," which allowing for the seamless inclusion of binary data like images or documents alongside structured data within the database."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Install the ",(0,i.jsx)(n.a,{href:"https://apple.github.io/foundationdb/getting-started-linux.html",children:"FoundationDB client cli"})," which is used to communicate with the FoundationDB cluster."]}),"\n",(0,i.jsxs)(n.li,{children:["Install the ",(0,i.jsx)(n.a,{href:"https://www.npmjs.com/package/foundationdb",children:"FoundationDB node bindings npm module"})," via ",(0,i.jsx)(n.code,{children:"npm install foundationdb"}),". This will install ",(0,i.jsx)(n.code,{children:"v2.x.x"}),", which is only compatible with FoundationDB server and client ",(0,i.jsx)(n.code,{children:"v7.3.x"})," (which is the only version currently maintained by the FoundationDB team). If you need to use an older version (e.g. ",(0,i.jsx)(n.code,{children:"7.1.x"})," or ",(0,i.jsx)(n.code,{children:"6.3.x"}),"), you should run ",(0,i.jsx)(n.code,{children:"npm install foundationdb@1.1.4"})," (though this might only work with ",(0,i.jsx)(n.code,{children:"v6.3.x"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:["Due to an outstanding bug in node foundationdb, you will need to specify an ",(0,i.jsx)(n.code,{children:"apiVersion"})," of ",(0,i.jsx)(n.code,{children:"720"})," even though you are using ",(0,i.jsx)(n.code,{children:"730"}),". When ",(0,i.jsx)(n.a,{href:"https://github.com/josephg/node-foundationdb/pull/86",children:"this PR"})," is merged, you will be able to use ",(0,i.jsx)(n.code,{children:"730"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,i.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,i.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"typescript","data-theme":"css-variables",children:(0,i.jsxs)(n.code,{"data-language":"typescript","data-theme":"css-variables",style:{display:"grid"},children:[(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    createRxDatabase"})}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb'"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    getRxStorageFoundationDB"})}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"} "}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/storage-foundationdb'"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" db"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" createRxDatabase"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    name"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'exampledb'"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    storage"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" getRxStorageFoundationDB"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        /**"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * Version of the API of the FoundationDB cluster.."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * FoundationDB is backwards compatible across a wide range of versions,"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * so you have to specify the api version."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * If in doubt, set it to 720."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         */"})}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        apiVersion"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 720"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        /**"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * Path to the FoundationDB cluster file."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * (optional)"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * If in doubt, leave this empty to use the default location."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         */"})}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        clusterFile"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" '/path/to/fdb.cluster'"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"        /**"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * Amount of documents to be fetched in batch requests."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * You can change this to improve performance depending on"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * your database access patterns."})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * (optional)"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         * [default=50]"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"         */"})}),"\n",(0,i.jsxs)(n.span,{"data-line":"",children:[(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        batchSize"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,i.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 50"})]}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    })"})}),"\n",(0,i.jsx)(n.span,{"data-line":"",children:(0,i.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),"\n",(0,i.jsx)(n.h2,{id:"multi-instance",children:"Multi Instance"}),"\n",(0,i.jsxs)(n.p,{children:["Because FoundationDB does not offer a ",(0,i.jsx)(n.a,{href:"https://forums.foundationdb.org/t/streaming-data-out-of-foundationdb/683/2",children:"changestream"}),", it is not possible to use the same cluster from more than one Node.js process at the same time. For example you cannot spin up multiple servers with RxDB databases that all use the same cluster. There might be workarounds to create something like a FoundationDB changestream and you can make a Pull Request if you need that feature."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>r});var a=s(6540);const i={},o=a.createContext(i);function t(e){const n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);