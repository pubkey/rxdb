"use strict";(globalThis.webpackChunkrxdb=globalThis.webpackChunkrxdb||[]).push([[3916],{4443:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"releases/16.0.0","title":"RxDB 16.0.0 - Efficiency Redefined","description":"Meet RxDB 16.0.0 - major refactorings, improved performance, and easy migrations. Experience a better, faster, and more stable database solution today.","source":"@site/docs/releases/16.0.0.md","sourceDirName":"releases","slug":"/releases/16.0.0.html","permalink":"/releases/16.0.0.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"RxDB 16.0.0 - Efficiency Redefined","slug":"16.0.0.html","description":"Meet RxDB 16.0.0 - major refactorings, improved performance, and easy migrations. Experience a better, faster, and more stable database solution today."},"sidebar":"tutorialSidebar","previous":{"title":"LocalStorage vs. IndexedDB vs. Cookies vs. OPFS vs. WASM-SQLite","permalink":"/articles/localstorage-indexeddb-cookies-opfs-sqlite-wasm.html"},"next":{"title":"15.0.0","permalink":"/releases/15.0.0.html"}}');var s=t(4848),r=t(8453);const o={title:"RxDB 16.0.0 - Efficiency Redefined",slug:"16.0.0.html",description:"Meet RxDB 16.0.0 - major refactorings, improved performance, and easy migrations. Experience a better, faster, and more stable database solution today."},l="16.0.0",a={},d=[{value:"Breaking Changes",id:"breaking-changes",level:2},{value:"Removed deprecated LokiJS RxStorage",id:"removed-deprecated-lokijs-rxstorage",level:3},{value:"Renamed <code>.destroy()</code> to <code>.close()</code>",id:"renamed-destroy-to-close",level:3},{value:"<code>ignoreDuplicate: true</code> on <code>createRxDatabase()</code> must only be allowed in dev-mode.",id:"ignoreduplicate-true-on-createrxdatabase-must-only-be-allowed-in-dev-mode",level:3},{value:"When dev-mode is enabled, a schema validator must be used.",id:"when-dev-mode-is-enabled-a-schema-validator-must-be-used",level:3},{value:"Removed the memory-synced storage",id:"removed-the-memory-synced-storage",level:3},{value:"Split conflict handler functionality into <code>isEqual()</code> and <code>resolve()</code>.",id:"split-conflict-handler-functionality-into-isequal-and-resolve",level:3},{value:"Full rewrite of the OPFS and Filesystem-Node RxStorages",id:"full-rewrite-of-the-opfs-and-filesystem-node-rxstorages",level:2},{value:"Internal Changes",id:"internal-changes",level:2},{value:"Bugfixes",id:"bugfixes",level:2},{value:"Other",id:"other",level:2},{value:"You can help!",id:"you-can-help",level:2},{value:"LinkedIn",id:"linkedin",level:2}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"1600",children:"16.0.0"})}),"\n",(0,s.jsxs)(n.p,{children:["The release ",(0,s.jsx)(n.a,{href:"https://rxdb.info/releases/16.0.0.html",children:"16.0.0"})," is used for major refactorings. We did not change that much, mostly renaming things and fixing confusing implementation details."]}),"\n",(0,s.jsxs)(n.p,{children:["Data stored in the previous version ",(0,s.jsx)(n.code,{children:"15"})," is compatible with the code of the new version ",(0,s.jsx)(n.code,{children:"16"})," for most RxStorage implementation. So migration will be easy.\nOnly the following RxStorage implementations are required to migrate the data itself with the ",(0,s.jsx)(n.a,{href:"/migration-storage.html",children:"storage migration plugin"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"SQLite RxStorage"}),"\n",(0,s.jsx)(n.li,{children:"NodeFilesystem RxStorage"}),"\n",(0,s.jsx)(n.li,{children:"OPFS RxStorage"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"breaking-changes",children:"Breaking Changes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["CHANGE ",(0,s.jsx)(n.a,{href:"https://rxdb.info/rx-server.html",children:"RxServer"})," is no longer in beta mode."]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE ",(0,s.jsx)(n.a,{href:"https://rxdb.info/fulltext-search.html",children:"Fulltext Search"})," is no longer in beta mode."]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE ",(0,s.jsx)(n.a,{href:"https://rxdb.info/reactivity.html",children:"Custom Reactivity"})," is no longer in beta mode."]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE ",(0,s.jsx)(n.a,{href:"https://rxdb.info/replication.html",children:"initialCheckpoint in replications"})," is no longer in beta mode."]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE ",(0,s.jsx)(n.a,{href:"https://rxdb.info/rx-state.html",children:"RxState"})," is no longer in beta mode."]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE ",(0,s.jsx)(n.a,{href:"https://rxdb.info/rx-storage-memory-mapped.html",children:"MemoryMapped RxStorage"})," is no longer in beta mode."]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE rename ",(0,s.jsx)(n.code,{children:"randomCouchString()"})," to ",(0,s.jsx)(n.code,{children:"randomToken()"})]}),"\n",(0,s.jsxs)(n.li,{children:["FIX (GraphQL replication) datapath must be equivalent for pull and push ",(0,s.jsx)(n.a,{href:"https://github.com/pubkey/rxdb/pull/6019",children:"#6019"})]}),"\n",(0,s.jsxs)(n.li,{children:["REMOVE fallback to the ",(0,s.jsx)(n.code,{children:"ohash"})," package when ",(0,s.jsx)(n.code,{children:"crypto.subtle"})," does not exist. All modern runtimes (also react-native) now support ",(0,s.jsx)(n.code,{children:"crypto.subtle"}),", so we do not need that fallback anymore."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"removed-deprecated-lokijs-rxstorage",children:"Removed deprecated LokiJS RxStorage"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"https://rxdb.info/rx-storage-lokijs.html",children:"LokiJS RxStorage"})," was deprecated because LokiJS itself is no longer maintained. Therefore it will be removed completely. If you still need that, you can fork the code of it and publish it in an own package and link to it from the ",(0,s.jsx)(n.a,{href:"https://rxdb.info/third-party-plugins.html",children:"third party plugins page"}),"."]}),"\n",(0,s.jsxs)(n.h3,{id:"renamed-destroy-to-close",children:["Renamed ",(0,s.jsx)(n.code,{children:".destroy()"})," to ",(0,s.jsx)(n.code,{children:".close()"})]}),"\n",(0,s.jsxs)(n.p,{children:["Destroy was adapted from PouchDB, but people often think this deletes the written data. ",(0,s.jsx)(n.code,{children:"close"})," is a better name for that functionality."]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Also renamed similar functions/attributes:","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".destroy()"})," to ",(0,s.jsx)(n.code,{children:".close()"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".onDestroy()"})," to ",(0,s.jsx)(n.code,{children:".onClose()"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"postDestroyRxCollection"})," to ",(0,s.jsx)(n.code,{children:"postCloseRxCollection"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"preDestroyRxDatabase"})," to ",(0,s.jsx)(n.code,{children:"preCloseRxDatabase"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"ignoreduplicate-true-on-createrxdatabase-must-only-be-allowed-in-dev-mode",children:[(0,s.jsx)(n.code,{children:"ignoreDuplicate: true"})," on ",(0,s.jsx)(n.code,{children:"createRxDatabase()"})," must only be allowed in dev-mode."]}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"ignoreDuplicate"})," flag is only useful for tests and should never be used in production. We now throw an error if it is set to ",(0,s.jsx)(n.code,{children:"true"})," in non-dev-mode."]}),"\n",(0,s.jsx)(n.h3,{id:"when-dev-mode-is-enabled-a-schema-validator-must-be-used",children:"When dev-mode is enabled, a schema validator must be used."}),"\n",(0,s.jsx)(n.p,{children:"Many reported issues come from people storing data that is not valid to their schema.\nTo fix this, in dev-mode it is now required that at least one schema validator is used."}),"\n",(0,s.jsx)(n.h3,{id:"removed-the-memory-synced-storage",children:"Removed the memory-synced storage"}),"\n",(0,s.jsxs)(n.p,{children:["The memory-synced RxStorage was removed in RxDB version 16. Please use the ",(0,s.jsx)(n.code,{children:"memory-mapped"})," storage instead which has better trade-offs and is easier to configure."]}),"\n",(0,s.jsxs)(n.h3,{id:"split-conflict-handler-functionality-into-isequal-and-resolve",children:["Split conflict handler functionality into ",(0,s.jsx)(n.code,{children:"isEqual()"})," and ",(0,s.jsx)(n.code,{children:"resolve()"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Because the handler is used in so many places it becomes confusing to write a proper conflict handler.\nAlso having a handler that requires user interaction is only possible by hackingly using the context param.\nBy splitting the functionalities it is easier to learn where the handlers are used and how to define them properly."}),"\n",(0,s.jsx)(n.h2,{id:"full-rewrite-of-the-opfs-and-filesystem-node-rxstorages",children:"Full rewrite of the OPFS and Filesystem-Node RxStorages"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.a,{href:"/rx-storage-opfs.html",children:"OPFS"})," and ",(0,s.jsx)(n.a,{href:"/rx-storage-filesystem-node.html",children:"Filesystem-Node"})," RxStorage had problems with storing emojis and other special characters inside of indexed fields.\nI completely rewrote them and improved performance especially on initial load when a lot of data is stored already and when doing many small writes/reads at the same time on in series."]}),"\n",(0,s.jsx)(n.h2,{id:"internal-changes",children:"Internal Changes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"CHANGE (internal) migration-storage plugin: Remove catch from cleanup"}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE (internal) rename RX_PIPELINE_CHECKPOINT_CONTEXT to ",(0,s.jsx)(n.code,{children:"rx-pipeline-checkpoint"})]}),"\n",(0,s.jsxs)(n.li,{children:["CHANGE (internal) remove ",(0,s.jsx)(n.code,{children:"conflictResultionTasks()"})," and ",(0,s.jsx)(n.code,{children:"resolveConflictResultionTask()"})," from the RxStorage interface."]}),"\n",(0,s.jsx)(n.li,{children:"REMOVED (internal) do not check for duplicate event bulks, all RxStorage implementations must guarantee to not emit the same events twice."}),"\n",(0,s.jsx)(n.li,{children:"REFACTOR (internal) Only use event-bulks internally and only transform to single emitted events if actually someone has subscribed to the eventstream."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"bugfixes",children:"Bugfixes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Having a lot of documents pulled in the replication could in some cases slow down the database initialization because ",(0,s.jsx)(n.code,{children:"upstreamInitialSync()"})," did not set a checkpoint and each time checked all documents if they are equal to the master."]}),"\n",(0,s.jsxs)(n.li,{children:["If the handler of a ",(0,s.jsx)(n.a,{href:"/rx-pipeline.html",children:"RxPipeline"})," throws an error, block the whole pipeline and emit the error to the outside."]}),"\n",(0,s.jsxs)(n.li,{children:["Throw error when dexie.js RxStorage is used with optional index fields ",(0,s.jsx)(n.a,{href:"https://github.com/pubkey/rxdb/pull/6643#issuecomment-2505310082",children:"#6643"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Fix IndexedDB bug: Some people had problems with the IndexedDB RxStorage that opened up collections very slowly. If you had this problem, please try out this new version."}),"\n",(0,s.jsx)(n.li,{children:"Add check to ensure remote instances are build with the same RxDB version. This is to ensure if you update RxDB and forget to rebuild your workers, it will throw instead of causing strange problems."}),"\n",(0,s.jsx)(n.li,{children:"When the pulled documents in the replication do not match the schema, do not update the checkpoint."}),"\n",(0,s.jsx)(n.li,{children:"When the pushed document conflict results in the replication do not match the schema, do not update the checkpoint."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"other",children:"Other"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Added more ",(0,s.jsx)(n.a,{href:"https://rxdb.info/rx-storage-performance.html",children:"performance tests"})]}),"\n",(0,s.jsxs)(n.li,{children:["The amount of collections in the open source version has been limited to ",(0,s.jsx)(n.code,{children:"16"}),"."]}),"\n",(0,s.jsx)(n.li,{children:"Moved RxQuery checks into dev-mode."}),"\n",(0,s.jsx)(n.li,{children:"RxQuery.remove() now internally does a bulk operation for better performance."}),"\n",(0,s.jsx)(n.li,{children:"Lazily process bulkWrite() results for less CPU usage."}),"\n",(0,s.jsx)(n.li,{children:"Only run interval cleanup on the storage of a collection if there actually have been writes to it."}),"\n",(0,s.jsxs)(n.li,{children:["Schema validation errors (code: 422) now include the ",(0,s.jsx)(n.code,{children:"RxJsonSchema"})," for easier debugging."]}),"\n",(0,s.jsx)(n.li,{children:"Added an interval to prevent browser tab hibernation while a replication is running."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"you-can-help",children:"You can help!"}),"\n",(0,s.jsxs)(n.p,{children:["There are many things that can be done by ",(0,s.jsx)(n.strong,{children:"you"})," to improve RxDB:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Check the ",(0,s.jsx)(n.a,{href:"https://github.com/pubkey/rxdb/blob/master/orga/BACKLOG.md",children:"BACKLOG"})," for features that would be great to have."]}),"\n",(0,s.jsxs)(n.li,{children:["Check the ",(0,s.jsx)(n.a,{href:"https://github.com/pubkey/rxdb/blob/master/orga/before-next-major.md",children:"breaking backlog"})," for breaking changes that must be implemented in the future but where I did not have the time yet."]}),"\n",(0,s.jsxs)(n.li,{children:["Check the ",(0,s.jsx)(n.a,{href:"https://github.com/pubkey/rxdb/search?q=TODO",children:"TODOs"})," in the code. There are many small improvements that can be done for performance and build size."]}),"\n",(0,s.jsx)(n.li,{children:"Review the code and add tests. I am only a single human with a laptop. My code is not perfect and much small improvements can be done when people review the code and help me to clarify undefined behaviors."}),"\n",(0,s.jsxs)(n.li,{children:["Update the ",(0,s.jsx)(n.a,{href:"https://github.com/pubkey/rxdb/tree/master/examples",children:"example projects"})," some of them are outdated and need updates."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"linkedin",children:"LinkedIn"}),"\n",(0,s.jsxs)(n.p,{children:["Stay connected with the latest updates and network with professionals in the RxDB community by following RxDB's ",(0,s.jsx)(n.a,{href:"https://www.linkedin.com/company/rxdb",children:"official LinkedIn page"}),"!"]})]})}function c(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);