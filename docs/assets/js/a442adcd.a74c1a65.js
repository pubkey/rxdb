"use strict";(self.webpackChunkrxdb=self.webpackChunkrxdb||[]).push([[8760],{188:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var s=a(4848),n=a(8453);const i={title:"Signals & Custom Reactivity",slug:"reactivity.html"},r="Signals & Co. - Custom reactivity adapters instead of RxJS Observables",o={id:"reactivity",title:"Signals & Custom Reactivity",description:"RxDB internally uses the rxjs library for observables and streams. All functionalities of RxDB like query results or document fields that expose values that change over time return a rxjs Observable that allows you to observe the values and update your UI accordingly depending on the changes to the database state.",source:"@site/docs/reactivity.md",sourceDirName:".",slug:"/reactivity.html",permalink:"/reactivity.html",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Signals & Custom Reactivity",slug:"reactivity.html"},sidebar:"tutorialSidebar",previous:{title:"Migration Storage",permalink:"/migration-storage.html"},next:{title:"RxState",permalink:"/rx-state.html"}},c={},l=[{value:"Adding a custom reactivity factory",id:"adding-a-custom-reactivity-factory",level:2},{value:"Accessing custom reactivity objects",id:"accessing-custom-reactivity-objects",level:2},{value:"Limitations",id:"limitations",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{id:"signals--co---custom-reactivity-adapters-instead-of-rxjs-observables",children:"Signals & Co. - Custom reactivity adapters instead of RxJS Observables"}),"\n",(0,s.jsxs)(t.p,{children:["RxDB internally uses the ",(0,s.jsx)(t.a,{href:"https://rxjs.dev/",children:"rxjs library"})," for observables and streams. All functionalities of RxDB like ",(0,s.jsx)(t.a,{href:"/rx-query.html#observe",children:"query"})," results or ",(0,s.jsx)(t.a,{href:"/rx-document.html#observe",children:"document fields"})," that expose values that change over time return a rxjs ",(0,s.jsx)(t.code,{children:"Observable"})," that allows you to observe the values and update your UI accordingly depending on the changes to the database state."]}),"\n",(0,s.jsxs)(t.p,{children:["However there are many reasons to use other reactivity libraries that use a different datatype to represent changing values. For example when you use ",(0,s.jsx)(t.strong,{children:"signals"})," in angular or react, the ",(0,s.jsx)(t.strong,{children:"template refs"})," of vue or state libraries like MobX and redux."]}),"\n",(0,s.jsxs)(t.p,{children:["RxDB allows you to pass a custom reactivity factory on ",(0,s.jsx)(t.a,{href:"/rx-database.html",children:"RxDatabase"})," creation so that you can easily access values wrapped with your custom datatype in a convenient way."]}),"\n",(0,s.jsx)(t.h2,{id:"adding-a-custom-reactivity-factory",children:"Adding a custom reactivity factory"}),"\n",(0,s.jsxs)(t.p,{children:["So get custom reactivity objects out of RxDB, you have to pass a ",(0,s.jsx)(t.code,{children:"RxReactivityFactory"})," during database creation. The ",(0,s.jsx)(t.code,{children:"RxReactivityFactory"})," has the ",(0,s.jsx)(t.code,{children:"fromObservable()"})," method that creates your custom reacitvity object based on an observable and an initial value."]}),"\n",(0,s.jsxs)(t.p,{children:["For example to use signals in angular, you can use the angular ",(0,s.jsx)(t.a,{href:"https://angular.io/api/core/rxjs-interop/toSignal",children:"toSignal"})," function:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import { RxReactivityFactory } from 'rxdb/plugins/core';\nimport { toSignal } from '@angular/core/rxjs-interop';\nconst reactivityFactory: RxReactivityFactory<ReactivityType> = {\n    fromObservable(obs, initialValue) {\n        return toSignal(obs, { initialValue });\n    }\n};\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Then you can pass this factory when you create the ",(0,s.jsx)(t.a,{href:"/rx-database.html",children:"RxDatabase"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"import { createRxDatabase } from 'rxdb/plugins/core';\nconst database = await createRxDatabase({\n    name: 'mydb',\n    storage: getRxStorageDexie(),\n    reactivity: reactivityFactory\n});\n"})}),"\n",(0,s.jsx)(t.h2,{id:"accessing-custom-reactivity-objects",children:"Accessing custom reactivity objects"}),"\n",(0,s.jsxs)(t.p,{children:["All observable data in RxDB is marked by the single dollar sign ",(0,s.jsx)(t.code,{children:"$"})," like ",(0,s.jsx)(t.code,{children:"RxCollection.$"})," for events or ",(0,s.jsx)(t.code,{children:"RxDocument.myField$"})," to get the observable for a document field. To make custom reactivity objects distinguable, they are marked with double-dollar signs ",(0,s.jsx)(t.code,{children:"$$"})," instead. Here are some example on how to get custom reactivity objects from RxDB specific instances:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// RxDocument\nconst signal = myRxDocument.get$$('foobar'); // get signal that represents the document field 'foobar'\nconst signal = myRxDocument.foobar$$; // same as above\nconst signal = myRxDocument.$$; // get signal that represents whole document over time\nconst signal = myRxDocument.deleted$$; // get signal that represents the deleted state of the document\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-ts",children:"// RxQuery\nconst signal = collection.find().$$; // get signal that represents the query result set over time\nconst signal = collection.findOne().$$; // get signal that represents the query result set over time\n"})}),"\n",(0,s.jsx)(t.h2,{id:"limitations",children:"Limitations"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Custom reactivity is in beta mode, it might have breaking changes without a major RxDB release."}),"\n",(0,s.jsx)(t.li,{children:"TypeScript typings are not fully implemented, make a PR if something is missing or not working for you."}),"\n",(0,s.jsx)(t.li,{children:"Currently not all observables things in RxDB are implemented to work with custom reactivity. Please make a PR if you have the need for any missing one."}),"\n"]})]})}function u(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>r,x:()=>o});var s=a(6540);const n={},i=s.createContext(n);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);