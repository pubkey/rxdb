"use strict";(globalThis.webpackChunkrxdb=globalThis.webpackChunkrxdb||[]).push([[4962],{1918(e,s,r){r.r(s),r.d(s,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>t,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"key-compression","title":"Key Compression","description":"With the key compression plugin, documents will be stored in a compressed format which saves up to 40% disc space.","source":"@site/docs/key-compression.md","sourceDirName":".","slug":"/key-compression.html","permalink":"/key-compression.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Key Compression","slug":"key-compression.html"},"sidebar":"tutorialSidebar","previous":{"title":"Encryption","permalink":"/encryption.html"},"next":{"title":"Logger \ud83d\udc51","permalink":"/logger.html"}}');var o=r(4848),i=r(8453),a=r(3247);const t={title:"Key Compression",slug:"key-compression.html"},l="Key Compression",c={},d=[{value:"Enable key compression",id:"enable-key-compression",level:2},{value:"Wrap your RxStorage with the key compression plugin",id:"wrap-your-rxstorage-with-the-key-compression-plugin",level:3},{value:"Create an RxDatabase",id:"create-an-rxdatabase",level:3},{value:"Create a compressed RxCollection",id:"create-a-compressed-rxcollection",level:3}];function h(e){const s={a:"a",code:"code",figure:"figure",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",span:"span",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.header,{children:(0,o.jsx)(s.h1,{id:"key-compression",children:"Key Compression"})}),"\n",(0,o.jsxs)(s.p,{children:["With the key compression plugin, documents will be stored in a compressed format which saves up to 40% disc space.\nFor compression the npm module ",(0,o.jsx)(s.a,{href:"https://github.com/pubkey/jsonschema-key-compression",children:"jsonschema-key-compression"})," is used.\nIt compresses json-data based on its json-schema while still having valid json. It works by compressing long attribute-names into smaller ones and backwards."]}),"\n",(0,o.jsxs)(s.p,{children:["The compression and decompression happens internally, so when you work with a ",(0,o.jsx)(s.code,{children:"RxDocument"}),", you can access any property like normal."]}),"\n",(0,o.jsx)(s.h2,{id:"enable-key-compression",children:"Enable key compression"}),"\n",(0,o.jsxs)(s.p,{children:["The key compression plugin is a wrapper around any other ",(0,o.jsx)(s.a,{href:"/rx-storage.html",children:"RxStorage"}),"."]}),"\n",(0,o.jsxs)(a.g,{children:[(0,o.jsx)(s.h3,{id:"wrap-your-rxstorage-with-the-key-compression-plugin",children:"Wrap your RxStorage with the key compression plugin"}),(0,o.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,o.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,o.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { wrappedKeyCompressionStorage } "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/key-compression'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { getRxStorageLocalstorage } "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/storage-localstorage'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" storageWithKeyCompression"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" wrappedKeyCompressionStorage"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    storage"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" getRxStorageLocalstorage"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"()"})]}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),(0,o.jsx)(s.h3,{id:"create-an-rxdatabase",children:"Create an RxDatabase"}),(0,o.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,o.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,o.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" { createRxDatabase } "}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/core'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" db"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:" createRxDatabase"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    name"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'mydatabase'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    storage"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" storageWithKeyCompression"})]}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),(0,o.jsx)(s.h3,{id:"create-a-compressed-rxcollection",children:"Create a compressed RxCollection"}),(0,o.jsx)(s.figure,{"data-rehype-pretty-code-figure":"",children:(0,o.jsx)(s.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,o.jsxs)(s.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,o.jsx)(s.span,{"data-line":"",children:" "}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" mySchema"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  keyCompression"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" // set this to true, to enable the keyCompression"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  version"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 0"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  primaryKey"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'id'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  type"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'object'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  properties"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      id"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          type"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'string'"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"          maxLength"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" 100"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:" // <- the primary key must have set maxLength"})]}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"      }"})}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-comment)"},children:"      /* ... */"})}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"  }"})}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"};"})}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:"await"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:" db"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:".addCollections"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    docs"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,o.jsxs)(s.span,{"data-line":"",children:[(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"        schema"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:" mySchema"})]}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,o.jsx)(s.span,{"data-line":"",children:(0,o.jsx)(s.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})})]})]})}function p(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},3247(e,s,r){r.d(s,{g:()=>o});var n=r(4848);function o(e){const s=[];let r=null;return e.children.forEach(e=>{e.props.id?(r&&s.push(r),r={headline:e,paragraphs:[]}):r&&r.paragraphs.push(e)}),r&&s.push(r),(0,n.jsx)("div",{style:i.stepsContainer,children:s.map((e,s)=>(0,n.jsxs)("div",{style:i.stepWrapper,children:[(0,n.jsxs)("div",{style:i.stepIndicator,children:[(0,n.jsx)("div",{style:i.stepNumber,children:s+1}),(0,n.jsx)("div",{style:i.verticalLine})]}),(0,n.jsxs)("div",{style:i.stepContent,children:[(0,n.jsx)("div",{children:e.headline}),e.paragraphs.map((e,s)=>(0,n.jsx)("div",{style:i.item,children:e},s))]})]},s))})}const i={stepsContainer:{display:"flex",flexDirection:"column"},stepWrapper:{display:"flex",alignItems:"stretch",marginBottom:"1.5rem",position:"relative",minWidth:0},stepIndicator:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",width:"33px",marginRight:"1rem",minWidth:0},stepNumber:{width:"33px",height:"33px",borderRadius:"50%",backgroundColor:"var(--color-top)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",marginTop:-4},verticalLine:{position:"absolute",top:29,bottom:"0",left:"50%",width:"1px",background:"linear-gradient(to bottom, var(--color-top) 0%, var(--color-top) 80%, rgba(0,0,0,0) 100%)",transform:"translateX(-50%)"},stepContent:{flex:1,minWidth:0,overflowWrap:"break-word"},item:{marginTop:"0.5rem"}}},8453(e,s,r){r.d(s,{R:()=>a,x:()=>t});var n=r(6540);const o={},i=n.createContext(o);function a(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),n.createElement(i.Provider,{value:s},e.children)}}}]);